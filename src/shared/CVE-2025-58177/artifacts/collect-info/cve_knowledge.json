"# CVE Report for CVE-2025-58177\n\n## Detailed Summary\nCVE-2025-58177 is a stored cross-site scripting (XSS) vulnerability found in the n8n workflow automation platform, specifically in the `@n8n/n8n-nodes-langchain.chatTrigger` component. This vulnerability affects versions from 1.24.0 up to, but not including, 1.107.0. An authorized user can exploit this vulnerability by configuring the LangChain Chat Trigger node with malicious JavaScript code in the `initialMessages` field. If public access is enabled for the chat, the malicious payload can be executed in the browsers of any users who visit the public chat URL. This can lead to phishing attacks or the theft of cookies and other sensitive data from users accessing the compromised chat link. The issue has been addressed in version 1.107.0, and users are advised to upgrade to this version or later. As a temporary workaround, the affected chatTrigger node can be disabled.\n\n## Root Cause of the Vulnerability\nThe root cause of the vulnerability lies in the improper handling of user input in the `initialMessages` field of the LangChain Chat Trigger node. The application does not adequately sanitize or neutralize the input before rendering it in the web page, allowing an attacker to inject malicious JavaScript code. \n\nAnalyzing the patch (commit hash: d4ef191be0b39b65efa68559a3b8d5dad2e102b2) reveals that the fix likely involves implementing proper input validation and output encoding to prevent the execution of arbitrary scripts. The patch would include changes to ensure that any user-provided content is treated as data rather than executable code, thus mitigating the risk of XSS attacks.\n\n## Exploitation Details\nTo exploit this vulnerability, an attacker would need to:\n1. Gain access to an authorized user account on the n8n platform.\n2. Configure the LangChain Chat Trigger node with a payload containing malicious JavaScript in the `initialMessages` field.\n3. Enable public access for the chat, generating a public chat URL.\n4. Share the public chat URL with potential victims.\n5. When victims visit the URL, the malicious JavaScript executes in their browsers, potentially leading to data theft or phishing.\n\n## Environment Setup Requirements\n- Port: 5678 (default port for n8n)\n- Target Endpoint: `/webhook/chatTrigger`\n- Explicit Configuration: Enable public access for the chatTrigger node.\n\n## Complete PoC Code\nThe advisory does not provide specific proof-of-concept code. However, a typical payload for XSS might look like this:\n\n```javascript\n<script>alert('XSS');</script>\n```\n\nThis code would be placed in the `initialMessages` field of the LangChain Chat Trigger node. \n\nFor a complete proof-of-concept, the attacker would need to set up the n8n instance, configure the node, and ensure public access is enabled, as described in the exploitation details."