"# CVE Report for CVE-2025-58177\n\n## Detailed Summary\nCVE-2025-58177 is a stored cross-site scripting (XSS) vulnerability found in the n8n workflow automation platform, specifically in the `@n8n/n8n-nodes-langchain.chatTrigger` component. This vulnerability affects versions from 1.24.0 up to, but not including, 1.107.0. An authorized user can exploit this vulnerability by configuring the LangChain Chat Trigger node with malicious JavaScript code in the `initialMessages` field. If public access is enabled for the chat, the malicious payload can be executed in the browsers of any users who visit the public chat URL. This can lead to phishing attacks or the theft of cookies and other sensitive data from users accessing the compromised chat link. The vulnerability has been addressed in version 1.107.0, and users are advised to upgrade to this version or later. As a temporary workaround, the affected chatTrigger node can be disabled.\n\n## Root Cause of the Vulnerability\nThe root cause of the vulnerability lies in the improper handling of user input in the `initialMessages` field of the LangChain Chat Trigger node. The application does not adequately sanitize or neutralize the input before rendering it in the web page, allowing an attacker to inject malicious JavaScript code. \n\nAnalyzing the provided patch (commit hash: d4ef191be0b39b65efa68559a3b8d5dad2e102b2), it is likely that the fix involves implementing proper input validation and output encoding to prevent the execution of arbitrary scripts. The patch would typically include changes to the code that processes the `initialMessages` field, ensuring that any user-supplied content is treated as data rather than executable code.\n\n## Exploitation Details\nTo exploit this vulnerability, an attacker would need to:\n1. Gain access to an authorized user account on the n8n platform.\n2. Configure the LangChain Chat Trigger node with a payload containing malicious JavaScript in the `initialMessages` field.\n3. Enable public access for the chat.\n4. Share the public chat URL with potential victims.\n\nWhen a victim accesses the public chat URL, the malicious JavaScript would execute in their browser, potentially leading to data theft or other malicious actions.\n\n## Environment Setup Requirements\n- Port: 5678 (default port for n8n)\n- Target Endpoint: `/webhook/chatTrigger`\n- Explicit Configuration: Enable public access for the chatTrigger node.\n\n## Complete PoC Code\nThe advisory does not provide specific proof-of-concept code. However, a typical payload for the `initialMessages` field could look like this:\n\n```javascript\n<script>alert('XSS Vulnerability Exploited!');</script>\n```\n\nThis payload, when injected into the `initialMessages` field and accessed via the public chat URL, would trigger an alert in the victim's browser, demonstrating the XSS vulnerability. \n\nFor further details, please refer to the security advisory: [n8n Security Advisory](https://github.com/n8n-io/n8n/security/advisories/GHSA-mvh4-2cm2-6hpg).\n\n## üöÄ DEPLOYMENT STRATEGY (USE THIS - DO NOT GUESS!)\n\n**Repository URL**: https://github.com/n8n-io/n8n\n**Platform**: N/A\n**Language**: javascript\n**Build Tool**: npm\n\n### Build Commands:\n```bash\ngit clone https://github.com/n8n-io/n8n\ncd $(basename https://github.com/n8n-io/n8n)\nnpm install\n```\n\n### Start Commands:\n```bash\nnpm start  # Êàñ node server.js / node index.js\n```\n\n### Deployment Notes:\n‰ªé GitHub Ê∫êÁ†ÅÈÉ®ÁΩ≤„ÄÇËØ≠Ë®Ä: javascript, ÊûÑÂª∫Â∑•ÂÖ∑: npm\n\n‚ö†Ô∏è **CRITICAL INSTRUCTIONS**:\n1. DO NOT try to find Docker images or guess repository URLs\n2. USE THE REPOSITORY URL PROVIDED ABOVE\n3. Clone from the specified repository and follow build/start commands\n4. If build commands fail, analyze error and adapt (but keep using the same repo)\n"