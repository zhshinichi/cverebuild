{
    "verifier": "#!/usr/bin/env python3\n\"\"\"\nCTF-style verifier for CVE-2025-1752 (llama-index-readers-web 0.3.5)\n\nStructure\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2022 Pre-setup     : not required \u2013 exploit is fully self-contained.\n\u2022 Exploit       : run exploit.py with a dummy URL argument.\n\u2022 Post-exploit  : inspect result (timeout, output, return-code) and\n                  print flag '3xploit66full' on success.\n\"\"\"\nfrom __future__ import annotations\n\nimport subprocess\nimport sys\nfrom pathlib import Path\nfrom typing import Optional\n\n# --------------------------------------------------------------------\nFLAG = \"3xploit66full\"\nEXPLOIT = Path(__file__).with_name(\"exploit.py\")   # exploit expected next to verifier\nTIMEOUT = 10                                       # seconds (wall-clock)\n\n\n# --------------------------- Pre-setup -------------------------------\n# Not required \u2013 exploit builds its own dummy browser & data.\n\n\n# -----------------------  Exploit Helpers  --------------------------\ndef _build_cmd() -> list[str]:\n    if not EXPLOIT.is_file():\n        print(\"[-] verifier error: exploit.py not found\", file=sys.stderr)\n        sys.exit(2)\n    # Any URL works; the exploit never performs real networking.\n    return [sys.executable, str(EXPLOIT), \"http://example.com\"]\n\n\ndef _run_exploit() -> Optional[subprocess.CompletedProcess]:\n    \"\"\"\n    Launch exploit.py under a TIMEOUT.\n\n    Returns\n    -------\n    CompletedProcess  \u2013 child finished within TIMEOUT\n    None              \u2013 child was still alive after TIMEOUT (\u2192 DoS)\n    \"\"\"\n    try:\n        return subprocess.run(\n            _build_cmd(),\n            capture_output=True,\n            text=True,\n            timeout=TIMEOUT,\n        )\n    except subprocess.TimeoutExpired:\n        # Child exceeded TIMEOUT \u2192 likely hung in uncontrolled recursion.\n        return None\n\n\n# ---------------------------- Main -----------------------------------\ndef main() -> None:\n    result = _run_exploit()\n\n    # -------------------- Post-exploit checks ------------------------\n    succeeded = False\n\n    if result is None:\n        # Timed-out child \u2192 strong DoS indication.\n        succeeded = True\n    else:\n        combined_out = (result.stdout or \"\") + (result.stderr or \"\")\n        # Textual evidence of recursion overflow\n        if (\n            \"RecursionError\" in combined_out\n            or \"maximum recursion depth exceeded\" in combined_out\n        ):\n            succeeded = True\n        # Fatal signal often produced on deep recursion\n        if result.returncode in (-11, -6):  # SIGSEGV, SIGABRT\n            succeeded = True\n\n    if succeeded:\n        print(FLAG)\n\n\nif __name__ == \"__main__\":\n    main()"
}