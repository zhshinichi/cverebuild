{
    "verifier": "#!/usr/bin/env python3\n\"\"\"\nCTF verifier for CVE-2024-4340 (sqlparse \u2264 0.4.4)\n\nStructure\n---------\n1. Pre-setup        : (none required)\n2. Exploit          : run the given exploit.py with a large depth argument\n3. Post-exploit     : if the exploit terminates abnormally *and*\n                      \u201cRecursionError\u201d appears in its output, print the flag\n                      '3xploit66full'.\n\nThe script exits 0 on success and 1 otherwise.\n\"\"\"\nimport os\nimport sys\nimport subprocess\n\nFLAG = \"3xploit66full\"\nEXPLOIT_FILE = os.path.join(os.path.dirname(__file__), \"exploit.py\")\n\n\ndef run_exploit(depth: int = 10000):\n    \"\"\"\n    Run exploit.py with the chosen depth and return the completed\n    subprocess object.\n    \"\"\"\n    cmd = [sys.executable, EXPLOIT_FILE, str(depth)]\n    return subprocess.run(cmd, capture_output=True, text=True)\n\n\ndef verify():\n    # ---------------------------------------------------------------\n    # 1. Pre-setup  (not required for this local DoS vulnerability)\n    # ---------------------------------------------------------------\n\n    # ---------------------------------------------------------------\n    # 2. Exploit\n    # ---------------------------------------------------------------\n    res = run_exploit()\n\n    # ---------------------------------------------------------------\n    # 3. Post-exploit  \u2013 check the expected behaviour\n    # ---------------------------------------------------------------\n    combined_output = (res.stdout or \"\") + (res.stderr or \"\")\n    success = res.returncode != 0 and \"RecursionError\" in combined_output\n\n    if success:\n        print(FLAG)\n        return 0\n    else:\n        sys.stderr.write(\"Exploit verification failed \u2013 did not observe \"\n                         \"expected RecursionError.\\n\")\n        return 1\n\n\nif __name__ == \"__main__\":\n    sys.exit(verify())"
}