{
    "overview": "This project is the vulnerable sqlparse library version 0.4.4, a non-validating SQL parser for Python. In this version, the method TokenList.flatten() in sqlparse/sql.py uses unchecked recursion to traverse nested token groups. An attacker can craft a SQL string with extremely deep nesting of brackets (e.g. 10 000 \u201c[[[[\u2026]]]]\u201d pairs) and pass it to sqlparse.parse(). The uncontrolled recursion exceeds Python\u2019s recursion limit, raising an uncaught RecursionError and crashing the parser (Denial of Service). Version 0.5.0 adds a catch for RecursionError and raises a controlled SQLParseError instead.",
    "files": "1. sqlparse/sql.py \u2013 contains the vulnerable TokenList.flatten() implementation (lines 212\u2013217).  \n2. sqlparse/__init__.py \u2013 shows the library version ('0.4.4') and the parse()/parsestream() entry points.  \n3. pyproject.toml \u2013 project metadata and build configuration; install the package locally via flit or pip.  \n4. README.rst \u2013 installation and usage instructions.  \n5. tests/test_regressions.py \u2013 includes the regression test for the fixed behavior in 0.5.0 (useful as reference to see expected exception type).  \n6. trigger_sqlparse_nested_list.py (to be created at project root) \u2013 PoC script demonstrating the RecursionError when parsing deeply nested brackets.",
    "services": "None. The project is purely a Python library. No external services or databases are required. A local Python (3.5+) environment with standard library only is sufficient.",
    "output": "After cloning the repository and installing:\n  $ python3 -m venv venv\n  $ source venv/bin/activate\n  $ pip install -e .            # installs sqlparse 0.4.4 locally\n  $ python trigger_sqlparse_nested_list.py\n\nThe script will attempt to parse a string of 10 000 \u201c[\u201d followed by 10 000 \u201c]\u201d and will terminate with:\n  RecursionError: maximum recursion depth exceeded\n\nThis confirms the Denial-of-Service vulnerability (uncontrolled recursion) in version 0.4.4."
}