"# CVE Report for CVE-2025-7162\n\n## Detailed Summary\nCVE-2025-7162 is a critical vulnerability identified in the PHPGurukul Zoo Management System version 2.1. The vulnerability is classified under CWE-89 (SQL Injection) and CWE-74 (Injection). It specifically affects the processing of the file `/admin/add-foreigners-ticket.php`, where improper handling of the `cprice` argument allows an attacker to execute arbitrary SQL queries against the database. This vulnerability can be exploited remotely, making it a significant security risk for installations of the affected software.\n\n## Root Cause of the Vulnerability\nThe root cause of the vulnerability lies in the inadequate sanitization and validation of user input, particularly the `cprice` parameter in the `/admin/add-foreigners-ticket.php` file. When user input is directly incorporated into SQL queries without proper escaping or parameterization, it opens the door for SQL injection attacks. \n\nAnalyzing the patch (though not provided in detail here), it is likely that the fix involves implementing prepared statements or parameterized queries to ensure that user input is treated as data rather than executable code. This would prevent attackers from injecting malicious SQL commands through the `cprice` parameter.\n\n## Exploitation Details\nTo exploit this vulnerability, an attacker would craft a malicious request that includes a specially formatted `cprice` parameter. The request would be sent to the vulnerable endpoint, allowing the attacker to manipulate the SQL query executed by the application. \n\nFor example, an attacker might send a request like:\n```\nPOST /admin/add-foreigners-ticket.php HTTP/1.1\nHost: vulnerable-website.com\nContent-Type: application/x-www-form-urlencoded\n\ncprice=100; DROP TABLE users; --\n```\nThis request could potentially lead to the execution of the `DROP TABLE users;` command if the application does not properly handle the input.\n\n## Environment Setup Requirements\n- Port: 80 (default for HTTP)\n- Target Endpoint: `/admin/add-foreigners-ticket.php`\n- Explicit Configuration: None explicitly mentioned in the advisory.\n\n## Complete PoC Code\nUnfortunately, the advisory does not provide any specific proof-of-concept code. However, based on the nature of the vulnerability, a simple PoC could look like the following:\n\n```php\n<?php\n// Example of a vulnerable code snippet\n$cprice = $_POST['cprice']; // User input not sanitized\n$query = \"INSERT INTO tickets (cprice) VALUES ('$cprice')\";\nmysqli_query($conn, $query);\n?>\n```\n\nThis code snippet illustrates how the `cprice` parameter is directly used in an SQL query without any sanitization, making it vulnerable to SQL injection. \n\nIn conclusion, CVE-2025-7162 represents a critical security flaw that requires immediate attention to mitigate the risk of SQL injection attacks in the PHPGurukul Zoo Management System. Proper input validation and the use of prepared statements are essential to secure the application against such vulnerabilities."