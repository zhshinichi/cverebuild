{
    "overview": "The project is the Python package mlflow at version 2.8.1, which contains a path\u2010traversal vulnerability (CVE-2024-0520) in HTTPDatasetSource.load. When fetching a dataset over HTTP, an attacker-controlled Content-Disposition header can specify a filename with \u201c../\u201d or an absolute path, causing the client to write files to arbitrary locations. To reproduce, install mlflow==2.8.1 in a local Python environment and execute a proof\u2010of\u2010concept that starts a malicious HTTP server and triggers MLflow\u2019s download logic.",
    "files": "1. rogue_server.py \u2013 Flask app that serves CSV data with a malicious Content-Disposition header (e.g., filename=\"/tmp/poc.txt\").  \n2. trigger_write.py \u2013 Python script that:\n   \u2022 Imports pandas and mlflow  \n   \u2022 Reads the CSV via pandas (to satisfy mlflow.data.from_pandas)  \n   \u2022 Logs the dataset input in an mlflow run  \n   \u2022 Retrieves the run\u2019s input dataset and calls dataset_source.load() to trigger arbitrary file write.  \n3. requirements.txt \u2013 Pin dependencies:\n   \u2022 mlflow==2.8.1  \n   \u2022 flask  \n   \u2022 pandas  \n(Optional: create a virtualenv and install with \u201cpip install -r requirements.txt\u201d.)",
    "services": "Start the Flask server defined in rogue_server.py:\n\u2022 Host: 0.0.0.0  \n\u2022 Port: 4444  \nThis local HTTP service returns the CSV with the malicious header. No other external services (tracking servers, databases) are required; MLflow uses the default local file\u2010system backend.",
    "output": "1. Running rogue_server.py launches the malicious endpoint at http://localhost:4444.  \n2. Running trigger_write.py performs the steps and prints a confirmation.  \n3. Verify that /tmp/poc.txt exists and contains the CSV contents\u2014demonstrating arbitrary file write.  \n4. An mlruns directory is created locally containing the logged run; this is expected and confirms MLflow\u2019s local logging behavior."
}