{
    "CVE-2024-7592": {
        "published_date": "2024-08-19T19:06:45.311Z",
        "patch_commits": [
            {
                "url": "https://github.com/python/cpython/commit/391e5626e3ee5af267b97e37abc7475732e67621",
                "content": "[3.13] gh-123067: Fix quadratic complexity in parsing \"-quoted cookie values with backslashes (GH-123075) (#123103)\n\ngh-123067: Fix quadratic complexity in parsing \"-quoted cookie values with backslashes (GH-123075)\r\n\r\nThis fixes CVE-2024-7592.\r\n(cherry picked from commit 44e458357fca05ca0ae2658d62c8c595b048b5ef)\r\n\r\nCo-authored-by: Serhiy Storchaka <storchaka@gmail.com>\n\nFilename: Lib/http/cookies.py:\n```\n@@ -184,8 +184,13 @@\ndef _quote(str):\n         return '\"' + str.translate(_Translator) + '\"'\n \n \n-_OctalPatt = re.compile(r\"\\\\[0-3][0-7][0-7]\")\n-_QuotePatt = re.compile(r\"[\\\\].\")\n+_unquote_sub = re.compile(r'\\\\(?:([0-3][0-7][0-7])|(.))').sub\n+\n+def _unquote_replace(m):\n+    if m[1]:\n+        return chr(int(m[1], 8))\n+    else:\n+        return m[2]\n \n def _unquote(str):\n     # If there aren't any doublequotes,\n\n@@ -205,30 +210,7 @@\ndef _unquote(str):\n     #    \\012 --> \\n\n     #    \\\"   --> \"\n     #\n-    i = 0\n-    n = len(str)\n-    res = []\n-    while 0 <= i < n:\n-        o_match = _OctalPatt.search(str, i)\n-        q_match = _QuotePatt.search(str, i)\n-        if not o_match and not q_match:              # Neither matched\n-            res.append(str[i:])\n-            break\n-        # else:\n-        j = k = -1\n-        if o_match:\n-            j = o_match.start(0)\n-        if q_match:\n-            k = q_match.start(0)\n-        if q_match and (not o_match or k < j):     # QuotePatt matched\n-            res.append(str[i:k])\n-            res.append(str[k+1])\n-            i = k + 2\n-        else:                                      # OctalPatt matched\n-            res.append(str[i:j])\n-            res.append(chr(int(str[j+1:j+4], 8)))\n-            i = j + 4\n-    return _nulljoin(res)\n+    return _unquote_sub(_unquote_replace, str)\n \n # The _getdate() routine is used to set the expiration time in the cookie's HTTP\n # header.  By default, _getdate() returns the current time in the appropriate\n```\n\nFilename: Lib/test/test_http_cookies.py:\n```\n@@ -5,6 +5,7 @@\nimport doctest\n from http import cookies\n import pickle\n+from test import support\n \n \n class CookieTests(unittest.TestCase):\n\n@@ -58,6 +59,43 @@\ndef test_basic(self):\n             for k, v in sorted(case['dict'].items()):\n                 self.assertEqual(C[k].value, v)\n \n+    def test_unquote(self):\n+        cases = [\n+            (r'a=\"b=\\\"\"', 'b=\"'),\n+            (r'a=\"b=\\\\\"', 'b=\\\\'),\n+            (r'a=\"b=\\=\"', 'b=='),\n+            (r'a=\"b=\\n\"', 'b=n'),\n+            (r'a=\"b=\\042\"', 'b=\"'),\n+            (r'a=\"b=\\134\"', 'b=\\\\'),\n+            (r'a=\"b=\\377\"', 'b=\\xff'),\n+            (r'a=\"b=\\400\"', 'b=400'),\n+            (r'a=\"b=\\42\"', 'b=42'),\n+            (r'a=\"b=\\\\042\"', 'b=\\\\042'),\n+            (r'a=\"b=\\\\134\"', 'b=\\\\134'),\n+            (r'a=\"b=\\\\\\\"\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\\\\\042\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\134\\\"\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\134\\042\"', 'b=\\\\\"'),\n+        ]\n+        for encoded, decoded in cases:\n+            with self.subTest(encoded):\n+                C = cookies.SimpleCookie()\n+                C.load(encoded)\n+                self.assertEqual(C['a'].value, decoded)\n+\n+    @support.requires_resource('cpu')\n+    def test_unquote_large(self):\n+        n = 10**6\n+        for encoded in r'\\\\', r'\\134':\n+            with self.subTest(encoded):\n+                data = 'a=\"b=' + encoded*n + ';\"'\n+                C = cookies.SimpleCookie()\n+                C.load(data)\n+                value = C['a'].value\n+                self.assertEqual(value[:3], 'b=\\\\')\n+                self.assertEqual(value[-2:], '\\\\;')\n+                self.assertEqual(len(value), n + 3)\n+\n     def test_load(self):\n         C = cookies.SimpleCookie()\n         C.load('Customer=\"WILE_E_COYOTE\"; Version=1; Path=/acme')\n```\n\nFilename: Misc/NEWS.d/next/Library/2024-08-16-19-13-21.gh-issue-123067.Nx9O4R.rst:\n```\n@@ -0,0 +1 @@\n+Fix quadratic complexity in parsing ``\"``-quoted cookie values with backslashes by :mod:`http.cookies`.\n```"
            },
            {
                "url": "https://github.com/python/cpython/commit/dcc3eaef98cd94d6cb6cb0f44bd1c903d04f33b1",
                "content": "[3.12] gh-123067: Fix quadratic complexity in parsing \"-quoted cookie values with backslashes (GH-123075) (#123104)\n\ngh-123067: Fix quadratic complexity in parsing \"-quoted cookie values with backslashes (GH-123075)\r\n\r\nThis fixes CVE-2024-7592.\r\n(cherry picked from commit 44e458357fca05ca0ae2658d62c8c595b048b5ef)\r\n\r\nCo-authored-by: Serhiy Storchaka <storchaka@gmail.com>\n\nFilename: Lib/http/cookies.py:\n```\n@@ -184,8 +184,13 @@\ndef _quote(str):\n         return '\"' + str.translate(_Translator) + '\"'\n \n \n-_OctalPatt = re.compile(r\"\\\\[0-3][0-7][0-7]\")\n-_QuotePatt = re.compile(r\"[\\\\].\")\n+_unquote_sub = re.compile(r'\\\\(?:([0-3][0-7][0-7])|(.))').sub\n+\n+def _unquote_replace(m):\n+    if m[1]:\n+        return chr(int(m[1], 8))\n+    else:\n+        return m[2]\n \n def _unquote(str):\n     # If there aren't any doublequotes,\n\n@@ -205,30 +210,7 @@\ndef _unquote(str):\n     #    \\012 --> \\n\n     #    \\\"   --> \"\n     #\n-    i = 0\n-    n = len(str)\n-    res = []\n-    while 0 <= i < n:\n-        o_match = _OctalPatt.search(str, i)\n-        q_match = _QuotePatt.search(str, i)\n-        if not o_match and not q_match:              # Neither matched\n-            res.append(str[i:])\n-            break\n-        # else:\n-        j = k = -1\n-        if o_match:\n-            j = o_match.start(0)\n-        if q_match:\n-            k = q_match.start(0)\n-        if q_match and (not o_match or k < j):     # QuotePatt matched\n-            res.append(str[i:k])\n-            res.append(str[k+1])\n-            i = k + 2\n-        else:                                      # OctalPatt matched\n-            res.append(str[i:j])\n-            res.append(chr(int(str[j+1:j+4], 8)))\n-            i = j + 4\n-    return _nulljoin(res)\n+    return _unquote_sub(_unquote_replace, str)\n \n # The _getdate() routine is used to set the expiration time in the cookie's HTTP\n # header.  By default, _getdate() returns the current time in the appropriate\n```\n\nFilename: Lib/test/test_http_cookies.py:\n```\n@@ -5,6 +5,7 @@\nimport doctest\n from http import cookies\n import pickle\n+from test import support\n \n \n class CookieTests(unittest.TestCase):\n\n@@ -58,6 +59,43 @@\ndef test_basic(self):\n             for k, v in sorted(case['dict'].items()):\n                 self.assertEqual(C[k].value, v)\n \n+    def test_unquote(self):\n+        cases = [\n+            (r'a=\"b=\\\"\"', 'b=\"'),\n+            (r'a=\"b=\\\\\"', 'b=\\\\'),\n+            (r'a=\"b=\\=\"', 'b=='),\n+            (r'a=\"b=\\n\"', 'b=n'),\n+            (r'a=\"b=\\042\"', 'b=\"'),\n+            (r'a=\"b=\\134\"', 'b=\\\\'),\n+            (r'a=\"b=\\377\"', 'b=\\xff'),\n+            (r'a=\"b=\\400\"', 'b=400'),\n+            (r'a=\"b=\\42\"', 'b=42'),\n+            (r'a=\"b=\\\\042\"', 'b=\\\\042'),\n+            (r'a=\"b=\\\\134\"', 'b=\\\\134'),\n+            (r'a=\"b=\\\\\\\"\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\\\\\042\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\134\\\"\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\134\\042\"', 'b=\\\\\"'),\n+        ]\n+        for encoded, decoded in cases:\n+            with self.subTest(encoded):\n+                C = cookies.SimpleCookie()\n+                C.load(encoded)\n+                self.assertEqual(C['a'].value, decoded)\n+\n+    @support.requires_resource('cpu')\n+    def test_unquote_large(self):\n+        n = 10**6\n+        for encoded in r'\\\\', r'\\134':\n+            with self.subTest(encoded):\n+                data = 'a=\"b=' + encoded*n + ';\"'\n+                C = cookies.SimpleCookie()\n+                C.load(data)\n+                value = C['a'].value\n+                self.assertEqual(value[:3], 'b=\\\\')\n+                self.assertEqual(value[-2:], '\\\\;')\n+                self.assertEqual(len(value), n + 3)\n+\n     def test_load(self):\n         C = cookies.SimpleCookie()\n         C.load('Customer=\"WILE_E_COYOTE\"; Version=1; Path=/acme')\n```\n\nFilename: Misc/NEWS.d/next/Library/2024-08-16-19-13-21.gh-issue-123067.Nx9O4R.rst:\n```\n@@ -0,0 +1 @@\n+Fix quadratic complexity in parsing ``\"``-quoted cookie values with backslashes by :mod:`http.cookies`.\n```"
            },
            {
                "url": "https://github.com/python/cpython/commit/a77ab24427a18bff817025adb03ca920dc3f1a06",
                "content": "[3.8] gh-123067: Fix quadratic complexity in parsing \"-quoted cookie values with backslashes (GH-123075) (#123108)\n\nThis fixes CVE-2024-7592.\r\n(cherry picked from commit 44e458357fca05ca0ae2658d62c8c595b048b5ef)\r\n\r\nCo-authored-by: Serhiy Storchaka <storchaka@gmail.com>\n\nFilename: Lib/http/cookies.py:\n```\n@@ -183,8 +183,13 @@\ndef _quote(str):\n         return '\"' + str.translate(_Translator) + '\"'\n \n \n-_OctalPatt = re.compile(r\"\\\\[0-3][0-7][0-7]\")\n-_QuotePatt = re.compile(r\"[\\\\].\")\n+_unquote_sub = re.compile(r'\\\\(?:([0-3][0-7][0-7])|(.))').sub\n+\n+def _unquote_replace(m):\n+    if m[1]:\n+        return chr(int(m[1], 8))\n+    else:\n+        return m[2]\n \n def _unquote(str):\n     # If there aren't any doublequotes,\n\n@@ -204,30 +209,7 @@\ndef _unquote(str):\n     #    \\012 --> \\n\n     #    \\\"   --> \"\n     #\n-    i = 0\n-    n = len(str)\n-    res = []\n-    while 0 <= i < n:\n-        o_match = _OctalPatt.search(str, i)\n-        q_match = _QuotePatt.search(str, i)\n-        if not o_match and not q_match:              # Neither matched\n-            res.append(str[i:])\n-            break\n-        # else:\n-        j = k = -1\n-        if o_match:\n-            j = o_match.start(0)\n-        if q_match:\n-            k = q_match.start(0)\n-        if q_match and (not o_match or k < j):     # QuotePatt matched\n-            res.append(str[i:k])\n-            res.append(str[k+1])\n-            i = k + 2\n-        else:                                      # OctalPatt matched\n-            res.append(str[i:j])\n-            res.append(chr(int(str[j+1:j+4], 8)))\n-            i = j + 4\n-    return _nulljoin(res)\n+    return _unquote_sub(_unquote_replace, str)\n \n # The _getdate() routine is used to set the expiration time in the cookie's HTTP\n # header.  By default, _getdate() returns the current time in the appropriate\n```\n\nFilename: Lib/test/test_http_cookies.py:\n```\n@@ -5,6 +5,7 @@\nimport unittest\n from http import cookies\n import pickle\n+from test import support\n \n \n class CookieTests(unittest.TestCase):\n\n@@ -58,6 +59,43 @@\ndef test_basic(self):\n             for k, v in sorted(case['dict'].items()):\n                 self.assertEqual(C[k].value, v)\n \n+    def test_unquote(self):\n+        cases = [\n+            (r'a=\"b=\\\"\"', 'b=\"'),\n+            (r'a=\"b=\\\\\"', 'b=\\\\'),\n+            (r'a=\"b=\\=\"', 'b=='),\n+            (r'a=\"b=\\n\"', 'b=n'),\n+            (r'a=\"b=\\042\"', 'b=\"'),\n+            (r'a=\"b=\\134\"', 'b=\\\\'),\n+            (r'a=\"b=\\377\"', 'b=\\xff'),\n+            (r'a=\"b=\\400\"', 'b=400'),\n+            (r'a=\"b=\\42\"', 'b=42'),\n+            (r'a=\"b=\\\\042\"', 'b=\\\\042'),\n+            (r'a=\"b=\\\\134\"', 'b=\\\\134'),\n+            (r'a=\"b=\\\\\\\"\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\\\\\042\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\134\\\"\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\134\\042\"', 'b=\\\\\"'),\n+        ]\n+        for encoded, decoded in cases:\n+            with self.subTest(encoded):\n+                C = cookies.SimpleCookie()\n+                C.load(encoded)\n+                self.assertEqual(C['a'].value, decoded)\n+\n+    @support.requires_resource('cpu')\n+    def test_unquote_large(self):\n+        n = 10**6\n+        for encoded in r'\\\\', r'\\134':\n+            with self.subTest(encoded):\n+                data = 'a=\"b=' + encoded*n + ';\"'\n+                C = cookies.SimpleCookie()\n+                C.load(data)\n+                value = C['a'].value\n+                self.assertEqual(value[:3], 'b=\\\\')\n+                self.assertEqual(value[-2:], '\\\\;')\n+                self.assertEqual(len(value), n + 3)\n+\n     def test_load(self):\n         C = cookies.SimpleCookie()\n         C.load('Customer=\"WILE_E_COYOTE\"; Version=1; Path=/acme')\n```\n\nFilename: Misc/NEWS.d/next/Library/2024-08-16-19-13-21.gh-issue-123067.Nx9O4R.rst:\n```\n@@ -0,0 +1 @@\n+Fix quadratic complexity in parsing ``\"``-quoted cookie values with backslashes by :mod:`http.cookies`.\n```"
            },
            {
                "url": "https://github.com/python/cpython/commit/b2f11ca7667e4d57c71c1c88b255115f16042d9a",
                "content": "[3.10] gh-123067: Fix quadratic complexity in parsing \"-quoted cookie values with backslashes (GH-123075) (#123106)\n\nThis fixes CVE-2024-7592.\r\n(cherry picked from commit 44e458357fca05ca0ae2658d62c8c595b048b5ef)\r\n\r\nCo-authored-by: Serhiy Storchaka <storchaka@gmail.com>\n\nFilename: Lib/http/cookies.py:\n```\n@@ -184,8 +184,13 @@\ndef _quote(str):\n         return '\"' + str.translate(_Translator) + '\"'\n \n \n-_OctalPatt = re.compile(r\"\\\\[0-3][0-7][0-7]\")\n-_QuotePatt = re.compile(r\"[\\\\].\")\n+_unquote_sub = re.compile(r'\\\\(?:([0-3][0-7][0-7])|(.))').sub\n+\n+def _unquote_replace(m):\n+    if m[1]:\n+        return chr(int(m[1], 8))\n+    else:\n+        return m[2]\n \n def _unquote(str):\n     # If there aren't any doublequotes,\n\n@@ -205,30 +210,7 @@\ndef _unquote(str):\n     #    \\012 --> \\n\n     #    \\\"   --> \"\n     #\n-    i = 0\n-    n = len(str)\n-    res = []\n-    while 0 <= i < n:\n-        o_match = _OctalPatt.search(str, i)\n-        q_match = _QuotePatt.search(str, i)\n-        if not o_match and not q_match:              # Neither matched\n-            res.append(str[i:])\n-            break\n-        # else:\n-        j = k = -1\n-        if o_match:\n-            j = o_match.start(0)\n-        if q_match:\n-            k = q_match.start(0)\n-        if q_match and (not o_match or k < j):     # QuotePatt matched\n-            res.append(str[i:k])\n-            res.append(str[k+1])\n-            i = k + 2\n-        else:                                      # OctalPatt matched\n-            res.append(str[i:j])\n-            res.append(chr(int(str[j+1:j+4], 8)))\n-            i = j + 4\n-    return _nulljoin(res)\n+    return _unquote_sub(_unquote_replace, str)\n \n # The _getdate() routine is used to set the expiration time in the cookie's HTTP\n # header.  By default, _getdate() returns the current time in the appropriate\n```\n\nFilename: Lib/test/test_http_cookies.py:\n```\n@@ -5,6 +5,7 @@\nimport unittest\n from http import cookies\n import pickle\n+from test import support\n \n \n class CookieTests(unittest.TestCase):\n\n@@ -58,6 +59,43 @@\ndef test_basic(self):\n             for k, v in sorted(case['dict'].items()):\n                 self.assertEqual(C[k].value, v)\n \n+    def test_unquote(self):\n+        cases = [\n+            (r'a=\"b=\\\"\"', 'b=\"'),\n+            (r'a=\"b=\\\\\"', 'b=\\\\'),\n+            (r'a=\"b=\\=\"', 'b=='),\n+            (r'a=\"b=\\n\"', 'b=n'),\n+            (r'a=\"b=\\042\"', 'b=\"'),\n+            (r'a=\"b=\\134\"', 'b=\\\\'),\n+            (r'a=\"b=\\377\"', 'b=\\xff'),\n+            (r'a=\"b=\\400\"', 'b=400'),\n+            (r'a=\"b=\\42\"', 'b=42'),\n+            (r'a=\"b=\\\\042\"', 'b=\\\\042'),\n+            (r'a=\"b=\\\\134\"', 'b=\\\\134'),\n+            (r'a=\"b=\\\\\\\"\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\\\\\042\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\134\\\"\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\134\\042\"', 'b=\\\\\"'),\n+        ]\n+        for encoded, decoded in cases:\n+            with self.subTest(encoded):\n+                C = cookies.SimpleCookie()\n+                C.load(encoded)\n+                self.assertEqual(C['a'].value, decoded)\n+\n+    @support.requires_resource('cpu')\n+    def test_unquote_large(self):\n+        n = 10**6\n+        for encoded in r'\\\\', r'\\134':\n+            with self.subTest(encoded):\n+                data = 'a=\"b=' + encoded*n + ';\"'\n+                C = cookies.SimpleCookie()\n+                C.load(data)\n+                value = C['a'].value\n+                self.assertEqual(value[:3], 'b=\\\\')\n+                self.assertEqual(value[-2:], '\\\\;')\n+                self.assertEqual(len(value), n + 3)\n+\n     def test_load(self):\n         C = cookies.SimpleCookie()\n         C.load('Customer=\"WILE_E_COYOTE\"; Version=1; Path=/acme')\n```\n\nFilename: Misc/NEWS.d/next/Library/2024-08-16-19-13-21.gh-issue-123067.Nx9O4R.rst:\n```\n@@ -0,0 +1 @@\n+Fix quadratic complexity in parsing ``\"``-quoted cookie values with backslashes by :mod:`http.cookies`.\n```"
            },
            {
                "url": "https://github.com/python/cpython/commit/d4ac921a4b081f7f996a5d2b101684b67ba0ed7f",
                "content": "[3.11] gh-123067: Fix quadratic complexity in parsing \"-quoted cookie values with backslashes (GH-123075) (#123105)\n\nThis fixes CVE-2024-7592.\r\n(cherry picked from commit 44e458357fca05ca0ae2658d62c8c595b048b5ef)\r\n\r\nCo-authored-by: Serhiy Storchaka <storchaka@gmail.com>\n\nFilename: Lib/http/cookies.py:\n```\n@@ -184,8 +184,13 @@\ndef _quote(str):\n         return '\"' + str.translate(_Translator) + '\"'\n \n \n-_OctalPatt = re.compile(r\"\\\\[0-3][0-7][0-7]\")\n-_QuotePatt = re.compile(r\"[\\\\].\")\n+_unquote_sub = re.compile(r'\\\\(?:([0-3][0-7][0-7])|(.))').sub\n+\n+def _unquote_replace(m):\n+    if m[1]:\n+        return chr(int(m[1], 8))\n+    else:\n+        return m[2]\n \n def _unquote(str):\n     # If there aren't any doublequotes,\n\n@@ -205,30 +210,7 @@\ndef _unquote(str):\n     #    \\012 --> \\n\n     #    \\\"   --> \"\n     #\n-    i = 0\n-    n = len(str)\n-    res = []\n-    while 0 <= i < n:\n-        o_match = _OctalPatt.search(str, i)\n-        q_match = _QuotePatt.search(str, i)\n-        if not o_match and not q_match:              # Neither matched\n-            res.append(str[i:])\n-            break\n-        # else:\n-        j = k = -1\n-        if o_match:\n-            j = o_match.start(0)\n-        if q_match:\n-            k = q_match.start(0)\n-        if q_match and (not o_match or k < j):     # QuotePatt matched\n-            res.append(str[i:k])\n-            res.append(str[k+1])\n-            i = k + 2\n-        else:                                      # OctalPatt matched\n-            res.append(str[i:j])\n-            res.append(chr(int(str[j+1:j+4], 8)))\n-            i = j + 4\n-    return _nulljoin(res)\n+    return _unquote_sub(_unquote_replace, str)\n \n # The _getdate() routine is used to set the expiration time in the cookie's HTTP\n # header.  By default, _getdate() returns the current time in the appropriate\n```\n\nFilename: Lib/test/test_http_cookies.py:\n```\n@@ -5,6 +5,7 @@\nimport doctest\n from http import cookies\n import pickle\n+from test import support\n \n \n class CookieTests(unittest.TestCase):\n\n@@ -58,6 +59,43 @@\ndef test_basic(self):\n             for k, v in sorted(case['dict'].items()):\n                 self.assertEqual(C[k].value, v)\n \n+    def test_unquote(self):\n+        cases = [\n+            (r'a=\"b=\\\"\"', 'b=\"'),\n+            (r'a=\"b=\\\\\"', 'b=\\\\'),\n+            (r'a=\"b=\\=\"', 'b=='),\n+            (r'a=\"b=\\n\"', 'b=n'),\n+            (r'a=\"b=\\042\"', 'b=\"'),\n+            (r'a=\"b=\\134\"', 'b=\\\\'),\n+            (r'a=\"b=\\377\"', 'b=\\xff'),\n+            (r'a=\"b=\\400\"', 'b=400'),\n+            (r'a=\"b=\\42\"', 'b=42'),\n+            (r'a=\"b=\\\\042\"', 'b=\\\\042'),\n+            (r'a=\"b=\\\\134\"', 'b=\\\\134'),\n+            (r'a=\"b=\\\\\\\"\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\\\\\042\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\134\\\"\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\134\\042\"', 'b=\\\\\"'),\n+        ]\n+        for encoded, decoded in cases:\n+            with self.subTest(encoded):\n+                C = cookies.SimpleCookie()\n+                C.load(encoded)\n+                self.assertEqual(C['a'].value, decoded)\n+\n+    @support.requires_resource('cpu')\n+    def test_unquote_large(self):\n+        n = 10**6\n+        for encoded in r'\\\\', r'\\134':\n+            with self.subTest(encoded):\n+                data = 'a=\"b=' + encoded*n + ';\"'\n+                C = cookies.SimpleCookie()\n+                C.load(data)\n+                value = C['a'].value\n+                self.assertEqual(value[:3], 'b=\\\\')\n+                self.assertEqual(value[-2:], '\\\\;')\n+                self.assertEqual(len(value), n + 3)\n+\n     def test_load(self):\n         C = cookies.SimpleCookie()\n         C.load('Customer=\"WILE_E_COYOTE\"; Version=1; Path=/acme')\n```\n\nFilename: Misc/NEWS.d/next/Library/2024-08-16-19-13-21.gh-issue-123067.Nx9O4R.rst:\n```\n@@ -0,0 +1 @@\n+Fix quadratic complexity in parsing ``\"``-quoted cookie values with backslashes by :mod:`http.cookies`.\n```"
            },
            {
                "url": "https://github.com/python/cpython/commit/d662e2db2605515a767f88ad48096b8ac623c774",
                "content": "[3.9] gh-123067: Fix quadratic complexity in parsing \"-quoted cookie values with backslashes (GH-123075) (#123107)\n\nThis fixes CVE-2024-7592.\r\n(cherry picked from commit 44e458357fca05ca0ae2658d62c8c595b048b5ef)\r\n\r\nCo-authored-by: Serhiy Storchaka <storchaka@gmail.com>\n\nFilename: Lib/http/cookies.py:\n```\n@@ -184,8 +184,13 @@\ndef _quote(str):\n         return '\"' + str.translate(_Translator) + '\"'\n \n \n-_OctalPatt = re.compile(r\"\\\\[0-3][0-7][0-7]\")\n-_QuotePatt = re.compile(r\"[\\\\].\")\n+_unquote_sub = re.compile(r'\\\\(?:([0-3][0-7][0-7])|(.))').sub\n+\n+def _unquote_replace(m):\n+    if m[1]:\n+        return chr(int(m[1], 8))\n+    else:\n+        return m[2]\n \n def _unquote(str):\n     # If there aren't any doublequotes,\n\n@@ -205,30 +210,7 @@\ndef _unquote(str):\n     #    \\012 --> \\n\n     #    \\\"   --> \"\n     #\n-    i = 0\n-    n = len(str)\n-    res = []\n-    while 0 <= i < n:\n-        o_match = _OctalPatt.search(str, i)\n-        q_match = _QuotePatt.search(str, i)\n-        if not o_match and not q_match:              # Neither matched\n-            res.append(str[i:])\n-            break\n-        # else:\n-        j = k = -1\n-        if o_match:\n-            j = o_match.start(0)\n-        if q_match:\n-            k = q_match.start(0)\n-        if q_match and (not o_match or k < j):     # QuotePatt matched\n-            res.append(str[i:k])\n-            res.append(str[k+1])\n-            i = k + 2\n-        else:                                      # OctalPatt matched\n-            res.append(str[i:j])\n-            res.append(chr(int(str[j+1:j+4], 8)))\n-            i = j + 4\n-    return _nulljoin(res)\n+    return _unquote_sub(_unquote_replace, str)\n \n # The _getdate() routine is used to set the expiration time in the cookie's HTTP\n # header.  By default, _getdate() returns the current time in the appropriate\n```\n\nFilename: Lib/test/test_http_cookies.py:\n```\n@@ -5,6 +5,7 @@\nimport unittest\n from http import cookies\n import pickle\n+from test import support\n \n \n class CookieTests(unittest.TestCase):\n\n@@ -58,6 +59,43 @@\ndef test_basic(self):\n             for k, v in sorted(case['dict'].items()):\n                 self.assertEqual(C[k].value, v)\n \n+    def test_unquote(self):\n+        cases = [\n+            (r'a=\"b=\\\"\"', 'b=\"'),\n+            (r'a=\"b=\\\\\"', 'b=\\\\'),\n+            (r'a=\"b=\\=\"', 'b=='),\n+            (r'a=\"b=\\n\"', 'b=n'),\n+            (r'a=\"b=\\042\"', 'b=\"'),\n+            (r'a=\"b=\\134\"', 'b=\\\\'),\n+            (r'a=\"b=\\377\"', 'b=\\xff'),\n+            (r'a=\"b=\\400\"', 'b=400'),\n+            (r'a=\"b=\\42\"', 'b=42'),\n+            (r'a=\"b=\\\\042\"', 'b=\\\\042'),\n+            (r'a=\"b=\\\\134\"', 'b=\\\\134'),\n+            (r'a=\"b=\\\\\\\"\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\\\\\042\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\134\\\"\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\134\\042\"', 'b=\\\\\"'),\n+        ]\n+        for encoded, decoded in cases:\n+            with self.subTest(encoded):\n+                C = cookies.SimpleCookie()\n+                C.load(encoded)\n+                self.assertEqual(C['a'].value, decoded)\n+\n+    @support.requires_resource('cpu')\n+    def test_unquote_large(self):\n+        n = 10**6\n+        for encoded in r'\\\\', r'\\134':\n+            with self.subTest(encoded):\n+                data = 'a=\"b=' + encoded*n + ';\"'\n+                C = cookies.SimpleCookie()\n+                C.load(data)\n+                value = C['a'].value\n+                self.assertEqual(value[:3], 'b=\\\\')\n+                self.assertEqual(value[-2:], '\\\\;')\n+                self.assertEqual(len(value), n + 3)\n+\n     def test_load(self):\n         C = cookies.SimpleCookie()\n         C.load('Customer=\"WILE_E_COYOTE\"; Version=1; Path=/acme')\n```\n\nFilename: Misc/NEWS.d/next/Library/2024-08-16-19-13-21.gh-issue-123067.Nx9O4R.rst:\n```\n@@ -0,0 +1 @@\n+Fix quadratic complexity in parsing ``\"``-quoted cookie values with backslashes by :mod:`http.cookies`.\n```"
            },
            {
                "url": "https://github.com/python/cpython/commit/44e458357fca05ca0ae2658d62c8c595b048b5ef",
                "content": "gh-123067: Fix quadratic complexity in parsing \"-quoted cookie values with backslashes (GH-123075)\n\nThis fixes CVE-2024-7592.\n\nFilename: Lib/http/cookies.py:\n```\n@@ -184,8 +184,13 @@\ndef _quote(str):\n         return '\"' + str.translate(_Translator) + '\"'\n \n \n-_OctalPatt = re.compile(r\"\\\\[0-3][0-7][0-7]\")\n-_QuotePatt = re.compile(r\"[\\\\].\")\n+_unquote_sub = re.compile(r'\\\\(?:([0-3][0-7][0-7])|(.))').sub\n+\n+def _unquote_replace(m):\n+    if m[1]:\n+        return chr(int(m[1], 8))\n+    else:\n+        return m[2]\n \n def _unquote(str):\n     # If there aren't any doublequotes,\n\n@@ -205,30 +210,7 @@\ndef _unquote(str):\n     #    \\012 --> \\n\n     #    \\\"   --> \"\n     #\n-    i = 0\n-    n = len(str)\n-    res = []\n-    while 0 <= i < n:\n-        o_match = _OctalPatt.search(str, i)\n-        q_match = _QuotePatt.search(str, i)\n-        if not o_match and not q_match:              # Neither matched\n-            res.append(str[i:])\n-            break\n-        # else:\n-        j = k = -1\n-        if o_match:\n-            j = o_match.start(0)\n-        if q_match:\n-            k = q_match.start(0)\n-        if q_match and (not o_match or k < j):     # QuotePatt matched\n-            res.append(str[i:k])\n-            res.append(str[k+1])\n-            i = k + 2\n-        else:                                      # OctalPatt matched\n-            res.append(str[i:j])\n-            res.append(chr(int(str[j+1:j+4], 8)))\n-            i = j + 4\n-    return _nulljoin(res)\n+    return _unquote_sub(_unquote_replace, str)\n \n # The _getdate() routine is used to set the expiration time in the cookie's HTTP\n # header.  By default, _getdate() returns the current time in the appropriate\n```\n\nFilename: Lib/test/test_http_cookies.py:\n```\n@@ -5,6 +5,7 @@\nimport doctest\n from http import cookies\n import pickle\n+from test import support\n \n \n class CookieTests(unittest.TestCase):\n\n@@ -58,6 +59,43 @@\ndef test_basic(self):\n             for k, v in sorted(case['dict'].items()):\n                 self.assertEqual(C[k].value, v)\n \n+    def test_unquote(self):\n+        cases = [\n+            (r'a=\"b=\\\"\"', 'b=\"'),\n+            (r'a=\"b=\\\\\"', 'b=\\\\'),\n+            (r'a=\"b=\\=\"', 'b=='),\n+            (r'a=\"b=\\n\"', 'b=n'),\n+            (r'a=\"b=\\042\"', 'b=\"'),\n+            (r'a=\"b=\\134\"', 'b=\\\\'),\n+            (r'a=\"b=\\377\"', 'b=\\xff'),\n+            (r'a=\"b=\\400\"', 'b=400'),\n+            (r'a=\"b=\\42\"', 'b=42'),\n+            (r'a=\"b=\\\\042\"', 'b=\\\\042'),\n+            (r'a=\"b=\\\\134\"', 'b=\\\\134'),\n+            (r'a=\"b=\\\\\\\"\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\\\\\042\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\134\\\"\"', 'b=\\\\\"'),\n+            (r'a=\"b=\\134\\042\"', 'b=\\\\\"'),\n+        ]\n+        for encoded, decoded in cases:\n+            with self.subTest(encoded):\n+                C = cookies.SimpleCookie()\n+                C.load(encoded)\n+                self.assertEqual(C['a'].value, decoded)\n+\n+    @support.requires_resource('cpu')\n+    def test_unquote_large(self):\n+        n = 10**6\n+        for encoded in r'\\\\', r'\\134':\n+            with self.subTest(encoded):\n+                data = 'a=\"b=' + encoded*n + ';\"'\n+                C = cookies.SimpleCookie()\n+                C.load(data)\n+                value = C['a'].value\n+                self.assertEqual(value[:3], 'b=\\\\')\n+                self.assertEqual(value[-2:], '\\\\;')\n+                self.assertEqual(len(value), n + 3)\n+\n     def test_load(self):\n         C = cookies.SimpleCookie()\n         C.load('Customer=\"WILE_E_COYOTE\"; Version=1; Path=/acme')\n```\n\nFilename: Misc/NEWS.d/next/Library/2024-08-16-19-13-21.gh-issue-123067.Nx9O4R.rst:\n```\n@@ -0,0 +1 @@\n+Fix quadratic complexity in parsing ``\"``-quoted cookie values with backslashes by :mod:`http.cookies`.\n```"
            }
        ],
        "sw_version": "v3.8.19",
        "sw_version_wget": "https://github.com/python/cpython/archive/refs/tags/v3.8.19.zip",
        "description": "There is a LOW severity vulnerability affecting CPython, specifically the\n'http.cookies' standard library module.\n\n\nWhen parsing cookies that contained backslashes for quoted characters in\nthe cookie value, the parser would use an algorithm with quadratic\ncomplexity, resulting in excess CPU resources being used while parsing the\nvalue.",
        "sec_adv": [],
        "cwe": [
            {
                "id": "CWE-400",
                "value": "CWE-400 Uncontrolled Resource Consumption"
            }
        ]
    }
}