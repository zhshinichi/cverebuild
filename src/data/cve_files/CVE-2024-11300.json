{
    "CVE-2024-11300": {
        "published_date": "2025-03-20T10:11:19.503Z",
        "patch_commits": [
            {
                "url": "https://github.com/lunary-ai/lunary/commit/79dc370596d979b756f6ea0250d97a2d02385ecd",
                "content": "fix: security patches (#654)\n\nFilename: packages/backend/src/api/v1/template-versions.ts:\n```\n@@ -96,16 +96,18 @@\nversions.get(\"/latest\", async (ctx: Context) => {\n versions.get(\"/:id\", async (ctx: Context) => {\n   const { id: versionId } = ctx.params;\n   const { projectId } = ctx.state;\n+  console.log(\"projectId\", projectId);\n \n   const [version] = await sql`\n     select\n       tv.*\n     from\n       template_version tv\n       left join template t on tv.template_id = t.id\n-      left join project p on t.project_id = p.id and p.id = ${projectId}\n+      left join project p on t.project_id = p.id \n     where\n       tv.id = ${versionId}\n+      and p.id = ${projectId}\n   `;\n   if (!version) {\n     ctx.throw(401, \"You do not have access to this ressource.\");\n```\n\nFilename: packages/db/0051.sql:\n```\n@@ -0,0 +1 @@\n+alter table evaluator add constraint evaluator_project_id_slug_unique unique (project_id, slug);\n\\ No newline at end of file\n```"
            }
        ],
        "sw_version": "v1.6.2",
        "sw_version_wget": "https://github.com/lunary-ai/lunary/archive/refs/tags/v1.6.2.zip",
        "description": "In lunary-ai/lunary before version 1.6.3, an improper access control vulnerability exists where a user can access prompt data of another user. This issue affects version 1.6.2 and the main branch. The vulnerability allows unauthorized users to view sensitive prompt data by accessing specific URLs, leading to potential exposure of critical information.",
        "sec_adv": [
            {
                "url": "https://huntr.com/bounties/8dca7994-0d92-491e-a419-02adfe23ffa4",
                "content": "Bounties\nPartners\nCommunity\nInfo\nSUBMIT REPORT\nImproper access of prompt data by another user. in lunary-ai/lunary\nValid\nReported on Nov 15th 2024\nDescription\nAnother user can able to see the prompts data of a particular users.\nProof of Concept\nlet prompt_id be the prompt id of user 1\nvisit http://127.0.0.1:8080/prompts/prompt_id from another users( user 2) session\nuser 2 can see the user 1 prompt_id's data.\nPreviously it was reported by some one it was closed as fixed. But some how the bug is still there.\nImpact\nCritical, the sensitive data used in prompts is exposed. Which is most important things when using AI.\nOccurrences\ntemplate-versions.ts L96-L119\nfocus on sql query and project id\nWe are processing your report and will contact thelunary-ai/lunary team within 24 hours.6 months ago\nKunam Balaram Reddy modified the report6 months ago\nKunam Balaram Reddy\ncommented6 months ago\nResearcher\nPreviously it was reported by some one it was closed as fixed. But some how the bug is still there.\nKunam Balaram Reddy\ncommented6 months ago\nResearcher\nEven the fix bounty was given for that. https://huntr.com/bounties/52c129f2-114e-492f-aee8-32c78f75ac4f\nKunam Balaram Reddy\ncommented6 months ago\nResearcher\nI tried to use some random ids that came to my mind while initially testing on web offering of lunar. Able to see the prompts data. Later realised, i shouldnt and sifted to local testing running dev server. PLease Excuse me for that. I will learn from my mistakes. Thank you.\nHugues Chocart validated this vulnerability6 months ago\nwebbdayshas been awarded the disclosure bounty\nThe fix bounty is now up for grabs\nThe researcher's credibility has increased: +7\nCVE-2024-11300assigned to this report.6 months ago\nHugues Chocartmarked this as fixedin 1.6.3with commit79dc376 months ago\nHugues Chocarthas been awarded the fix bounty\ntemplate-versions.ts#L96-L119 has been validated\nKunam Balaram Reddy\ncommented6 months ago\nResearcher\nThank you very much.\nKunam Balaram Reddy\ncommented6 months ago\nResearcher\nPlease mask my n-2 comment before making this report public to the world\nKunam Balaram Reddy\ncommented6 months ago\nResearcher\n@huntr https://huntr.com/bounties/83565654-3d30-4494-83d9-1d05a698bf20 this report is valid as bug not properly fixed in https://huntr.com/bounties/52c129f2-114e-492f-aee8-32c78f75ac4f\nis the huntr-helper an AI. it is making mistakes. Please check\nKunam Balaram Reddy\ncommented6 months ago\nResearcher\nKindly let me know when can i expect 20% bonus for Occurrences permalink given.\nWe have notified the lunary-ai/lunary maintainers about this report in their weekly follow-up3 months ago\nWe have sent a warning to the lunary-ai/lunary team to inform them that this report will be published in 48 hours3 months ago\nThis vulnerability has now been published3 months ago\nCVE-2024-11300has now been published2 months ago\nSign in to join this conversation\nCVE\nCVE-2024-11300\n(Published)\nVulnerability Type\nCWE-284: Improper Access Control\nSeverity\nHigh (8.8)\nAttack vector\nNetwork\nAttack complexity\nLow\nPrivileges required\nLow\nUser interaction\nNone\nScope\nUnchanged\nConfidentiality\nHigh\nIntegrity\nHigh\nAvailability\nHigh\nOpen in visual CVSS calculator\nRegistry\nNpm\nAffected Version\n1.6.2, main branch. Need to check other versions\nVisibility\nPublic\nStatus\nFixed\nDisclosure Bounty\n$450\nFix Bounty\n$112.5\nFound by\nFixed by\nSupported by Protect AI and leading the way to MLSecOps and greater AI security.\nÂ© 2024\nPrivacy Policy\nTerms of Service\nCode of Conduct\nCookie Preferences\nContact Us",
                "effective": true,
                "effective_reason": "The provided security advisory includes a detailed proof of concept that describes specific steps to exploit the vulnerability."
            }
        ],
        "cwe": [
            {
                "id": "CWE-284",
                "value": "CWE-284 Improper Access Control"
            }
        ]
    }
}