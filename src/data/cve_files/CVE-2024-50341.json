{
    "CVE-2024-50341": {
        "published_date": "2024-11-06T21:06:49.426Z",
        "patch_commits": [
            {
                "url": "https://github.com/symfony/symfony/commit/22a0789a0085c3ee96f4ef715ecad8255cf0e105",
                "content": "use firewall-specific user checkers when manually logging in users\n\nFilename: src/Symfony/Bundle/SecurityBundle/DependencyInjection/SecurityExtension.php:\n```\n@@ -579,6 +579,9 @@\nprivate function createFirewall(ContainerBuilder $container, string $id, array $\n \n         $container->setAlias('security.user_checker.'.$id, new Alias($firewall['user_checker'], false));\n \n+        $userCheckerLocator = $container->getDefinition('security.user_checker_locator');\n+        $userCheckerLocator->replaceArgument(0, array_merge($userCheckerLocator->getArgument(0), [$id => new ServiceClosureArgument(new Reference('security.user_checker.'.$id))]));\n+\n         foreach ($this->getSortedFactories() as $factory) {\n             $key = str_replace('-', '_', $factory->getKey());\n             if ('custom_authenticators' !== $key && \\array_key_exists($key, $firewall)) {\n```\n\nFilename: src/Symfony/Bundle/SecurityBundle/Resources/config/security.php:\n```\n@@ -19,6 +19,7 @@\nuse Symfony\\Bundle\\SecurityBundle\\Security\\FirewallContext;\n use Symfony\\Bundle\\SecurityBundle\\Security\\FirewallMap;\n use Symfony\\Bundle\\SecurityBundle\\Security\\LazyFirewallContext;\n+use Symfony\\Component\\DependencyInjection\\ServiceLocator;\n use Symfony\\Component\\ExpressionLanguage\\ExpressionLanguage as BaseExpressionLanguage;\n use Symfony\\Component\\Ldap\\Security\\LdapUserProvider;\n use Symfony\\Component\\Security\\Core\\Authentication\\AuthenticationTrustResolver;\n\n@@ -88,7 +89,7 @@\n'security.authenticator.managers_locator' => service('security.authenticator.managers_locator')->ignoreOnInvalid(),\n                     'request_stack' => service('request_stack'),\n                     'security.firewall.map' => service('security.firewall.map'),\n-                    'security.user_checker' => service('security.user_checker'),\n+                    'security.user_checker_locator' => service('security.user_checker_locator'),\n                     'security.firewall.event_dispatcher_locator' => service('security.firewall.event_dispatcher_locator'),\n                     'security.csrf.token_manager' => service('security.csrf.token_manager')->ignoreOnInvalid(),\n                 ]),\n\n@@ -124,6 +125,8 @@\n->args(['none'])\n \n         ->set('security.user_checker', InMemoryUserChecker::class)\n+        ->set('security.user_checker_locator', ServiceLocator::class)\n+            ->args([[]])\n \n         ->set('security.expression_language', ExpressionLanguage::class)\n             ->args([service('cache.security_expression_language')->nullOnInvalid()])\n```\n\nFilename: src/Symfony/Bundle/SecurityBundle/Security.php:\n```\n@@ -127,7 +127,8 @@\npublic function login(UserInterface $user, ?string $authenticatorName = null, ?s\n \n         $authenticator = $this->getAuthenticator($authenticatorName, $firewallName);\n \n-        $this->container->get('security.user_checker')->checkPreAuth($user);\n+        $userCheckerLocator = $this->container->get('security.user_checker_locator');\n+        $userCheckerLocator->get($firewallName)->checkPreAuth($user);\n \n         return $this->container->get('security.authenticator.managers_locator')->get($firewallName)->authenticateUser($user, $authenticator, $request, $badges);\n     }\n```\n\nFilename: src/Symfony/Bundle/SecurityBundle/Tests/SecurityTest.php:\n```\n@@ -142,7 +142,7 @@\npublic function testLogin()\n                 ['request_stack', $requestStack],\n                 ['security.firewall.map', $firewallMap],\n                 ['security.authenticator.managers_locator', $this->createContainer('main', $userAuthenticator)],\n-                ['security.user_checker', $userChecker],\n+                ['security.user_checker_locator', $this->createContainer('main', $userChecker)],\n             ])\n         ;\n\n@@ -188,7 +188,7 @@\npublic function testLoginReturnsAuthenticatorResponse()\n                 ['request_stack', $requestStack],\n                 ['security.firewall.map', $firewallMap],\n                 ['security.authenticator.managers_locator', $this->createContainer('main', $userAuthenticator)],\n-                ['security.user_checker', $userChecker],\n+                ['security.user_checker_locator', $this->createContainer('main', $userChecker)],\n             ])\n         ;\n```"
            }
        ],
        "sw_version": "v6.2.0",
        "sw_version_wget": "https://github.com/symfony/symfony/archive/refs/tags/v6.2.0.zip",
        "description": "symfony/security-bundle is a module for the Symphony PHP framework which provides a tight integration of the Security component into the Symfony full-stack framework. The custom `user_checker` defined on a firewall is not called when Login Programmaticaly with the `Security::login` method, leading to  unwanted login. As of versions 6.4.10, 7.0.10 and 7.1.3 the `Security::login` method now ensure to call the configured `user_checker`. All users are advised to upgrade. There are no known workarounds for this vulnerability.",
        "sec_adv": [
            {
                "url": "https://github.com/symfony/symfony/security/advisories/GHSA-jxgr-3v7q-3w9v",
                "content": "Skip to content\nNavigation Menu\nProduct\nSolutions\nResources\nOpen Source\nEnterprise\nPricing\nSearch or jump to...\nSign in\nSign up\nAppearance settings\nDismiss alert\nsymfony\n/\nsymfony\nPublic\nSponsor\nNotifications You must be signed in to change notification settings\nFork 9.6k\nStar 30.3k\nCode\nIssues\n531\nPull requests\n292\nDiscussions\nActions\nProjects\nSecurity\n24\nInsights\nAdditional navigation options\nSecurity::login does not take into account custom user_checker\nLow fabpot published GHSA-jxgr-3v7q-3w9v on Nov 6, 2024Nov 6, 2024\nPackage\ncomposer symfony/security-bundle\n(\nComposer\n)\nAffected versions\n>=6.2, <6.4.10\n>=7.0, <7.0.10\n>=7.1, <7.1.3\nPatched versions\n6.4.10\n7.0.10\n7.1.3\nDescription\nDescription\nThe custom user_checker defined on a firewall is not called when Login Programmaticaly with the Security::login method, leading to unwanted login.\nResolution\nThe Security::login method now ensure to call the configured user_checker.\nThe patch for this issue is available here for branch 6.4.\nCredits\nWe would like to thank Oleg Andreyev, Antoine MAKDESSI for reporting the issue and Christian Flothmann for providing the fix.\nSeverity\nLow\n3.1\n/ 10\nCVSS v3 base metrics\nAttack vector\nNetwork\nAttack complexity\nHigh\nPrivileges required\nLow\nUser interaction\nNone\nScope\nUnchanged\nConfidentiality\nNone\nIntegrity\nLow\nAvailability\nNone\nLearn more about base metrics\nCVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N\nCVE ID\nCVE-2024-50341\nWeaknesses\nNo CWEs\nCredits\n94noni\nReporter\nxabbuh\nRemediation developer\nFooter\nÂ© 2025 GitHub, Inc.\nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\nManage cookies\nDo not share my personal information",
                "effective": false,
                "effective_reason": "The provided advisory does not include explicit proof of concept code or detailed reproduction steps. It mainly describes the issue and how it was addressed."
            }
        ],
        "cwe": [
            {
                "id": "CWE-287",
                "value": "CWE-287: Improper Authentication"
            }
        ]
    }
}