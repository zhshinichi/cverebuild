{
    "CVE-2024-50342": {
        "published_date": "2024-11-06T21:03:12.331Z",
        "patch_commits": [
            {
                "url": "https://github.com/symfony/symfony/commit/296d4b34a33b1a6ca5475c6040b3203622520f5b",
                "content": "[HttpClient] Filter private IPs before connecting when Host == IP\n\nFilename: src/Symfony/Component/HttpClient/NoPrivateNetworkHttpClient.php:\n```\n@@ -77,9 +77,20 @@\npublic function request(string $method, string $url, array $options = []): Respo\n         }\n \n         $subnets = $this->subnets;\n+        $lastUrl = '';\n         $lastPrimaryIp = '';\n \n-        $options['on_progress'] = function (int $dlNow, int $dlSize, array $info) use ($onProgress, $subnets, &$lastPrimaryIp): void {\n+        $options['on_progress'] = function (int $dlNow, int $dlSize, array $info) use ($onProgress, $subnets, &$lastUrl, &$lastPrimaryIp): void {\n+            if ($info['url'] !== $lastUrl) {\n+                $host = trim(parse_url($info['url'], PHP_URL_HOST) ?: '', '[]');\n+\n+                if ($host && IpUtils::checkIp($host, $subnets ?? self::PRIVATE_SUBNETS)) {\n+                    throw new TransportException(sprintf('Host \"%s\" is blocked for \"%s\".', $host, $info['url']));\n+                }\n+\n+                $lastUrl = $info['url'];\n+            }\n+\n             if ($info['primary_ip'] !== $lastPrimaryIp) {\n                 if ($info['primary_ip'] && IpUtils::checkIp($info['primary_ip'], $subnets ?? self::PRIVATE_SUBNETS)) {\n                     throw new TransportException(sprintf('IP \"%s\" is blocked for \"%s\".', $info['primary_ip'], $info['url']));\n```\n\nFilename: src/Symfony/Component/HttpClient/Tests/NoPrivateNetworkHttpClientTest.php:\n```\n@@ -65,10 +65,10 @@\npublic static function getExcludeData(): array\n     /**\n      * @dataProvider getExcludeData\n      */\n-    public function testExclude(string $ipAddr, $subnets, bool $mustThrow)\n+    public function testExcludeByIp(string $ipAddr, $subnets, bool $mustThrow)\n     {\n         $content = 'foo';\n-        $url = sprintf('http://%s/', 0 < substr_count($ipAddr, ':') ? sprintf('[%s]', $ipAddr) : $ipAddr);\n+        $url = sprintf('http://%s/', strtr($ipAddr, '.:', '--'));\n \n         if ($mustThrow) {\n             $this->expectException(TransportException::class);\n\n@@ -85,6 +85,29 @@\npublic function testExclude(string $ipAddr, $subnets, bool $mustThrow)\n         }\n     }\n \n+    /**\n+     * @dataProvider getExcludeData\n+     */\n+    public function testExcludeByHost(string $ipAddr, $subnets, bool $mustThrow)\n+    {\n+        $content = 'foo';\n+        $url = sprintf('http://%s/', str_contains($ipAddr, ':') ? sprintf('[%s]', $ipAddr) : $ipAddr);\n+\n+        if ($mustThrow) {\n+            $this->expectException(TransportException::class);\n+            $this->expectExceptionMessage(sprintf('Host \"%s\" is blocked for \"%s\".', $ipAddr, $url));\n+        }\n+\n+        $previousHttpClient = $this->getHttpClientMock($url, $ipAddr, $content);\n+        $client = new NoPrivateNetworkHttpClient($previousHttpClient, $subnets);\n+        $response = $client->request('GET', $url);\n+\n+        if (!$mustThrow) {\n+            $this->assertEquals($content, $response->getContent());\n+            $this->assertEquals(200, $response->getStatusCode());\n+        }\n+    }\n+\n     public function testCustomOnProgressCallback()\n     {\n         $ipAddr = '104.26.14.6';\n```"
            }
        ],
        "sw_version": "v5.4.45",
        "sw_version_wget": "https://github.com/symfony/symfony/archive/refs/tags/v5.4.45.zip",
        "description": "symfony/http-client is a module for the Symphony PHP framework which provides powerful methods to fetch HTTP resources synchronously or asynchronously. When using the `NoPrivateNetworkHttpClient`, some internal information is still leaking during host resolution, which leads to possible IP/port enumeration. As of versions 5.4.46, 6.4.14, and 7.1.7 the `NoPrivateNetworkHttpClient` now filters blocked IPs earlier to prevent such leaks. All users are advised to upgrade. There are no known workarounds for this vulnerability.",
        "sec_adv": [
            {
                "url": "https://github.com/symfony/symfony/security/advisories/GHSA-9c3x-r3wp-mgxm",
                "content": "Skip to content\nNavigation Menu\nProduct\nSolutions\nResources\nOpen Source\nEnterprise\nPricing\nSearch or jump to...\nSign in\nSign up\nAppearance settings\nDismiss alert\nsymfony\n/\nsymfony\nPublic\nSponsor\nNotifications You must be signed in to change notification settings\nFork 9.6k\nStar 30.3k\nCode\nIssues\n531\nPull requests\n292\nDiscussions\nActions\nProjects\nSecurity\n24\nInsights\nAdditional navigation options\nInternal address and port enumeration allowed by NoPrivateNetworkHttpClient\nLow fabpot published GHSA-9c3x-r3wp-mgxm on Nov 6, 2024Nov 6, 2024\nPackage\ncomposer symfony/http-client\n(\nComposer\n)\nAffected versions\n<5.4.47\n>=6, <6.4.15\n>=7, <7.1.8\nPatched versions\n5.4.47\n6.4.15\n7.1.8\nDescription\nDescription\nWhen using the NoPrivateNetworkHttpClient, some internal information is still leaking during host resolution, which leads to possible IP/port enumeration.\nResolution\nThe NoPrivateNetworkHttpClient now filters blocked IPs earlier to prevent such leaks.\nThe fisrt patch for this issue is available here for branch 5.4.\nThe second one is available here for branch 5.4 also.\nCredits\nWe would like to thank Linus Karlsson and Chris Smith for reporting the issue and Nicolas Grekas for providing the fix.\nSeverity\nLow\n3.1\n/ 10\nCVSS v3 base metrics\nAttack vector\nNetwork\nAttack complexity\nHigh\nPrivileges required\nLow\nUser interaction\nNone\nScope\nUnchanged\nConfidentiality\nLow\nIntegrity\nNone\nAvailability\nNone\nLearn more about base metrics\nCVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N\nCVE ID\nCVE-2024-50342\nWeaknesses\nNo CWEs\nCredits\nnicolas-grekas\nRemediation developer\nzozs\nReporter\ncs278\nReporter\nFooter\nÂ© 2025 GitHub, Inc.\nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\nManage cookies\nDo not share my personal information",
                "effective": false,
                "effective_reason": "The advisory describes the vulnerability and mentions that it was resolved, but it does not include proof of concept or steps to recreate the issue."
            }
        ],
        "cwe": [
            {
                "id": "CWE-200",
                "value": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor"
            }
        ]
    }
}