{
    "CVE-2024-8005": {
        "published_date": "2024-08-20T14:00:08.350Z",
        "patch_commits": [
            {
                "url": "https://github.com/demozx/gf_cms/commit/be702ada7cb6fdabc02689d90b38139c827458a5",
                "content": "修复jwt安全问题，新增server.jwtKey配置，不配置则使用server.projectName\n\nFilename: internal/logic/auth/auth.go:\n```\n@@ -3,6 +3,7 @@\npackage auth\n import (\n \t\"context\"\n \t\"gf_cms/internal/logic/admin\"\n+\t\"gf_cms/internal/logic/util\"\n \t\"gf_cms/internal/model\"\n \t\"gf_cms/internal/service\"\n \t\"time\"\n\n@@ -33,8 +34,8 @@\nfunc init() {\n \tservice.RegisterAuth(New())\n \n \tauth := jwt.New(&jwt.GfJWTMiddleware{\n-\t\tRealm:           \"test zone\",\n-\t\tKey:             []byte(\"secret key\"),\n+\t\tRealm:           util.Util().ProjectName() + \"_backend\",\n+\t\tKey:             []byte(util.Util().JwtKey()),\n \t\tTimeout:         time.Minute * 5,\n \t\tMaxRefresh:      time.Minute * 5,\n \t\tIdentityKey:     \"id\",\n```\n\nFilename: internal/logic/util/util.go:\n```\n@@ -78,6 +78,15 @@\nfunc (*sUtil) ProjectName() string {\n \treturn ProjectName.String()\n }\n \n+// JwtKey 获取JwtKey\n+func (*sUtil) JwtKey() string {\n+\tjwtKey := Util().GetConfig(\"server.jwtKey\")\n+\tif jwtKey == \"\" {\n+\t\treturn ProjectName.String()\n+\t}\n+\treturn jwtKey\n+}\n+\n // SystemRoot 获取SystemRoot\n func (*sUtil) SystemRoot() string {\n \treturn SystemRoot\n```\n\nFilename: internal/service/util.go:\n```\n@@ -18,6 +18,8 @@\ntype (\n \t\tDryRun() bool\n \t\t// ProjectName 获取ProjectName\n \t\tProjectName() string\n+\t\t// JwtKey 获取JwtKey\n+\t\tJwtKey() string\n \t\t// SystemRoot 获取SystemRoot\n \t\tSystemRoot() string\n \t\t// BackendPrefix 后台入口前缀\n```\n\nFilename: manifest/config/config.yaml.example:\n```\n@@ -2,6 +2,7 @@\nserver:\n   projectName: \"gf_cms\"\n   backendPrefix: \"admin\"\n   address: \":8001\"\n+  jwtKey: \"\" # jwt密钥，不配置将使用projectName，为了安全一定要配置\n   openapiPath: \"/api.json\"\n   #  swaggerPath: \"/swagger\" #使用自定义SwaggerUI,需注释该行\n   serverRoot: \"resource/public\"\n```"
            },
            {
                "url": "https://github.com/demozx/gf_cms/commit/de51cc57a96ccca905c837ef925c2cc3a5241383",
                "content": "Merge branch 'hotfix/1.0.2'\n修复jwt安全问题，新增server.jwtKey配置，不配置则使用server.projectName\n\nFilename: internal/logic/auth/auth.go:\n```\n@@ -3,6 +3,7 @@\npackage auth\n import (\n \t\"context\"\n \t\"gf_cms/internal/logic/admin\"\n+\t\"gf_cms/internal/logic/util\"\n \t\"gf_cms/internal/model\"\n \t\"gf_cms/internal/service\"\n \t\"time\"\n\n@@ -33,8 +34,8 @@\nfunc init() {\n \tservice.RegisterAuth(New())\n \n \tauth := jwt.New(&jwt.GfJWTMiddleware{\n-\t\tRealm:           \"test zone\",\n-\t\tKey:             []byte(\"secret key\"),\n+\t\tRealm:           util.Util().ProjectName() + \"_backend\",\n+\t\tKey:             []byte(util.Util().JwtKey()),\n \t\tTimeout:         time.Minute * 5,\n \t\tMaxRefresh:      time.Minute * 5,\n \t\tIdentityKey:     \"id\",\n```\n\nFilename: internal/logic/util/util.go:\n```\n@@ -78,6 +78,15 @@\nfunc (*sUtil) ProjectName() string {\n \treturn ProjectName.String()\n }\n \n+// JwtKey 获取JwtKey\n+func (*sUtil) JwtKey() string {\n+\tjwtKey := Util().GetConfig(\"server.jwtKey\")\n+\tif jwtKey == \"\" {\n+\t\treturn ProjectName.String()\n+\t}\n+\treturn jwtKey\n+}\n+\n // SystemRoot 获取SystemRoot\n func (*sUtil) SystemRoot() string {\n \treturn SystemRoot\n```\n\nFilename: internal/service/util.go:\n```\n@@ -18,6 +18,8 @@\ntype (\n \t\tDryRun() bool\n \t\t// ProjectName 获取ProjectName\n \t\tProjectName() string\n+\t\t// JwtKey 获取JwtKey\n+\t\tJwtKey() string\n \t\t// SystemRoot 获取SystemRoot\n \t\tSystemRoot() string\n \t\t// BackendPrefix 后台入口前缀\n```\n\nFilename: manifest/config/config.yaml.example:\n```\n@@ -2,6 +2,7 @@\nserver:\n   projectName: \"gf_cms\"\n   backendPrefix: \"admin\"\n   address: \":8001\"\n+  jwtKey: \"\" # jwt密钥，不配置将使用projectName，为了安全一定要配置\n   openapiPath: \"/api.json\"\n   #  swaggerPath: \"/swagger\" #使用自定义SwaggerUI,需注释该行\n   serverRoot: \"resource/public\"\n```"
            }
        ],
        "sw_version": "v1.0",
        "sw_version_wget": "https://github.com/demozx/gf_cms/archive/refs/tags/v1.0.zip",
        "description": "A vulnerability was found in demozx gf_cms 1.0/1.0.1. It has been classified as critical. This affects the function init of the file internal/logic/auth/auth.go of the component JWT Authentication. The manipulation leads to hard-coded credentials. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 1.0.2 is able to address this issue. The patch is named be702ada7cb6fdabc02689d90b38139c827458a5. It is recommended to upgrade the affected component.",
        "sec_adv": [],
        "cwe": [
            {
                "id": "CWE-798",
                "value": "CWE-798 Hard-coded Credentials"
            }
        ]
    }
}