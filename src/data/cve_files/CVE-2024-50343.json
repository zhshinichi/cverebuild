{
    "CVE-2024-50343": {
        "published_date": "2024-11-06T21:00:55.266Z",
        "patch_commits": [
            {
                "url": "https://github.com/symfony/symfony/commit/7d1032bbead9a4229b32fa6ebca32681c80cb76f",
                "content": "[Validator] Add `D` regex modifier in relevant validators\n\nFilename: src/Symfony/Component/Validator/Constraints/CardSchemeValidator.php:\n```\n@@ -29,65 +29,65 @@\nclass CardSchemeValidator extends ConstraintValidator\n     protected $schemes = [\n         // American Express card numbers start with 34 or 37 and have 15 digits.\n         CardScheme::AMEX => [\n-            '/^3[47][0-9]{13}$/',\n+            '/^3[47][0-9]{13}$/D',\n         ],\n         // China UnionPay cards start with 62 and have between 16 and 19 digits.\n         // Please note that these cards do not follow Luhn Algorithm as a checksum.\n         CardScheme::CHINA_UNIONPAY => [\n-            '/^62[0-9]{14,17}$/',\n+            '/^62[0-9]{14,17}$/D',\n         ],\n         // Diners Club card numbers begin with 300 through 305, 36 or 38. All have 14 digits.\n         // There are Diners Club cards that begin with 5 and have 16 digits.\n         // These are a joint venture between Diners Club and MasterCard, and should be processed like a MasterCard.\n         CardScheme::DINERS => [\n-            '/^3(?:0[0-5]|[68][0-9])[0-9]{11}$/',\n+            '/^3(?:0[0-5]|[68][0-9])[0-9]{11}$/D',\n         ],\n         // Discover card numbers begin with 6011, 622126 through 622925, 644 through 649 or 65.\n         // All have 16 digits.\n         CardScheme::DISCOVER => [\n-            '/^6011[0-9]{12}$/',\n-            '/^64[4-9][0-9]{13}$/',\n-            '/^65[0-9]{14}$/',\n-            '/^622(12[6-9]|1[3-9][0-9]|[2-8][0-9][0-9]|91[0-9]|92[0-5])[0-9]{10}$/',\n+            '/^6011[0-9]{12}$/D',\n+            '/^64[4-9][0-9]{13}$/D',\n+            '/^65[0-9]{14}$/D',\n+            '/^622(12[6-9]|1[3-9][0-9]|[2-8][0-9][0-9]|91[0-9]|92[0-5])[0-9]{10}$/D',\n         ],\n         // InstaPayment cards begin with 637 through 639 and have 16 digits.\n         CardScheme::INSTAPAYMENT => [\n-            '/^63[7-9][0-9]{13}$/',\n+            '/^63[7-9][0-9]{13}$/D',\n         ],\n         // JCB cards beginning with 2131 or 1800 have 15 digits.\n         // JCB cards beginning with 35 have 16 digits.\n         CardScheme::JCB => [\n-            '/^(?:2131|1800|35[0-9]{3})[0-9]{11}$/',\n+            '/^(?:2131|1800|35[0-9]{3})[0-9]{11}$/D',\n         ],\n         // Laser cards begin with either 6304, 6706, 6709 or 6771 and have between 16 and 19 digits.\n         CardScheme::LASER => [\n-            '/^(6304|670[69]|6771)[0-9]{12,15}$/',\n+            '/^(6304|670[69]|6771)[0-9]{12,15}$/D',\n         ],\n         // Maestro international cards begin with 675900..675999 and have between 12 and 19 digits.\n         // Maestro UK cards begin with either 500000..509999 or 560000..699999 and have between 12 and 19 digits.\n         CardScheme::MAESTRO => [\n-            '/^(6759[0-9]{2})[0-9]{6,13}$/',\n-            '/^(50[0-9]{4})[0-9]{6,13}$/',\n-            '/^5[6-9][0-9]{10,17}$/',\n-            '/^6[0-9]{11,18}$/',\n+            '/^(6759[0-9]{2})[0-9]{6,13}$/D',\n+            '/^(50[0-9]{4})[0-9]{6,13}$/D',\n+            '/^5[6-9][0-9]{10,17}$/D',\n+            '/^6[0-9]{11,18}$/D',\n         ],\n         // All MasterCard numbers start with the numbers 51 through 55. All have 16 digits.\n         // October 2016 MasterCard numbers can also start with 222100 through 272099.\n         CardScheme::MASTERCARD => [\n-            '/^5[1-5][0-9]{14}$/',\n-            '/^2(22[1-9][0-9]{12}|2[3-9][0-9]{13}|[3-6][0-9]{14}|7[0-1][0-9]{13}|720[0-9]{12})$/',\n+            '/^5[1-5][0-9]{14}$/D',\n+            '/^2(22[1-9][0-9]{12}|2[3-9][0-9]{13}|[3-6][0-9]{14}|7[0-1][0-9]{13}|720[0-9]{12})$/D',\n         ],\n         // Payment system MIR numbers start with 220, then 1 digit from 0 to 4, then between 12 and 15 digits\n         CardScheme::MIR => [\n-            '/^220[0-4][0-9]{12,15}$/',\n+            '/^220[0-4][0-9]{12,15}$/D',\n         ],\n         // All UATP card numbers start with a 1 and have a length of 15 digits.\n         CardScheme::UATP => [\n-            '/^1[0-9]{14}$/',\n+            '/^1[0-9]{14}$/D',\n         ],\n         // All Visa card numbers start with a 4 and have a length of 13, 16, or 19 digits.\n         CardScheme::VISA => [\n-            '/^4([0-9]{12}|[0-9]{15}|[0-9]{18})$/',\n+            '/^4([0-9]{12}|[0-9]{15}|[0-9]{18})$/D',\n         ],\n     ];\n```\n\nFilename: src/Symfony/Component/Validator/Constraints/CssColorValidator.php:\n```\n@@ -21,21 +21,21 @@\n*/\n class CssColorValidator extends ConstraintValidator\n {\n-    private const PATTERN_HEX_LONG = '/^#[0-9a-f]{6}$/i';\n-    private const PATTERN_HEX_LONG_WITH_ALPHA = '/^#[0-9a-f]{8}$/i';\n-    private const PATTERN_HEX_SHORT = '/^#[0-9a-f]{3}$/i';\n-    private const PATTERN_HEX_SHORT_WITH_ALPHA = '/^#[0-9a-f]{4}$/i';\n+    private const PATTERN_HEX_LONG = '/^#[0-9a-f]{6}$/iD';\n+    private const PATTERN_HEX_LONG_WITH_ALPHA = '/^#[0-9a-f]{8}$/iD';\n+    private const PATTERN_HEX_SHORT = '/^#[0-9a-f]{3}$/iD';\n+    private const PATTERN_HEX_SHORT_WITH_ALPHA = '/^#[0-9a-f]{4}$/iD';\n     // List comes from https://www.w3.org/wiki/CSS/Properties/color/keywords#Basic_Colors\n-    private const PATTERN_BASIC_NAMED_COLORS = '/^(black|silver|gray|white|maroon|red|purple|fuchsia|green|lime|olive|yellow|navy|blue|teal|aqua)$/i';\n+    private const PATTERN_BASIC_NAMED_COLORS = '/^(black|silver|gray|white|maroon|red|purple|fuchsia|green|lime|olive|yellow|navy|blue|teal|aqua)$/iD';\n     // List comes from https://www.w3.org/wiki/CSS/Properties/color/keywords#Extended_colors\n-    private const PATTERN_EXTENDED_NAMED_COLORS = '/^(aliceblue|antiquewhite|aqua|aquamarine|azure|beige|bisque|black|blanchedalmond|blue|blueviolet|brown|burlywood|cadetblue|chartreuse|chocolate|coral|cornflowerblue|cornsilk|crimson|cyan|darkblue|darkcyan|darkgoldenrod|darkgray|darkgreen|darkgrey|darkkhaki|darkmagenta|darkolivegreen|darkorange|darkorchid|darkred|darksalmon|darkseagreen|darkslateblue|darkslategray|darkslategrey|darkturquoise|darkviolet|deeppink|deepskyblue|dimgray|dimgrey|dodgerblue|firebrick|floralwhite|forestgreen|fuchsia|gainsboro|ghostwhite|gold|goldenrod|gray|green|greenyellow|grey|honeydew|hotpink|indianred|indigo|ivory|khaki|lavender|lavenderblush|lawngreen|lemonchiffon|lightblue|lightcoral|lightcyan|lightgoldenrodyellow|lightgray|lightgreen|lightgrey|lightpink|lightsalmon|lightseagreen|lightskyblue|lightslategray|lightslategrey|lightsteelblue|lightyellow|lime|limegreen|linen|magenta|maroon|mediumaquamarine|mediumblue|mediumorchid|mediumpurple|mediumseagreen|mediumslateblue|mediumspringgreen|mediumturquoise|mediumvioletred|midnightblue|mintcream|mistyrose|moccasin|navajowhite|navy|oldlace|olive|olivedrab|orange|orangered|orchid|palegoldenrod|palegreen|paleturquoise|palevioletred|papayawhip|peachpuff|peru|pink|plum|powderblue|purple|red|rosybrown|royalblue|saddlebrown|salmon|sandybrown|seagreen|seashell|sienna|silver|skyblue|slateblue|slategray|slategrey|snow|springgreen|steelblue|tan|teal|thistle|tomato|turquoise|violet|wheat|white|whitesmoke|yellow|yellowgreen)$/i';\n+    private const PATTERN_EXTENDED_NAMED_COLORS = '/^(aliceblue|antiquewhite|aqua|aquamarine|azure|beige|bisque|black|blanchedalmond|blue|blueviolet|brown|burlywood|cadetblue|chartreuse|chocolate|coral|cornflowerblue|cornsilk|crimson|cyan|darkblue|darkcyan|darkgoldenrod|darkgray|darkgreen|darkgrey|darkkhaki|darkmagenta|darkolivegreen|darkorange|darkorchid|darkred|darksalmon|darkseagreen|darkslateblue|darkslategray|darkslategrey|darkturquoise|darkviolet|deeppink|deepskyblue|dimgray|dimgrey|dodgerblue|firebrick|floralwhite|forestgreen|fuchsia|gainsboro|ghostwhite|gold|goldenrod|gray|green|greenyellow|grey|honeydew|hotpink|indianred|indigo|ivory|khaki|lavender|lavenderblush|lawngreen|lemonchiffon|lightblue|lightcoral|lightcyan|lightgoldenrodyellow|lightgray|lightgreen|lightgrey|lightpink|lightsalmon|lightseagreen|lightskyblue|lightslategray|lightslategrey|lightsteelblue|lightyellow|lime|limegreen|linen|magenta|maroon|mediumaquamarine|mediumblue|mediumorchid|mediumpurple|mediumseagreen|mediumslateblue|mediumspringgreen|mediumturquoise|mediumvioletred|midnightblue|mintcream|mistyrose|moccasin|navajowhite|navy|oldlace|olive|olivedrab|orange|orangered|orchid|palegoldenrod|palegreen|paleturquoise|palevioletred|papayawhip|peachpuff|peru|pink|plum|powderblue|purple|red|rosybrown|royalblue|saddlebrown|salmon|sandybrown|seagreen|seashell|sienna|silver|skyblue|slateblue|slategray|slategrey|snow|springgreen|steelblue|tan|teal|thistle|tomato|turquoise|violet|wheat|white|whitesmoke|yellow|yellowgreen)$/iD';\n     // List comes from https://drafts.csswg.org/css-color/#css-system-colors\n-    private const PATTERN_SYSTEM_COLORS = '/^(Canvas|CanvasText|LinkText|VisitedText|ActiveText|ButtonFace|ButtonText|ButtonBorder|Field|FieldText|Highlight|HighlightText|SelectedItem|SelectedItemText|Mark|MarkText|GrayText)$/i';\n-    private const PATTERN_KEYWORDS = '/^(transparent|currentColor)$/i';\n-    private const PATTERN_RGB = '/^rgb\\(\\s*(0|255|25[0-4]|2[0-4]\\d|1\\d\\d|0?\\d?\\d),\\s*(0|255|25[0-4]|2[0-4]\\d|1\\d\\d|0?\\d?\\d),\\s*(0|255|25[0-4]|2[0-4]\\d|1\\d\\d|0?\\d?\\d)\\s*\\)$/i';\n-    private const PATTERN_RGBA = '/^rgba\\(\\s*(0|255|25[0-4]|2[0-4]\\d|1\\d\\d|0?\\d?\\d),\\s*(0|255|25[0-4]|2[0-4]\\d|1\\d\\d|0?\\d?\\d),\\s*(0|255|25[0-4]|2[0-4]\\d|1\\d\\d|0?\\d?\\d),\\s*(0|0?\\.\\d+|1(\\.0)?)\\s*\\)$/i';\n-    private const PATTERN_HSL = '/^hsl\\(\\s*(0|360|35\\d|3[0-4]\\d|[12]\\d\\d|0?\\d?\\d),\\s*(0|100|\\d{1,2})%,\\s*(0|100|\\d{1,2})%\\s*\\)$/i';\n-    private const PATTERN_HSLA = '/^hsla\\(\\s*(0|360|35\\d|3[0-4]\\d|[12]\\d\\d|0?\\d?\\d),\\s*(0|100|\\d{1,2})%,\\s*(0|100|\\d{1,2})%,\\s*(0|0?\\.\\d+|1(\\.0)?)\\s*\\)$/i';\n+    private const PATTERN_SYSTEM_COLORS = '/^(Canvas|CanvasText|LinkText|VisitedText|ActiveText|ButtonFace|ButtonText|ButtonBorder|Field|FieldText|Highlight|HighlightText|SelectedItem|SelectedItemText|Mark|MarkText|GrayText)$/iD';\n+    private const PATTERN_KEYWORDS = '/^(transparent|currentColor)$/iD';\n+    private const PATTERN_RGB = '/^rgb\\(\\s*(0|255|25[0-4]|2[0-4]\\d|1\\d\\d|0?\\d?\\d),\\s*(0|255|25[0-4]|2[0-4]\\d|1\\d\\d|0?\\d?\\d),\\s*(0|255|25[0-4]|2[0-4]\\d|1\\d\\d|0?\\d?\\d)\\s*\\)$/iD';\n+    private const PATTERN_RGBA = '/^rgba\\(\\s*(0|255|25[0-4]|2[0-4]\\d|1\\d\\d|0?\\d?\\d),\\s*(0|255|25[0-4]|2[0-4]\\d|1\\d\\d|0?\\d?\\d),\\s*(0|255|25[0-4]|2[0-4]\\d|1\\d\\d|0?\\d?\\d),\\s*(0|0?\\.\\d+|1(\\.0)?)\\s*\\)$/iD';\n+    private const PATTERN_HSL = '/^hsl\\(\\s*(0|360|35\\d|3[0-4]\\d|[12]\\d\\d|0?\\d?\\d),\\s*(0|100|\\d{1,2})%,\\s*(0|100|\\d{1,2})%\\s*\\)$/iD';\n+    private const PATTERN_HSLA = '/^hsla\\(\\s*(0|360|35\\d|3[0-4]\\d|[12]\\d\\d|0?\\d?\\d),\\s*(0|100|\\d{1,2})%,\\s*(0|100|\\d{1,2})%,\\s*(0|0?\\.\\d+|1(\\.0)?)\\s*\\)$/iD';\n \n     private const COLOR_PATTERNS = [\n         CssColor::HEX_LONG => self::PATTERN_HEX_LONG,\n```\n\nFilename: src/Symfony/Component/Validator/Constraints/DateValidator.php:\n```\n@@ -21,7 +21,7 @@\n*/\n class DateValidator extends ConstraintValidator\n {\n-    public const PATTERN = '/^(?<year>\\d{4})-(?<month>\\d{2})-(?<day>\\d{2})$/';\n+    public const PATTERN = '/^(?<year>\\d{4})-(?<month>\\d{2})-(?<day>\\d{2})$/D';\n \n     /**\n      * Checks whether a date is valid.\n```\n\nFilename: src/Symfony/Component/Validator/Constraints/EmailValidator.php:\n```\n@@ -25,8 +25,8 @@\n*/\n class EmailValidator extends ConstraintValidator\n {\n-    private const PATTERN_HTML5 = '/^[a-zA-Z0-9.!#$%&\\'*+\\\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+$/';\n-    private const PATTERN_LOOSE = '/^.+\\@\\S+\\.\\S+$/';\n+    private const PATTERN_HTML5 = '/^[a-zA-Z0-9.!#$%&\\'*+\\\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+$/D';\n+    private const PATTERN_LOOSE = '/^.+\\@\\S+\\.\\S+$/D';\n \n     private const EMAIL_PATTERNS = [\n         Email::VALIDATION_MODE_LOOSE => self::PATTERN_LOOSE,\n```\n\nFilename: src/Symfony/Component/Validator/Constraints/TimeValidator.php:\n```\n@@ -21,7 +21,7 @@\n*/\n class TimeValidator extends ConstraintValidator\n {\n-    public const PATTERN = '/^(\\d{2}):(\\d{2}):(\\d{2})$/';\n+    public const PATTERN = '/^(\\d{2}):(\\d{2}):(\\d{2})$/D';\n \n     /**\n      * Checks whether a time is valid.\n```\n\nFilename: src/Symfony/Component/Validator/Constraints/UrlValidator.php:\n```\n@@ -43,7 +43,7 @@\nclass UrlValidator extends ConstraintValidator\n             (?:/ (?:[\\pL\\pN\\pS\\pM\\-._\\~!$&\\'()*+,;=:@]|%%[0-9A-Fa-f]{2})* )*    # a path\n             (?:\\? (?:[\\pL\\pN\\-._\\~!$&\\'\\[\\]()*+,;=:@/?]|%%[0-9A-Fa-f]{2})* )?   # a query (optional)\n             (?:\\# (?:[\\pL\\pN\\-._\\~!$&\\'()*+,;=:@/?]|%%[0-9A-Fa-f]{2})* )?       # a fragment (optional)\n-        $~ixu';\n+        $~ixuD';\n \n     /**\n      * {@inheritdoc}\n```\n\nFilename: src/Symfony/Component/Validator/Tests/Constraints/CardSchemeValidatorTest.php:\n```\n@@ -46,6 +46,36 @@\npublic function testValidNumbers($scheme, $number)\n         $this->assertNoViolation();\n     }\n \n+    /**\n+     * @requires PHP 8\n+     *\n+     * @dataProvider getValidNumbers\n+     */\n+    public function testValidNumbersWithNewLine($scheme, $number)\n+    {\n+        $this->validator->validate($number.\"\\n\", new CardScheme(['schemes' => $scheme, 'message' => 'myMessage']));\n+\n+        $this->buildViolation('myMessage')\n+            ->setParameter('{{ value }}', '\"'.$number.\"\\n\\\"\")\n+            ->setCode(CardScheme::INVALID_FORMAT_ERROR)\n+            ->assertRaised();\n+    }\n+\n+    /**\n+     * @requires PHP < 8\n+     *\n+     * @dataProvider getValidNumbers\n+     */\n+    public function testValidNumbersWithNewLinePriorToPhp8($scheme, $number)\n+    {\n+        $this->validator->validate($number.\"\\n\", new CardScheme(['schemes' => $scheme, 'message' => 'myMessage']));\n+\n+        $this->buildViolation('myMessage')\n+            ->setParameter('{{ value }}', '\"'.$number.\"\\n\\\"\")\n+            ->setCode(CardScheme::NOT_NUMERIC_ERROR)\n+            ->assertRaised();\n+    }\n+\n     public function testValidNumberWithOrderedArguments()\n     {\n         $this->validator->validate(\n```\n\nFilename: src/Symfony/Component/Validator/Tests/Constraints/CssColorValidatorTest.php:\n```\n@@ -52,6 +52,19 @@\npublic function testValidAnyColor($cssColor)\n         $this->assertNoViolation();\n     }\n \n+    /**\n+     * @dataProvider getValidAnyColor\n+     */\n+    public function testValidAnyColorWithNewLine($cssColor)\n+    {\n+        $this->validator->validate($cssColor.\"\\n\", new CssColor([], 'myMessage'));\n+\n+        $this->buildViolation('myMessage')\n+            ->setParameter('{{ value }}', '\"'.$cssColor.\"\\n\\\"\")\n+            ->setCode(CssColor::INVALID_FORMAT_ERROR)\n+            ->assertRaised();\n+    }\n+\n     public static function getValidAnyColor(): array\n     {\n         return [\n```\n\nFilename: src/Symfony/Component/Validator/Tests/Constraints/DateValidatorTest.php:\n```\n@@ -53,6 +53,19 @@\npublic function testValidDates($date)\n         $this->assertNoViolation();\n     }\n \n+    /**\n+     * @dataProvider getValidDates\n+     */\n+    public function testValidDatesWithNewLine(string $date)\n+    {\n+        $this->validator->validate($date.\"\\n\", new Date(['message' => 'myMessage']));\n+\n+        $this->buildViolation('myMessage')\n+            ->setParameter('{{ value }}', '\"'.$date.\"\\n\\\"\")\n+            ->setCode(Date::INVALID_FORMAT_ERROR)\n+            ->assertRaised();\n+    }\n+\n     public static function getValidDates()\n     {\n         return [\n```\n\nFilename: src/Symfony/Component/Validator/Tests/Constraints/EmailValidatorTest.php:\n```\n@@ -70,6 +70,19 @@\npublic function testValidEmails($email)\n         $this->assertNoViolation();\n     }\n \n+    /**\n+     * @dataProvider getValidEmails\n+     */\n+    public function testValidEmailsWithNewLine($email)\n+    {\n+        $this->validator->validate($email.\"\\n\", new Email());\n+\n+        $this->buildViolation('This value is not a valid email address.')\n+            ->setParameter('{{ value }}', '\"'.$email.\"\\n\\\"\")\n+            ->setCode(Email::INVALID_FORMAT_ERROR)\n+            ->assertRaised();\n+    }\n+\n     public static function getValidEmails()\n     {\n         return [\n```\n\nFilename: src/Symfony/Component/Validator/Tests/Constraints/IbanValidatorTest.php:\n```\n@@ -48,6 +48,19 @@\npublic function testValidIbans($iban)\n         $this->assertNoViolation();\n     }\n \n+    /**\n+     * @dataProvider getValidIbans\n+     */\n+    public function testValidIbansWithNewLine(string $iban)\n+    {\n+        $this->validator->validate($iban.\"\\n\", new Iban());\n+\n+        $this->buildViolation('This is not a valid International Bank Account Number (IBAN).')\n+            ->setParameter('{{ value }}', '\"'.$iban.\"\\n\\\"\")\n+            ->setCode(Iban::INVALID_CHARACTERS_ERROR)\n+            ->assertRaised();\n+    }\n+\n     public static function getValidIbans()\n     {\n         return [\n```\n\nFilename: src/Symfony/Component/Validator/Tests/Constraints/TimeValidatorTest.php:\n```\n@@ -53,6 +53,19 @@\npublic function testValidTimes($time)\n         $this->assertNoViolation();\n     }\n \n+    /**\n+     * @dataProvider getValidTimes\n+     */\n+    public function testValidTimesWithNewLine(string $time)\n+    {\n+        $this->validator->validate($time.\"\\n\", new Time());\n+\n+        $this->buildViolation('This value is not a valid time.')\n+            ->setParameter('{{ value }}', '\"'.$time.\"\\n\".'\"')\n+            ->setCode(Time::INVALID_FORMAT_ERROR)\n+            ->assertRaised();\n+    }\n+\n     public static function getValidTimes()\n     {\n         return [\n```\n\nFilename: src/Symfony/Component/Validator/Tests/Constraints/UrlValidatorTest.php:\n```\n@@ -60,6 +60,19 @@\npublic function testValidUrls($url)\n         $this->assertNoViolation();\n     }\n \n+    /**\n+     * @dataProvider getValidUrls\n+     */\n+    public function testValidUrlsWithNewLine($url)\n+    {\n+        $this->validator->validate($url.\"\\n\", new Url());\n+\n+        $this->buildViolation('This value is not a valid URL.')\n+            ->setParameter('{{ value }}', '\"'.$url.\"\\n\".'\"')\n+            ->setCode(Url::INVALID_URL_ERROR)\n+            ->assertRaised();\n+    }\n+\n     /**\n      * @dataProvider getValidUrlsWithWhitespaces\n      */\n\n@@ -85,6 +98,24 @@\npublic function testValidRelativeUrl($url)\n         $this->assertNoViolation();\n     }\n \n+    /**\n+     * @dataProvider getValidRelativeUrls\n+     * @dataProvider getValidUrls\n+     */\n+    public function testValidRelativeUrlWithNewLine(string $url)\n+    {\n+        $constraint = new Url([\n+            'relativeProtocol' => true,\n+        ]);\n+\n+        $this->validator->validate($url.\"\\n\", $constraint);\n+\n+        $this->buildViolation('This value is not a valid URL.')\n+            ->setParameter('{{ value }}', '\"'.$url.\"\\n\".'\"')\n+            ->setCode(Url::INVALID_URL_ERROR)\n+            ->assertRaised();\n+    }\n+\n     public static function getValidRelativeUrls()\n     {\n         return [\n```"
            }
        ],
        "sw_version": "v5.4.42",
        "sw_version_wget": "https://github.com/symfony/symfony/archive/refs/tags/v5.4.42.zip",
        "description": "symfony/validator is a module for the Symphony PHP framework which provides tools to validate values. It is possible to trick a `Validator` configured with a regular expression using the `$` metacharacters, with an input ending with `\\n`. Symfony as of versions 5.4.43, 6.4.11, and 7.1.4 now uses the `D` regex modifier to match the entire input. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
        "sec_adv": [
            {
                "url": "https://github.com/symfony/symfony/security/advisories/GHSA-g3rh-rrhp-jhh9",
                "content": "Skip to content\nNavigation Menu\nProduct\nSolutions\nResources\nOpen Source\nEnterprise\nPricing\nSearch or jump to...\nSign in\nSign up\nAppearance settings\nDismiss alert\nsymfony\n/\nsymfony\nPublic\nSponsor\nNotifications You must be signed in to change notification settings\nFork 9.6k\nStar 30.3k\nCode\nIssues\n531\nPull requests\n292\nDiscussions\nActions\nProjects\nSecurity\n24\nInsights\nAdditional navigation options\nIncorrect response from Validator when input ends with `\\n`\nLow nicolas-grekas published GHSA-g3rh-rrhp-jhh9 on Nov 6, 2024Nov 6, 2024\nPackage\ncomposer symfony/validator\n(\nComposer\n)\nAffected versions\n<5.4.43\n>6, <6.4.11\n>7, <7.1.4\nPatched versions\n5.4.43\n6.4.11\n7.1.4\nDescription\nDescription\nIt is possible to trick a Validator configured with a regular expression using the $ metacharacters, with an input ending with \\n.\nResolution\nSymfony now uses the D regex modifier to match the entire input.\nThe patch for this issue is available here for branch 5.4.\nCredits\nWe would like to thank Offscript for reporting the issue and Alexandre Daubois for providing the fix.\nSeverity\nLow\n3.1\n/ 10\nCVSS v3 base metrics\nAttack vector\nNetwork\nAttack complexity\nHigh\nPrivileges required\nLow\nUser interaction\nNone\nScope\nUnchanged\nConfidentiality\nLow\nIntegrity\nNone\nAvailability\nNone\nLearn more about base metrics\nCVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N\nCVE ID\nCVE-2024-50343\nWeaknesses\nNo CWEs\nCredits\noffscriptian\nReporter\nalexandre-daubois\nRemediation developer\nFooter\nÂ© 2025 GitHub, Inc.\nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\nManage cookies\nDo not share my personal information",
                "effective": false,
                "effective_reason": "The advisory provides information about the vulnerability, its impact, and the patches, but it does not include a proof of concept or detailed steps to reproduce the issue."
            }
        ],
        "cwe": [
            {
                "id": "CWE-20",
                "value": "CWE-20: Improper Input Validation"
            }
        ]
    }
}