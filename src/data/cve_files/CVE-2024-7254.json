{
    "CVE-2024-7254": {
        "published_date": "2024-09-19T00:18:45.824Z",
        "patch_commits": [
            {
                "url": "https://github.com/protocolbuffers/protobuf/commit/cc8b3483a5584b3301e3d43d17eb59704857ffaa",
                "content": "Internal change\n\nPiperOrigin-RevId: 653615736\n\nFilename: java/core/src/main/java/com/google/protobuf/ArrayDecoders.java:\n```\n@@ -24,8 +24,7 @@\n@CheckReturnValue\n final class ArrayDecoders {\n \n-  private ArrayDecoders() {\n-  }\n+  private ArrayDecoders() {}\n \n   /**\n    * A helper used to return multiple values in a Java function. Java doesn't natively support\n```\n\nFilename: java/core/src/main/java/com/google/protobuf/InvalidProtocolBufferException.java:\n```\n@@ -132,7 +132,7 @@\npublic InvalidWireTypeException(String description) {\n   static InvalidProtocolBufferException recursionLimitExceeded() {\n     return new InvalidProtocolBufferException(\n         \"Protocol message had too many levels of nesting.  May be malicious.  \"\n-            + \"Use CodedInputStream.setRecursionLimit() to increase the depth limit.\");\n+            + \"Use setRecursionLimit() to increase the recursion depth limit.\");\n   }\n \n   static InvalidProtocolBufferException sizeLimitExceeded() {\n```\n\nFilename: java/core/src/main/java/com/google/protobuf/MessageSchema.java:\n```\n@@ -3006,6 +3006,7 @@\nprivate <UT, UB, ET extends FieldDescriptorLite<ET>> void mergeFromHelper(\n               unknownFields = unknownFieldSchema.getBuilderFromMessage(message);\n             }\n             // Unknown field.\n+\n             if (unknownFieldSchema.mergeOneFieldFrom(unknownFields, reader)) {\n               continue;\n             }\n\n@@ -3381,6 +3382,7 @@\nprivate <UT, UB, ET extends FieldDescriptorLite<ET>> void mergeFromHelper(\n               if (unknownFields == null) {\n                 unknownFields = unknownFieldSchema.getBuilderFromMessage(message);\n               }\n+\n               if (!unknownFieldSchema.mergeOneFieldFrom(unknownFields, reader)) {\n                 return;\n               }\n\n@@ -3397,6 +3399,7 @@\nprivate <UT, UB, ET extends FieldDescriptorLite<ET>> void mergeFromHelper(\n             if (unknownFields == null) {\n               unknownFields = unknownFieldSchema.getBuilderFromMessage(message);\n             }\n+\n             if (!unknownFieldSchema.mergeOneFieldFrom(unknownFields, reader)) {\n               return;\n             }\n```\n\nFilename: java/core/src/main/java/com/google/protobuf/MessageSetSchema.java:\n```\n@@ -278,6 +278,7 @@\nboolean parseMessageSetItemOrUnknownField(\n               reader, extension, extensionRegistry, extensions);\n           return true;\n         } else {\n+\n           return unknownFieldSchema.mergeOneFieldFrom(unknownFields, reader);\n         }\n       } else {\n```\n\nFilename: java/core/src/main/java/com/google/protobuf/UnknownFieldSchema.java:\n```\n@@ -55,7 +55,6 @@\nabstract class UnknownFieldSchema<T, B> {\n   /** Marks unknown fields as immutable. */\n   abstract void makeImmutable(Object message);\n \n-  /** Merges one field into the unknown fields. */\n   final boolean mergeOneFieldFrom(B unknownFields, Reader reader) throws IOException {\n     int tag = reader.getTag();\n     int fieldNumber = WireFormat.getTagFieldNumber(tag);\n\n@@ -88,7 +87,7 @@\nfinal boolean mergeOneFieldFrom(B unknownFields, Reader reader) throws IOExcepti\n     }\n   }\n \n-  final void mergeFrom(B unknownFields, Reader reader) throws IOException {\n+  private final void mergeFrom(B unknownFields, Reader reader) throws IOException {\n     while (true) {\n       if (reader.getFieldNumber() == Reader.READ_DONE\n           || !mergeOneFieldFrom(unknownFields, reader)) {\n```\n\nFilename: java/lite/src/test/java/com/google/protobuf/LiteTest.java:\n```\n@@ -10,12 +10,14 @@\nimport static com.google.common.truth.Truth.assertThat;\n import static com.google.common.truth.Truth.assertWithMessage;\n import static java.util.Collections.singletonList;\n+import static org.junit.Assert.assertThrows;\n \n import com.google.protobuf.FieldPresenceTestProto.TestAllTypes;\n import com.google.protobuf.UnittestImportLite.ImportEnumLite;\n import com.google.protobuf.UnittestImportPublicLite.PublicImportMessageLite;\n import com.google.protobuf.UnittestLite.ForeignEnumLite;\n import com.google.protobuf.UnittestLite.ForeignMessageLite;\n+import com.google.protobuf.UnittestLite.RecursiveGroup;\n import com.google.protobuf.UnittestLite.RecursiveMessage;\n import com.google.protobuf.UnittestLite.TestAllExtensionsLite;\n import com.google.protobuf.UnittestLite.TestAllTypesLite;\n\n@@ -50,6 +52,7 @@\nimport java.util.Arrays;\n import java.util.Iterator;\n import java.util.List;\n+import java.util.concurrent.atomic.AtomicBoolean;\n import org.junit.Before;\n import org.junit.Test;\n import org.junit.runner.RunWith;\n```\n\nFilename: src/google/protobuf/unittest_lite.proto:\n```\n@@ -625,3 +625,7 @@\nmessage RecursiveMessage {\n   RecursiveMessage recurse = 1;\n   bytes payload = 2;\n }\n+\n+message RecursiveGroup {\n+  RecursiveGroup recurse = 1 [features.message_encoding = DELIMITED];\n+}\n```"
            }
        ],
        "sw_version": "v28.1",
        "sw_version_wget": "https://github.com/protocolbuffers/protobuf/archive/refs/tags/v28.1.zip",
        "description": "Any project that parses untrusted Protocol Buffers data containing an arbitrary number of nested groups / series of SGROUP tags can corrupted by exceeding the stack limit i.e. StackOverflow. Parsing nested groups as unknown fields with DiscardUnknownFieldsParser or Java Protobuf Lite parser, or against Protobuf map fields, creates unbounded recursions that can be abused by an attacker.",
        "sec_adv": [],
        "cwe": [
            {
                "id": "CWE-20",
                "value": "CWE-20 Improper Input Validation"
            }
        ]
    }
}