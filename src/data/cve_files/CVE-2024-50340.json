{
    "CVE-2024-50340": {
        "published_date": "2024-11-06T21:09:46.750Z",
        "patch_commits": [
            {
                "url": "https://github.com/symfony/symfony/commit/a77b308c3f179ed7c8a8bc295f82b2d6ee3493fa",
                "content": "Do not read from argv on non-CLI SAPIs\n\nFilename: src/Symfony/Component/Runtime/SymfonyRuntime.php:\n```\n@@ -95,7 +95,7 @@\npublic function __construct(array $options = [])\n \n         if (isset($options['env'])) {\n             $_SERVER[$envKey] = $options['env'];\n-        } elseif (isset($_SERVER['argv']) && class_exists(ArgvInput::class)) {\n+        } elseif (empty($_GET) && isset($_SERVER['argv']) && class_exists(ArgvInput::class)) {\n             $this->options = $options;\n             $this->getInput();\n         }\n\n@@ -216,6 +216,10 @@\nprotected static function register(GenericRuntime $runtime): GenericRuntime\n \n     private function getInput(): ArgvInput\n     {\n+        if (!empty($_GET) && filter_var(ini_get('register_argc_argv'), \\FILTER_VALIDATE_BOOL)) {\n+            throw new \\Exception('CLI applications cannot be run safely on non-CLI SAPIs with register_argc_argv=On.');\n+        }\n+\n         if (null !== $this->input) {\n             return $this->input;\n         }\n```\n\nFilename: src/Symfony/Component/Runtime/Tests/phpt/kernel.php:\n```\n@@ -17,19 +17,21 @@\nclass TestKernel implements HttpKernelInterface\n {\n+    private $env;\n     private $var;\n \n-    public function __construct(string $var)\n+    public function __construct(string $env, string $var)\n     {\n+        $this->env = $env;\n         $this->var = $var;\n     }\n \n     public function handle(Request $request, $type = self::MASTER_REQUEST, $catch = true): Response\n     {\n-        return new Response('OK Kernel '.$this->var);\n+        return new Response('OK Kernel (env='.$this->env.') '.$this->var);\n     }\n }\n \n return function (array $context) {\n-    return new TestKernel($context['SOME_VAR']);\n+    return new TestKernel($context['APP_ENV'], $context['SOME_VAR']);\n };\n```\n\nFilename: src/Symfony/Component/Runtime/Tests/phpt/kernel.phpt:\n```\n@@ -9,4 +9,4 @@\nrequire $_SERVER['SCRIPT_FILENAME'] = __DIR__.'/kernel.php';\n \n ?>\n --EXPECTF--\n-OK Kernel foo_bar\n+OK Kernel (env=dev) foo_bar\n```\n\nFilename: src/Symfony/Component/Runtime/Tests/phpt/kernel_register_argc_argv.phpt:\n```\n@@ -0,0 +1,18 @@\n+--TEST--\n+Test HttpKernelInterface with register_argc_argv=1\n+--INI--\n+display_errors=1\n+register_argc_argv=1\n+--FILE--\n+<?php\n+\n+// emulating PHP behavior with register_argc_argv=1\n+$_GET['-e_test'] = '';\n+$_SERVER['argc'] = 1;\n+$_SERVER['argv'] = [' ', '-e', 'test'];\n+\n+require $_SERVER['SCRIPT_FILENAME'] = __DIR__.'/kernel.php';\n+\n+?>\n+--EXPECTF--\n+OK Kernel (env=dev) foo_bar\n```"
            }
        ],
        "sw_version": "v5.4.45",
        "sw_version_wget": "https://github.com/symfony/symfony/archive/refs/tags/v5.4.45.zip",
        "description": "symfony/runtime is a module for the Symphony PHP framework which enables decoupling PHP applications from global state. When the `register_argv_argc` php directive is set to `on` , and users call any URL with a special crafted query string, they are able to change the environment or debug mode used by the kernel when handling the request. As of versions 5.4.46, 6.4.14, and 7.1.7 the `SymfonyRuntime` now ignores the `argv` values for non-SAPI PHP runtimes. All users are advised to upgrade. There are no known workarounds for this vulnerability.",
        "sec_adv": [
            {
                "url": "https://github.com/symfony/symfony/security/advisories/GHSA-x8vp-gf4q-mw5j",
                "content": "Skip to content\nNavigation Menu\nProduct\nSolutions\nResources\nOpen Source\nEnterprise\nPricing\nSearch or jump to...\nSign in\nSign up\nAppearance settings\nDismiss alert\nsymfony\n/\nsymfony\nPublic\nSponsor\nNotifications You must be signed in to change notification settings\nFork 9.6k\nStar 30.3k\nCode\nIssues\n531\nPull requests\n292\nDiscussions\nActions\nProjects\nSecurity\n24\nInsights\nAdditional navigation options\nAbility to change environment from query\nHigh fabpot published GHSA-x8vp-gf4q-mw5j on Nov 6, 2024Nov 6, 2024\nPackage\ncomposer symfony/runtime\n(\nComposer\n)\nAffected versions\n<5.4.46\n>=6, <6.4.14\n>=7, <7.1.7\nPatched versions\n5.4.46\n6.4.14\n7.1.7\nDescription\nDescription\nWhen the register_argc_argv php directive is set to on , and users call any URL with a special crafted query string, they are able to change the environment or debug mode used by the kernel when handling the request.\nResolution\nThe SymfonyRuntime now ignores the argv values for non-cli SAPIs PHP runtimes\nThe patch for this issue is available here for branch 5.4.\nCredits\nWe would like to thank Vladimir Dusheyko for reporting the issue and Wouter de Jong for providing the fix.\nSeverity\nHigh\n7.3\n/ 10\nCVSS v3 base metrics\nAttack vector\nNetwork\nAttack complexity\nLow\nPrivileges required\nNone\nUser interaction\nNone\nScope\nUnchanged\nConfidentiality\nLow\nIntegrity\nLow\nAvailability\nLow\nLearn more about base metrics\nCVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L\nCVE ID\nCVE-2024-50340\nWeaknesses\nNo CWEs\nCredits\nwouterj\nRemediation developer\nFooter\nÂ© 2025 GitHub, Inc.\nFooter navigation\nTerms\nPrivacy\nSecurity\nStatus\nDocs\nContact\nManage cookies\nDo not share my personal information",
                "effective": false,
                "effective_reason": "The advisory lacks explicit proof of concept or step-by-step detail on exploiting the vulnerability; it only describes the general method and resolution."
            }
        ],
        "cwe": [
            {
                "id": "CWE-74",
                "value": "CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')"
            }
        ]
    }
}