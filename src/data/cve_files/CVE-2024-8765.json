{
    "CVE-2024-8765": {
        "published_date": "2025-03-20T10:10:37.352Z",
        "patch_commits": [
            {
                "url": "https://github.com/lunary-ai/lunary/commit/7ff89b0304d191534b924cf063f3648206d497fa",
                "content": "fix: redos (#557)\n\nFilename: package-lock.json:\n```\n@@ -1356,7 +1356,6 @@\n\"version\": \"8.0.2\",\n       \"resolved\": \"https://registry.npmjs.org/@isaacs/cliui/-/cliui-8.0.2.tgz\",\n       \"integrity\": \"sha512-O8jcjabXaleOG9DQ0+ARXWZBTfnP4WNAqzuiJK7ll44AmxGKv/J2M4TPjxjY3znBCfvBXFzucm1twdyFybFqEA==\",\n-      \"dev\": true,\n       \"license\": \"ISC\",\n       \"dependencies\": {\n         \"string-width\": \"^5.1.2\",\n\n@@ -1374,7 +1373,6 @@\n\"version\": \"6.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/ansi-regex/-/ansi-regex-6.0.1.tgz\",\n       \"integrity\": \"sha512-n5M855fKb2SsfMIiFFoVrABHJC8QtHwVx+mHWP3QcEqBHYienj5dHSgjbxtC0WEZXYt4wcD6zrQElDPhFuZgfA==\",\n-      \"dev\": true,\n       \"license\": \"MIT\",\n       \"engines\": {\n         \"node\": \">=12\"\n\n@@ -1387,7 +1385,6 @@\n\"version\": \"6.2.1\",\n       \"resolved\": \"https://registry.npmjs.org/ansi-styles/-/ansi-styles-6.2.1.tgz\",\n       \"integrity\": \"sha512-bN798gFfQX+viw3R7yrGWRqnrN2oRkEkUjjl4JNn4E8GxxbjtG3FbrEIIY3l8/hrwUwIeCZvi4QuOTP4MErVug==\",\n-      \"dev\": true,\n       \"license\": \"MIT\",\n       \"engines\": {\n         \"node\": \">=12\"\n\n@@ -1400,14 +1397,12 @@\n\"version\": \"9.2.2\",\n       \"resolved\": \"https://registry.npmjs.org/emoji-regex/-/emoji-regex-9.2.2.tgz\",\n       \"integrity\": \"sha512-L18DaJsXSUk2+42pv8mLs5jJT2hqFkFE4j21wOmgbUqsZ2hL72NsUU785g9RXgo3s0ZNgVl42TiHp3ZtOv/Vyg==\",\n-      \"dev\": true,\n       \"license\": \"MIT\"\n     },\n     \"node_modules/@isaacs/cliui/node_modules/string-width\": {\n       \"version\": \"5.1.2\",\n       \"resolved\": \"https://registry.npmjs.org/string-width/-/string-width-5.1.2.tgz\",\n       \"integrity\": \"sha512-HnLOCR3vjcY8beoNLtcjZ5/nxn2afmME6lhrDrebokqMap+XbeW8n9TXpPDOqdGK5qcI3oT0GKTW6wC7EMiVqA==\",\n-      \"dev\": true,\n       \"license\": \"MIT\",\n       \"dependencies\": {\n         \"eastasianwidth\": \"^0.2.0\",\n\n@@ -1425,7 +1420,6 @@\n\"version\": \"7.1.0\",\n       \"resolved\": \"https://registry.npmjs.org/strip-ansi/-/strip-ansi-7.1.0.tgz\",\n       \"integrity\": \"sha512-iq6eVVI64nQQTRYq2KtEg2d2uU7LElhTJwsH4YzIHZshxlgZms/wIc4VoDQTlG/IvVIrBKG06CrZnp0qv7hkcQ==\",\n-      \"dev\": true,\n       \"license\": \"MIT\",\n       \"dependencies\": {\n         \"ansi-regex\": \"^6.0.1\"\n\n@@ -1441,7 +1435,6 @@\n\"version\": \"8.1.0\",\n       \"resolved\": \"https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-8.1.0.tgz\",\n       \"integrity\": \"sha512-si7QWI6zUMq56bESFvagtmzMdGOtoxfR+Sez11Mobfc7tm+VkUckk9bW2UeffTGVUbOksxmSw0AA2gs8g71NCQ==\",\n-      \"dev\": true,\n       \"license\": \"MIT\",\n       \"dependencies\": {\n         \"ansi-styles\": \"^6.1.0\",\n\n@@ -1884,6 +1877,72 @@\n\"node\": \">= 8\"\n       }\n     },\n+    \"node_modules/@npmcli/agent\": {\n+      \"version\": \"2.2.2\",\n+      \"resolved\": \"https://registry.npmjs.org/@npmcli/agent/-/agent-2.2.2.tgz\",\n+      \"integrity\": \"sha512-OrcNPXdpSl9UX7qPVRWbmWMCSXrcDa2M9DvrbOTj7ao1S4PlqVFYv9/yLKMkrJKZ/V5A/kDBC690or307i26Og==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"agent-base\": \"^7.1.0\",\n+        \"http-proxy-agent\": \"^7.0.0\",\n+        \"https-proxy-agent\": \"^7.0.1\",\n+        \"lru-cache\": \"^10.0.1\",\n+        \"socks-proxy-agent\": \"^8.0.3\"\n+      },\n+      \"engines\": {\n+        \"node\": \"^16.14.0 || >=18.0.0\"\n+      }\n+    },\n+    \"node_modules/@npmcli/agent/node_modules/agent-base\": {\n+      \"version\": \"7.1.1\",\n+      \"resolved\": \"https://registry.npmjs.org/agent-base/-/agent-base-7.1.1.tgz\",\n+      \"integrity\": \"sha512-H0TSyFNDMomMNJQBn8wFV5YC/2eJ+VXECwOadZJT554xP6cODZHPX3H9QMQECxvrgiSOP1pHjy1sMWQVYJOUOA==\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"debug\": \"^4.3.4\"\n+      },\n+      \"engines\": {\n+        \"node\": \">= 14\"\n+      }\n+    },\n+    \"node_modules/@npmcli/agent/node_modules/http-proxy-agent\": {\n+      \"version\": \"7.0.2\",\n+      \"resolved\": \"https://registry.npmjs.org/http-proxy-agent/-/http-proxy-agent-7.0.2.tgz\",\n+      \"integrity\": \"sha512-T1gkAiYYDWYx3V5Bmyu7HcfcvL7mUrTWiM6yOfa3PIphViJ/gFPbvidQ+veqSOHci/PxBcDabeUNCzpOODJZig==\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"agent-base\": \"^7.1.0\",\n+        \"debug\": \"^4.3.4\"\n+      },\n+      \"engines\": {\n+        \"node\": \">= 14\"\n+      }\n+    },\n+    \"node_modules/@npmcli/agent/node_modules/https-proxy-agent\": {\n+      \"version\": \"7.0.5\",\n+      \"resolved\": \"https://registry.npmjs.org/https-proxy-agent/-/https-proxy-agent-7.0.5.tgz\",\n+      \"integrity\": \"sha512-1e4Wqeblerz+tMKPIq2EMGiiWW1dIjZOksyHWSUm1rmuvw/how9hBHZ38lAGj5ID4Ik6EdkOw7NmWPy6LAwalw==\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"agent-base\": \"^7.0.2\",\n+        \"debug\": \"4\"\n+      },\n+      \"engines\": {\n+        \"node\": \">= 14\"\n+      }\n+    },\n+    \"node_modules/@npmcli/fs\": {\n+      \"version\": \"3.1.1\",\n+      \"resolved\": \"https://registry.npmjs.org/@npmcli/fs/-/fs-3.1.1.tgz\",\n+      \"integrity\": \"sha512-q9CRWjpHCMIh5sVyefoD1cA7PkvILqCZsnSOEUUivORLjxCO/Irmue2DprETiNgEqktDBZaM1Bi+jrarx1XdCg==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"semver\": \"^7.3.5\"\n+      },\n+      \"engines\": {\n+        \"node\": \"^14.17.0 || ^16.13.0 || >=18.0.0\"\n+      }\n+    },\n     \"node_modules/@phc/format\": {\n       \"version\": \"1.0.0\",\n       \"resolved\": \"https://registry.npmjs.org/@phc/format/-/format-1.0.0.tgz\",\n\n@@ -1897,7 +1956,6 @@\n\"version\": \"0.11.0\",\n       \"resolved\": \"https://registry.npmjs.org/@pkgjs/parseargs/-/parseargs-0.11.0.tgz\",\n       \"integrity\": \"sha512-+1VkjdD0QBLPodGrJUeqarH8VAIvQODIbwh9XpP5Syisf7YoQgsJKPNFoqqLQlu+VQ/tVSshMR6loPMn8U+dPg==\",\n-      \"dev\": true,\n       \"license\": \"MIT\",\n       \"optional\": true,\n       \"engines\": {\n\n@@ -3498,6 +3556,19 @@\n\"node\": \">= 8.0.0\"\n       }\n     },\n+    \"node_modules/aggregate-error\": {\n+      \"version\": \"3.1.0\",\n+      \"resolved\": \"https://registry.npmjs.org/aggregate-error/-/aggregate-error-3.1.0.tgz\",\n+      \"integrity\": \"sha512-4I7Td01quW/RpocfNayFdFVk1qSuoh0E7JrbRJ16nH01HhKFQ88INq9Sd+nd72zqRySlr9BmDA8xlEJ6vJMrYA==\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"clean-stack\": \"^2.0.0\",\n+        \"indent-string\": \"^4.0.0\"\n+      },\n+      \"engines\": {\n+        \"node\": \">=8\"\n+      }\n+    },\n     \"node_modules/ansi-regex\": {\n       \"version\": \"5.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/ansi-regex/-/ansi-regex-5.0.1.tgz\",\n\n@@ -3879,6 +3950,85 @@\n\"node\": \">=8\"\n       }\n     },\n+    \"node_modules/cacache\": {\n+      \"version\": \"18.0.4\",\n+      \"resolved\": \"https://registry.npmjs.org/cacache/-/cacache-18.0.4.tgz\",\n+      \"integrity\": \"sha512-B+L5iIa9mgcjLbliir2th36yEwPftrzteHYujzsx3dFP/31GCHcIeS8f5MGd80odLOjaOvSpU3EEAmRQptkxLQ==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"@npmcli/fs\": \"^3.1.0\",\n+        \"fs-minipass\": \"^3.0.0\",\n+        \"glob\": \"^10.2.2\",\n+        \"lru-cache\": \"^10.0.1\",\n+        \"minipass\": \"^7.0.3\",\n+        \"minipass-collect\": \"^2.0.1\",\n+        \"minipass-flush\": \"^1.0.5\",\n+        \"minipass-pipeline\": \"^1.2.4\",\n+        \"p-map\": \"^4.0.0\",\n+        \"ssri\": \"^10.0.0\",\n+        \"tar\": \"^6.1.11\",\n+        \"unique-filename\": \"^3.0.0\"\n+      },\n+      \"engines\": {\n+        \"node\": \"^16.14.0 || >=18.0.0\"\n+      }\n+    },\n+    \"node_modules/cacache/node_modules/brace-expansion\": {\n+      \"version\": \"2.0.1\",\n+      \"resolved\": \"https://registry.npmjs.org/brace-expansion/-/brace-expansion-2.0.1.tgz\",\n+      \"integrity\": \"sha512-XnAIvQ8eM+kC6aULx6wuQiwVsnzsi9d3WxzV3FpWTGA19F621kwdbsAcFKXgKUHZWsy+mY6iL1sHTxWEFCytDA==\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"balanced-match\": \"^1.0.0\"\n+      }\n+    },\n+    \"node_modules/cacache/node_modules/fs-minipass\": {\n+      \"version\": \"3.0.3\",\n+      \"resolved\": \"https://registry.npmjs.org/fs-minipass/-/fs-minipass-3.0.3.tgz\",\n+      \"integrity\": \"sha512-XUBA9XClHbnJWSfBzjkm6RvPsyg3sryZt06BEQoXcF7EK/xpGaQYJgQKDJSUH5SGZ76Y7pFx1QBnXz09rU5Fbw==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"minipass\": \"^7.0.3\"\n+      },\n+      \"engines\": {\n+        \"node\": \"^14.17.0 || ^16.13.0 || >=18.0.0\"\n+      }\n+    },\n+    \"node_modules/cacache/node_modules/glob\": {\n+      \"version\": \"10.4.5\",\n+      \"resolved\": \"https://registry.npmjs.org/glob/-/glob-10.4.5.tgz\",\n+      \"integrity\": \"sha512-7Bv8RF0k6xjo7d4A/PxYLbUCfb6c+Vpd2/mB2yRDlew7Jb5hEXiCD9ibfO7wpk8i4sevK6DFny9h7EYbM3/sHg==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"foreground-child\": \"^3.1.0\",\n+        \"jackspeak\": \"^3.1.2\",\n+        \"minimatch\": \"^9.0.4\",\n+        \"minipass\": \"^7.1.2\",\n+        \"package-json-from-dist\": \"^1.0.0\",\n+        \"path-scurry\": \"^1.11.1\"\n+      },\n+      \"bin\": {\n+        \"glob\": \"dist/esm/bin.mjs\"\n+      },\n+      \"funding\": {\n+        \"url\": \"https://github.com/sponsors/isaacs\"\n+      }\n+    },\n+    \"node_modules/cacache/node_modules/minimatch\": {\n+      \"version\": \"9.0.5\",\n+      \"resolved\": \"https://registry.npmjs.org/minimatch/-/minimatch-9.0.5.tgz\",\n+      \"integrity\": \"sha512-G6T0ZX48xgozx7587koeX9Ys2NYy6Gmv//P89sEte9V9whIapMNF4idKxnW2QtCcLiTWlb/wfCabAtAFWhhBow==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"brace-expansion\": \"^2.0.1\"\n+      },\n+      \"engines\": {\n+        \"node\": \">=16 || 14 >=14.17\"\n+      },\n+      \"funding\": {\n+        \"url\": \"https://github.com/sponsors/isaacs\"\n+      }\n+    },\n     \"node_modules/cache-content-type\": {\n       \"version\": \"1.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/cache-content-type/-/cache-content-type-1.0.1.tgz\",\n\n@@ -4030,6 +4180,15 @@\n\"node\": \">=8\"\n       }\n     },\n+    \"node_modules/clean-stack\": {\n+      \"version\": \"2.2.0\",\n+      \"resolved\": \"https://registry.npmjs.org/clean-stack/-/clean-stack-2.2.0.tgz\",\n+      \"integrity\": \"sha512-4diC9HaTE+KRAMWhDhrGOECgWZxoevMc5TlkObMqNSsVU62PYzXZ/SMTjzyGAFF1YusgxGcSWTEXBhp0CPwQ1A==\",\n+      \"license\": \"MIT\",\n+      \"engines\": {\n+        \"node\": \">=6\"\n+      }\n+    },\n     \"node_modules/client-only\": {\n       \"version\": \"0.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/client-only/-/client-only-0.0.1.tgz\",\n\n@@ -4641,7 +4800,6 @@\n\"version\": \"0.2.0\",\n       \"resolved\": \"https://registry.npmjs.org/eastasianwidth/-/eastasianwidth-0.2.0.tgz\",\n       \"integrity\": \"sha512-I88TYZWc9XiYHRQ4/3c5rjjfgkjhLyW2luGIheGERbNQ6OY7yTybanSpDXZa8y7VUP9YmDcYa+eyq4ca7iLqWA==\",\n-      \"dev\": true,\n       \"license\": \"MIT\"\n     },\n     \"node_modules/ecdsa-sig-formatter\": {\n\n@@ -4683,6 +4841,29 @@\n\"node\": \">= 0.8\"\n       }\n     },\n+    \"node_modules/encoding\": {\n+      \"version\": \"0.1.13\",\n+      \"resolved\": \"https://registry.npmjs.org/encoding/-/encoding-0.1.13.tgz\",\n+      \"integrity\": \"sha512-ETBauow1T35Y/WZMkio9jiM0Z5xjHHmJ4XmjZOq1l/dXz3lr2sRn87nJy20RupqSh1F2m3HHPSp8ShIPQJrJ3A==\",\n+      \"license\": \"MIT\",\n+      \"optional\": true,\n+      \"dependencies\": {\n+        \"iconv-lite\": \"^0.6.2\"\n+      }\n+    },\n+    \"node_modules/encoding/node_modules/iconv-lite\": {\n+      \"version\": \"0.6.3\",\n+      \"resolved\": \"https://registry.npmjs.org/iconv-lite/-/iconv-lite-0.6.3.tgz\",\n+      \"integrity\": \"sha512-4fCk79wshMdzMp2rH06qWrJE4iolqLhCUH+OiuIgU++RB0+94NlDL81atO7GX55uUKueo0txHNtvEyI6D7WdMw==\",\n+      \"license\": \"MIT\",\n+      \"optional\": true,\n+      \"dependencies\": {\n+        \"safer-buffer\": \">= 2.1.2 < 3.0.0\"\n+      },\n+      \"engines\": {\n+        \"node\": \">=0.10.0\"\n+      }\n+    },\n     \"node_modules/end-of-stream\": {\n       \"version\": \"1.4.4\",\n       \"resolved\": \"https://registry.npmjs.org/end-of-stream/-/end-of-stream-1.4.4.tgz\",\n\n@@ -4692,6 +4873,21 @@\n\"once\": \"^1.4.0\"\n       }\n     },\n+    \"node_modules/env-paths\": {\n+      \"version\": \"2.2.1\",\n+      \"resolved\": \"https://registry.npmjs.org/env-paths/-/env-paths-2.2.1.tgz\",\n+      \"integrity\": \"sha512-+h1lkLKhZMTYjog1VEpJNG7NZJWcuc2DDk/qsqSTRRCOXiLjeQ1d1/udrUGhqMxUgAlwKNZ0cf2uqan5GLuS2A==\",\n+      \"license\": \"MIT\",\n+      \"engines\": {\n+        \"node\": \">=6\"\n+      }\n+    },\n+    \"node_modules/err-code\": {\n+      \"version\": \"2.0.3\",\n+      \"resolved\": \"https://registry.npmjs.org/err-code/-/err-code-2.0.3.tgz\",\n+      \"integrity\": \"sha512-2bmlRpNKBxT/CRmPOlyISQpNj+qSeYvcym/uT0Jx2bMOlKLtSy1ZmLuVxSEKKyor/N5yhvp/ZiG1oE3DEYMSFA==\",\n+      \"license\": \"MIT\"\n+    },\n     \"node_modules/es-define-property\": {\n       \"version\": \"1.0.0\",\n       \"resolved\": \"https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.0.tgz\",\n\n@@ -4834,6 +5030,12 @@\n\"node\": \">=6\"\n       }\n     },\n+    \"node_modules/exponential-backoff\": {\n+      \"version\": \"3.1.1\",\n+      \"resolved\": \"https://registry.npmjs.org/exponential-backoff/-/exponential-backoff-3.1.1.tgz\",\n+      \"integrity\": \"sha512-dX7e/LHVJ6W3DE1MHWi9S1EYzDESENfLrYohG2G++ovZrYOkm4Knwa0mc1cn84xJOR4KEU0WSchhLbd0UklbHw==\",\n+      \"license\": \"Apache-2.0\"\n+    },\n     \"node_modules/extend\": {\n       \"version\": \"3.0.2\",\n       \"resolved\": \"https://registry.npmjs.org/extend/-/extend-3.0.2.tgz\",\n\n@@ -4947,7 +5149,6 @@\n\"version\": \"3.3.0\",\n       \"resolved\": \"https://registry.npmjs.org/foreground-child/-/foreground-child-3.3.0.tgz\",\n       \"integrity\": \"sha512-Ld2g8rrAyMYFXBhEqMz8ZAHBi4J4uS1i/CxGMDnjyFWddMXLVcDp051DZfu+t7+ab7Wv6SMqpWmyFIj5UbfFvg==\",\n-      \"dev\": true,\n       \"license\": \"ISC\",\n       \"dependencies\": {\n         \"cross-spawn\": \"^7.0.0\",\n\n@@ -4964,7 +5165,6 @@\n\"version\": \"4.1.0\",\n       \"resolved\": \"https://registry.npmjs.org/signal-exit/-/signal-exit-4.1.0.tgz\",\n       \"integrity\": \"sha512-bzyZ1e88w9O1iNJbKnOlvYTrWPDl46O1bG0D3XInv+9tkPrxrN8jUUTiFlDkkmKWgn1M6CfIA13SuGqOa9Korw==\",\n-      \"dev\": true,\n       \"license\": \"ISC\",\n       \"engines\": {\n         \"node\": \">=14\"\n\n@@ -5541,6 +5741,12 @@\n\"node\": \">= 0.8\"\n       }\n     },\n+    \"node_modules/http-cache-semantics\": {\n+      \"version\": \"4.1.1\",\n+      \"resolved\": \"https://registry.npmjs.org/http-cache-semantics/-/http-cache-semantics-4.1.1.tgz\",\n+      \"integrity\": \"sha512-er295DKPVsV82j5kw1Gjt+ADA/XYHsajl82cGNQG2eyoPkvgUhX+nDIyelzhIWbbsXP39EHcI6l5tYs2FYqYXQ==\",\n+      \"license\": \"BSD-2-Clause\"\n+    },\n     \"node_modules/http-errors\": {\n       \"version\": \"1.8.1\",\n       \"resolved\": \"https://registry.npmjs.org/http-errors/-/http-errors-1.8.1.tgz\",\n\n@@ -5665,6 +5871,24 @@\n\"integrity\": \"sha512-XXOFtyqDjNDAQxVfYxuF7g9Il/IbWmmlQg2MYKOH8ExIT1qg6xc4zyS3HaEEATgs1btfzxq15ciUiY7gjSXRGQ==\",\n       \"license\": \"MIT\"\n     },\n+    \"node_modules/imurmurhash\": {\n+      \"version\": \"0.1.4\",\n+      \"resolved\": \"https://registry.npmjs.org/imurmurhash/-/imurmurhash-0.1.4.tgz\",\n+      \"integrity\": \"sha512-JmXMZ6wuvDmLiHEml9ykzqO6lwFbof0GG4IkcGaENdCRDDmMVnny7s5HsIgHCbaq0w2MyPhDqkhTUgS2LU2PHA==\",\n+      \"license\": \"MIT\",\n+      \"engines\": {\n+        \"node\": \">=0.8.19\"\n+      }\n+    },\n+    \"node_modules/indent-string\": {\n+      \"version\": \"4.0.0\",\n+      \"resolved\": \"https://registry.npmjs.org/indent-string/-/indent-string-4.0.0.tgz\",\n+      \"integrity\": \"sha512-EdDDZu4A2OyIK7Lr/2zG+w5jmbuk1DVBnEwREQvBzspBJkCEbRa8GxU1lghYcaGJCnRWibjDXlq779X1/y5xwg==\",\n+      \"license\": \"MIT\",\n+      \"engines\": {\n+        \"node\": \">=8\"\n+      }\n+    },\n     \"node_modules/inflation\": {\n       \"version\": \"2.1.0\",\n       \"resolved\": \"https://registry.npmjs.org/inflation/-/inflation-2.1.0.tgz\",\n\n@@ -5697,6 +5921,16 @@\n\"integrity\": \"sha512-JV/yugV2uzW5iMRSiZAyDtQd+nxtUnjeLt0acNdw98kKLrvuRVyB80tsREOE7yvGVgalhZ6RNXCmEHkUKBKxew==\",\n       \"license\": \"ISC\"\n     },\n+    \"node_modules/install-artifact-from-github\": {\n+      \"version\": \"1.3.5\",\n+      \"resolved\": \"https://registry.npmjs.org/install-artifact-from-github/-/install-artifact-from-github-1.3.5.tgz\",\n+      \"integrity\": \"sha512-gZHC7f/cJgXz7MXlHFBxPVMsvIbev1OQN1uKQYKVJDydGNm9oYf9JstbU4Atnh/eSvk41WtEovoRm+8IF686xg==\",\n+      \"license\": \"BSD-3-Clause\",\n+      \"bin\": {\n+        \"install-from-cache\": \"bin/install-from-cache.js\",\n+        \"save-to-github-cache\": \"bin/save-to-github-cache.js\"\n+      }\n+    },\n     \"node_modules/internmap\": {\n       \"version\": \"2.0.3\",\n       \"resolved\": \"https://registry.npmjs.org/internmap/-/internmap-2.0.3.tgz\",\n\n@@ -5715,6 +5949,19 @@\n\"loose-envify\": \"^1.0.0\"\n       }\n     },\n+    \"node_modules/ip-address\": {\n+      \"version\": \"9.0.5\",\n+      \"resolved\": \"https://registry.npmjs.org/ip-address/-/ip-address-9.0.5.tgz\",\n+      \"integrity\": \"sha512-zHtQzGojZXTwZTHQqra+ETKd4Sn3vgi7uBmlPoXVWZqYvuKmtI0l/VZTjqGmJY9x88GGOaZ9+G9ES8hC4T4X8g==\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"jsbn\": \"1.1.0\",\n+        \"sprintf-js\": \"^1.1.3\"\n+      },\n+      \"engines\": {\n+        \"node\": \">= 12\"\n+      }\n+    },\n     \"node_modules/is\": {\n       \"version\": \"3.3.0\",\n       \"resolved\": \"https://registry.npmjs.org/is/-/is-3.3.0.tgz\",\n\n@@ -5805,6 +6052,12 @@\n\"node\": \">=0.10.0\"\n       }\n     },\n+    \"node_modules/is-lambda\": {\n+      \"version\": \"1.0.1\",\n+      \"resolved\": \"https://registry.npmjs.org/is-lambda/-/is-lambda-1.0.1.tgz\",\n+      \"integrity\": \"sha512-z7CMFGNrENq5iFB9Bqo64Xk6Y9sg+epq1myIcdHaGnbMTYOxvzsEtdYqQUylB7LxfkvgrrjP32T6Ywciio9UIQ==\",\n+      \"license\": \"MIT\"\n+    },\n     \"node_modules/is-number\": {\n       \"version\": \"7.0.0\",\n       \"resolved\": \"https://registry.npmjs.org/is-number/-/is-number-7.0.0.tgz\",\n\n@@ -5854,7 +6107,6 @@\n\"version\": \"3.4.3\",\n       \"resolved\": \"https://registry.npmjs.org/jackspeak/-/jackspeak-3.4.3.tgz\",\n       \"integrity\": \"sha512-OGlZQpz2yfahA/Rd1Y8Cd9SIEsqvXkLVoSw/cgwhnhFMDbsQFeZYoJJ7bIZBS9BcamUW96asq/npPWugM+RQBw==\",\n-      \"dev\": true,\n       \"license\": \"BlueOak-1.0.0\",\n       \"dependencies\": {\n         \"@isaacs/cliui\": \"^8.0.2\"\n\n@@ -5891,6 +6143,12 @@\n\"integrity\": \"sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==\",\n       \"license\": \"MIT\"\n     },\n+    \"node_modules/jsbn\": {\n+      \"version\": \"1.1.0\",\n+      \"resolved\": \"https://registry.npmjs.org/jsbn/-/jsbn-1.1.0.tgz\",\n+      \"integrity\": \"sha512-4bYVV3aAMtDTTu4+xsDYa6sy9GyJ69/amsu9sYF2zqjiEoZA5xJi3BrfX3uY+/IekIu7MwdObdbDWpoZdBv3/A==\",\n+      \"license\": \"MIT\"\n+    },\n     \"node_modules/json-2-csv\": {\n       \"version\": \"5.5.5\",\n       \"resolved\": \"https://registry.npmjs.org/json-2-csv/-/json-2-csv-5.5.5.tgz\",\n\n@@ -6307,7 +6565,6 @@\n\"version\": \"10.4.3\",\n       \"resolved\": \"https://registry.npmjs.org/lru-cache/-/lru-cache-10.4.3.tgz\",\n       \"integrity\": \"sha512-JNAzZcXrCt42VGLuYz0zfAzDfAvJWW6AfYlDBQyDV5DClI2m5sAmK+OIO7s59XfsRsWHp02jAJrRadPRGTt6SQ==\",\n-      \"dev\": true,\n       \"license\": \"ISC\"\n     },\n     \"node_modules/lunary\": {\n\n@@ -6364,6 +6621,29 @@\n\"semver\": \"bin/semver.js\"\n       }\n     },\n+    \"node_modules/make-fetch-happen\": {\n+      \"version\": \"13.0.1\",\n+      \"resolved\": \"https://registry.npmjs.org/make-fetch-happen/-/make-fetch-happen-13.0.1.tgz\",\n+      \"integrity\": \"sha512-cKTUFc/rbKUd/9meOvgrpJ2WrNzymt6jfRDdwg5UCnVzv9dTpEj9JS5m3wtziXVCjluIXyL8pcaukYqezIzZQA==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"@npmcli/agent\": \"^2.0.0\",\n+        \"cacache\": \"^18.0.0\",\n+        \"http-cache-semantics\": \"^4.1.1\",\n+        \"is-lambda\": \"^1.0.1\",\n+        \"minipass\": \"^7.0.2\",\n+        \"minipass-fetch\": \"^3.0.0\",\n+        \"minipass-flush\": \"^1.0.5\",\n+        \"minipass-pipeline\": \"^1.2.4\",\n+        \"negotiator\": \"^0.6.3\",\n+        \"proc-log\": \"^4.2.0\",\n+        \"promise-retry\": \"^2.0.1\",\n+        \"ssri\": \"^10.0.0\"\n+      },\n+      \"engines\": {\n+        \"node\": \"^16.14.0 || >=18.0.0\"\n+      }\n+    },\n     \"node_modules/media-typer\": {\n       \"version\": \"0.3.0\",\n       \"resolved\": \"https://registry.npmjs.org/media-typer/-/media-typer-0.3.0.tgz\",\n\n@@ -6486,12 +6766,112 @@\n\"version\": \"7.1.2\",\n       \"resolved\": \"https://registry.npmjs.org/minipass/-/minipass-7.1.2.tgz\",\n       \"integrity\": \"sha512-qOOzS1cBTWYF4BH8fVePDBOO9iptMnGUEZwNc/cMWnTV2nVLZ7VoNWEPHkYczZA0pdoA7dl6e7FL659nX9S2aw==\",\n-      \"dev\": true,\n       \"license\": \"ISC\",\n       \"engines\": {\n         \"node\": \">=16 || 14 >=14.17\"\n       }\n     },\n+    \"node_modules/minipass-collect\": {\n+      \"version\": \"2.0.1\",\n+      \"resolved\": \"https://registry.npmjs.org/minipass-collect/-/minipass-collect-2.0.1.tgz\",\n+      \"integrity\": \"sha512-D7V8PO9oaz7PWGLbCACuI1qEOsq7UKfLotx/C0Aet43fCUB/wfQ7DYeq2oR/svFJGYDHPr38SHATeaj/ZoKHKw==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"minipass\": \"^7.0.3\"\n+      },\n+      \"engines\": {\n+        \"node\": \">=16 || 14 >=14.17\"\n+      }\n+    },\n+    \"node_modules/minipass-fetch\": {\n+      \"version\": \"3.0.5\",\n+      \"resolved\": \"https://registry.npmjs.org/minipass-fetch/-/minipass-fetch-3.0.5.tgz\",\n+      \"integrity\": \"sha512-2N8elDQAtSnFV0Dk7gt15KHsS0Fyz6CbYZ360h0WTYV1Ty46li3rAXVOQj1THMNLdmrD9Vt5pBPtWtVkpwGBqg==\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"minipass\": \"^7.0.3\",\n+        \"minipass-sized\": \"^1.0.3\",\n+        \"minizlib\": \"^2.1.2\"\n+      },\n+      \"engines\": {\n+        \"node\": \"^14.17.0 || ^16.13.0 || >=18.0.0\"\n+      },\n+      \"optionalDependencies\": {\n+        \"encoding\": \"^0.1.13\"\n+      }\n+    },\n+    \"node_modules/minipass-flush\": {\n+      \"version\": \"1.0.5\",\n+      \"resolved\": \"https://registry.npmjs.org/minipass-flush/-/minipass-flush-1.0.5.tgz\",\n+      \"integrity\": \"sha512-JmQSYYpPUqX5Jyn1mXaRwOda1uQ8HP5KAT/oDSLCzt1BYRhQU0/hDtsB1ufZfEEzMZ9aAVmsBw8+FWsIXlClWw==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"minipass\": \"^3.0.0\"\n+      },\n+      \"engines\": {\n+        \"node\": \">= 8\"\n+      }\n+    },\n+    \"node_modules/minipass-flush/node_modules/minipass\": {\n+      \"version\": \"3.3.6\",\n+      \"resolved\": \"https://registry.npmjs.org/minipass/-/minipass-3.3.6.tgz\",\n+      \"integrity\": \"sha512-DxiNidxSEK+tHG6zOIklvNOwm3hvCrbUrdtzY74U6HKTJxvIDfOUL5W5P2Ghd3DTkhhKPYGqeNUIh5qcM4YBfw==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"yallist\": \"^4.0.0\"\n+      },\n+      \"engines\": {\n+        \"node\": \">=8\"\n+      }\n+    },\n+    \"node_modules/minipass-pipeline\": {\n+      \"version\": \"1.2.4\",\n+      \"resolved\": \"https://registry.npmjs.org/minipass-pipeline/-/minipass-pipeline-1.2.4.tgz\",\n+      \"integrity\": \"sha512-xuIq7cIOt09RPRJ19gdi4b+RiNvDFYe5JH+ggNvBqGqpQXcru3PcRmOZuHBKWK1Txf9+cQ+HMVN4d6z46LZP7A==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"minipass\": \"^3.0.0\"\n+      },\n+      \"engines\": {\n+        \"node\": \">=8\"\n+      }\n+    },\n+    \"node_modules/minipass-pipeline/node_modules/minipass\": {\n+      \"version\": \"3.3.6\",\n+      \"resolved\": \"https://registry.npmjs.org/minipass/-/minipass-3.3.6.tgz\",\n+      \"integrity\": \"sha512-DxiNidxSEK+tHG6zOIklvNOwm3hvCrbUrdtzY74U6HKTJxvIDfOUL5W5P2Ghd3DTkhhKPYGqeNUIh5qcM4YBfw==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"yallist\": \"^4.0.0\"\n+      },\n+      \"engines\": {\n+        \"node\": \">=8\"\n+      }\n+    },\n+    \"node_modules/minipass-sized\": {\n+      \"version\": \"1.0.3\",\n+      \"resolved\": \"https://registry.npmjs.org/minipass-sized/-/minipass-sized-1.0.3.tgz\",\n+      \"integrity\": \"sha512-MbkQQ2CTiBMlA2Dm/5cY+9SWFEN8pzzOXi6rlM5Xxq0Yqbda5ZQy9sU75a673FE9ZK0Zsbr6Y5iP6u9nktfg2g==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"minipass\": \"^3.0.0\"\n+      },\n+      \"engines\": {\n+        \"node\": \">=8\"\n+      }\n+    },\n+    \"node_modules/minipass-sized/node_modules/minipass\": {\n+      \"version\": \"3.3.6\",\n+      \"resolved\": \"https://registry.npmjs.org/minipass/-/minipass-3.3.6.tgz\",\n+      \"integrity\": \"sha512-DxiNidxSEK+tHG6zOIklvNOwm3hvCrbUrdtzY74U6HKTJxvIDfOUL5W5P2Ghd3DTkhhKPYGqeNUIh5qcM4YBfw==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"yallist\": \"^4.0.0\"\n+      },\n+      \"engines\": {\n+        \"node\": \">=8\"\n+      }\n+    },\n     \"node_modules/minizlib\": {\n       \"version\": \"2.1.2\",\n       \"resolved\": \"https://registry.npmjs.org/minizlib/-/minizlib-2.1.2.tgz\",\n\n@@ -6569,6 +6949,12 @@\n\"url\": \"https://github.com/sponsors/wooorm\"\n       }\n     },\n+    \"node_modules/nan\": {\n+      \"version\": \"2.20.0\",\n+      \"resolved\": \"https://registry.npmjs.org/nan/-/nan-2.20.0.tgz\",\n+      \"integrity\": \"sha512-bk3gXBZDGILuuo/6sKtr0DQmSThYHLtNCdSdXk9YkxD/jK6X2vmCyyXBBxyqZ4XcnzTyYEAThfX3DCEnLf6igw==\",\n+      \"license\": \"MIT\"\n+    },\n     \"node_modules/nanoid\": {\n       \"version\": \"3.3.7\",\n       \"resolved\": \"https://registry.npmjs.org/nanoid/-/nanoid-3.3.7.tgz\",\n\n@@ -6803,6 +7189,30 @@\n\"node\": \">= 6.13.0\"\n       }\n     },\n+    \"node_modules/node-gyp\": {\n+      \"version\": \"10.2.0\",\n+      \"resolved\": \"https://registry.npmjs.org/node-gyp/-/node-gyp-10.2.0.tgz\",\n+      \"integrity\": \"sha512-sp3FonBAaFe4aYTcFdZUn2NYkbP7xroPGYvQmP4Nl5PxamznItBnNCgjrVTKrEfQynInMsJvZrdmqUnysCJ8rw==\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"env-paths\": \"^2.2.0\",\n+        \"exponential-backoff\": \"^3.1.1\",\n+        \"glob\": \"^10.3.10\",\n+        \"graceful-fs\": \"^4.2.6\",\n+        \"make-fetch-happen\": \"^13.0.0\",\n+        \"nopt\": \"^7.0.0\",\n+        \"proc-log\": \"^4.1.0\",\n+        \"semver\": \"^7.3.5\",\n+        \"tar\": \"^6.2.1\",\n+        \"which\": \"^4.0.0\"\n+      },\n+      \"bin\": {\n+        \"node-gyp\": \"bin/node-gyp.js\"\n+      },\n+      \"engines\": {\n+        \"node\": \"^16.14.0 || >=18.0.0\"\n+      }\n+    },\n     \"node_modules/node-gyp-build\": {\n       \"version\": \"4.8.2\",\n       \"resolved\": \"https://registry.npmjs.org/node-gyp-build/-/node-gyp-build-4.8.2.tgz\",\n\n@@ -6814,6 +7224,98 @@\n\"node-gyp-build-test\": \"build-test.js\"\n       }\n     },\n+    \"node_modules/node-gyp/node_modules/abbrev\": {\n+      \"version\": \"2.0.0\",\n+      \"resolved\": \"https://registry.npmjs.org/abbrev/-/abbrev-2.0.0.tgz\",\n+      \"integrity\": \"sha512-6/mh1E2u2YgEsCHdY0Yx5oW+61gZU+1vXaoiHHrpKeuRNNgFvS+/jrwHiQhB5apAf5oB7UB7E19ol2R2LKH8hQ==\",\n+      \"license\": \"ISC\",\n+      \"engines\": {\n+        \"node\": \"^14.17.0 || ^16.13.0 || >=18.0.0\"\n+      }\n+    },\n+    \"node_modules/node-gyp/node_modules/brace-expansion\": {\n+      \"version\": \"2.0.1\",\n+      \"resolved\": \"https://registry.npmjs.org/brace-expansion/-/brace-expansion-2.0.1.tgz\",\n+      \"integrity\": \"sha512-XnAIvQ8eM+kC6aULx6wuQiwVsnzsi9d3WxzV3FpWTGA19F621kwdbsAcFKXgKUHZWsy+mY6iL1sHTxWEFCytDA==\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"balanced-match\": \"^1.0.0\"\n+      }\n+    },\n+    \"node_modules/node-gyp/node_modules/glob\": {\n+      \"version\": \"10.4.5\",\n+      \"resolved\": \"https://registry.npmjs.org/glob/-/glob-10.4.5.tgz\",\n+      \"integrity\": \"sha512-7Bv8RF0k6xjo7d4A/PxYLbUCfb6c+Vpd2/mB2yRDlew7Jb5hEXiCD9ibfO7wpk8i4sevK6DFny9h7EYbM3/sHg==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"foreground-child\": \"^3.1.0\",\n+        \"jackspeak\": \"^3.1.2\",\n+        \"minimatch\": \"^9.0.4\",\n+        \"minipass\": \"^7.1.2\",\n+        \"package-json-from-dist\": \"^1.0.0\",\n+        \"path-scurry\": \"^1.11.1\"\n+      },\n+      \"bin\": {\n+        \"glob\": \"dist/esm/bin.mjs\"\n+      },\n+      \"funding\": {\n+        \"url\": \"https://github.com/sponsors/isaacs\"\n+      }\n+    },\n+    \"node_modules/node-gyp/node_modules/isexe\": {\n+      \"version\": \"3.1.1\",\n+      \"resolved\": \"https://registry.npmjs.org/isexe/-/isexe-3.1.1.tgz\",\n+      \"integrity\": \"sha512-LpB/54B+/2J5hqQ7imZHfdU31OlgQqx7ZicVlkm9kzg9/w8GKLEcFfJl/t7DCEDueOyBAD6zCCwTO6Fzs0NoEQ==\",\n+      \"license\": \"ISC\",\n+      \"engines\": {\n+        \"node\": \">=16\"\n+      }\n+    },\n+    \"node_modules/node-gyp/node_modules/minimatch\": {\n+      \"version\": \"9.0.5\",\n+      \"resolved\": \"https://registry.npmjs.org/minimatch/-/minimatch-9.0.5.tgz\",\n+      \"integrity\": \"sha512-G6T0ZX48xgozx7587koeX9Ys2NYy6Gmv//P89sEte9V9whIapMNF4idKxnW2QtCcLiTWlb/wfCabAtAFWhhBow==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"brace-expansion\": \"^2.0.1\"\n+      },\n+      \"engines\": {\n+        \"node\": \">=16 || 14 >=14.17\"\n+      },\n+      \"funding\": {\n+        \"url\": \"https://github.com/sponsors/isaacs\"\n+      }\n+    },\n+    \"node_modules/node-gyp/node_modules/nopt\": {\n+      \"version\": \"7.2.1\",\n+      \"resolved\": \"https://registry.npmjs.org/nopt/-/nopt-7.2.1.tgz\",\n+      \"integrity\": \"sha512-taM24ViiimT/XntxbPyJQzCG+p4EKOpgD3mxFwW38mGjVUrfERQOeY4EDHjdnptttfHuHQXFx+lTP08Q+mLa/w==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"abbrev\": \"^2.0.0\"\n+      },\n+      \"bin\": {\n+        \"nopt\": \"bin/nopt.js\"\n+      },\n+      \"engines\": {\n+        \"node\": \"^14.17.0 || ^16.13.0 || >=18.0.0\"\n+      }\n+    },\n+    \"node_modules/node-gyp/node_modules/which\": {\n+      \"version\": \"4.0.0\",\n+      \"resolved\": \"https://registry.npmjs.org/which/-/which-4.0.0.tgz\",\n+      \"integrity\": \"sha512-GlaYyEb07DPxYCKhKzplCWBJtvxZcZMrL+4UkrTSJHHPyZU4mYYTv3qaOe77H7EODLSSopAUFAc6W8U4yqvscg==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"isexe\": \"^3.1.1\"\n+      },\n+      \"bin\": {\n+        \"node-which\": \"bin/which.js\"\n+      },\n+      \"engines\": {\n+        \"node\": \"^16.13.0 || >=18.0.0\"\n+      }\n+    },\n     \"node_modules/node-rsa\": {\n       \"version\": \"1.1.1\",\n       \"resolved\": \"https://registry.npmjs.org/node-rsa/-/node-rsa-1.1.1.tgz\",\n\n@@ -7094,6 +7596,21 @@\n\"node\": \">=0.10.0\"\n       }\n     },\n+    \"node_modules/p-map\": {\n+      \"version\": \"4.0.0\",\n+      \"resolved\": \"https://registry.npmjs.org/p-map/-/p-map-4.0.0.tgz\",\n+      \"integrity\": \"sha512-/bjOqmgETBYB5BoEeGVea8dmvHb2m9GLy1E9W43yeyfP6QQCZGFNa+XRceJEuDB6zqr+gKpIAmlLebMpykw/MQ==\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"aggregate-error\": \"^3.0.0\"\n+      },\n+      \"engines\": {\n+        \"node\": \">=10\"\n+      },\n+      \"funding\": {\n+        \"url\": \"https://github.com/sponsors/sindresorhus\"\n+      }\n+    },\n     \"node_modules/p-queue\": {\n       \"version\": \"8.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/p-queue/-/p-queue-8.0.1.tgz\",\n\n@@ -7126,7 +7643,6 @@\n\"version\": \"1.0.0\",\n       \"resolved\": \"https://registry.npmjs.org/package-json-from-dist/-/package-json-from-dist-1.0.0.tgz\",\n       \"integrity\": \"sha512-dATvCeZN/8wQsGywez1mzHtTlP22H8OEfPrVMLNr4/eGa+ijtLn/6M5f0dY8UKNrC2O9UCU6SSoG3qRKnt7STw==\",\n-      \"dev\": true,\n       \"license\": \"BlueOak-1.0.0\"\n     },\n     \"node_modules/pako\": {\n\n@@ -7202,7 +7718,6 @@\n\"version\": \"1.11.1\",\n       \"resolved\": \"https://registry.npmjs.org/path-scurry/-/path-scurry-1.11.1.tgz\",\n       \"integrity\": \"sha512-Xa4Nw17FS9ApQFJ9umLiJS4orGjm7ZzwUrwamcGQuHSzDyth9boKDaycYdDcZDuqYATXw4HFXgaqWTctW/v1HA==\",\n-      \"dev\": true,\n       \"license\": \"BlueOak-1.0.0\",\n       \"dependencies\": {\n         \"lru-cache\": \"^10.2.0\",\n\n@@ -7602,6 +8117,28 @@\n\"node\": \">=12\"\n       }\n     },\n+    \"node_modules/proc-log\": {\n+      \"version\": \"4.2.0\",\n+      \"resolved\": \"https://registry.npmjs.org/proc-log/-/proc-log-4.2.0.tgz\",\n+      \"integrity\": \"sha512-g8+OnU/L2v+wyiVK+D5fA34J7EH8jZ8DDlvwhRCMxmMj7UCBvxiO1mGeN+36JXIKF4zevU4kRBd8lVgG9vLelA==\",\n+      \"license\": \"ISC\",\n+      \"engines\": {\n+        \"node\": \"^14.17.0 || ^16.13.0 || >=18.0.0\"\n+      }\n+    },\n+    \"node_modules/promise-retry\": {\n+      \"version\": \"2.0.1\",\n+      \"resolved\": \"https://registry.npmjs.org/promise-retry/-/promise-retry-2.0.1.tgz\",\n+      \"integrity\": \"sha512-y+WKFlBR8BGXnsNlIHFGPZmyDf3DFMoLhaflAnyZgV6rG6xu+JwesTo2Q9R6XwYmtmwAFCkAk3e35jEdoeh/3g==\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"err-code\": \"^2.0.2\",\n+        \"retry\": \"^0.12.0\"\n+      },\n+      \"engines\": {\n+        \"node\": \">=10\"\n+      }\n+    },\n     \"node_modules/prop-types\": {\n       \"version\": \"15.8.1\",\n       \"resolved\": \"https://registry.npmjs.org/prop-types/-/prop-types-15.8.1.tgz\",\n\n@@ -7813,6 +8350,18 @@\n\"rc\": \"cli.js\"\n       }\n     },\n+    \"node_modules/re2\": {\n+      \"version\": \"1.21.4\",\n+      \"resolved\": \"https://registry.npmjs.org/re2/-/re2-1.21.4.tgz\",\n+      \"integrity\": \"sha512-MVIfXWJmsP28mRsSt8HeL750ifb8H5+oF2UDIxGaiJCr8fkMqhLZ7kcX9ADRk2dC8qeGKedB7UVYRfBVpEiLfA==\",\n+      \"hasInstallScript\": true,\n+      \"license\": \"BSD-3-Clause\",\n+      \"dependencies\": {\n+        \"install-artifact-from-github\": \"^1.3.5\",\n+        \"nan\": \"^2.20.0\",\n+        \"node-gyp\": \"^10.2.0\"\n+      }\n+    },\n     \"node_modules/react\": {\n       \"version\": \"18.3.1\",\n       \"resolved\": \"https://registry.npmjs.org/react/-/react-18.3.1.tgz\",\n\n@@ -8113,6 +8662,15 @@\n\"url\": \"https://github.com/privatenumber/resolve-pkg-maps?sponsor=1\"\n       }\n     },\n+    \"node_modules/retry\": {\n+      \"version\": \"0.12.0\",\n+      \"resolved\": \"https://registry.npmjs.org/retry/-/retry-0.12.0.tgz\",\n+      \"integrity\": \"sha512-9LkiTwjUh6rT555DtE9rTX+BKByPfrMzEAtnlEtdEwr3Nkffwiihqe2bWADg+OQRjt9gl6ICdmB/ZFDCGAtSow==\",\n+      \"license\": \"MIT\",\n+      \"engines\": {\n+        \"node\": \">= 4\"\n+      }\n+    },\n     \"node_modules/retry-request\": {\n       \"version\": \"7.0.2\",\n       \"resolved\": \"https://registry.npmjs.org/retry-request/-/retry-request-7.0.2.tgz\",\n\n@@ -8483,6 +9041,56 @@\n\"node\": \">=6\"\n       }\n     },\n+    \"node_modules/smart-buffer\": {\n+      \"version\": \"4.2.0\",\n+      \"resolved\": \"https://registry.npmjs.org/smart-buffer/-/smart-buffer-4.2.0.tgz\",\n+      \"integrity\": \"sha512-94hK0Hh8rPqQl2xXc3HsaBoOXKV20MToPkcXvwbISWLEs+64sBq5kFgn2kJDHb1Pry9yrP0dxrCI9RRci7RXKg==\",\n+      \"license\": \"MIT\",\n+      \"engines\": {\n+        \"node\": \">= 6.0.0\",\n+        \"npm\": \">= 3.0.0\"\n+      }\n+    },\n+    \"node_modules/socks\": {\n+      \"version\": \"2.8.3\",\n+      \"resolved\": \"https://registry.npmjs.org/socks/-/socks-2.8.3.tgz\",\n+      \"integrity\": \"sha512-l5x7VUUWbjVFbafGLxPWkYsHIhEvmF85tbIeFZWc8ZPtoMyybuEhL7Jye/ooC4/d48FgOjSJXgsF/AJPYCW8Zw==\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"ip-address\": \"^9.0.5\",\n+        \"smart-buffer\": \"^4.2.0\"\n+      },\n+      \"engines\": {\n+        \"node\": \">= 10.0.0\",\n+        \"npm\": \">= 3.0.0\"\n+      }\n+    },\n+    \"node_modules/socks-proxy-agent\": {\n+      \"version\": \"8.0.4\",\n+      \"resolved\": \"https://registry.npmjs.org/socks-proxy-agent/-/socks-proxy-agent-8.0.4.tgz\",\n+      \"integrity\": \"sha512-GNAq/eg8Udq2x0eNiFkr9gRg5bA7PXEWagQdeRX4cPSG+X/8V38v637gim9bjFptMk1QWsCTr0ttrJEiXbNnRw==\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"agent-base\": \"^7.1.1\",\n+        \"debug\": \"^4.3.4\",\n+        \"socks\": \"^2.8.3\"\n+      },\n+      \"engines\": {\n+        \"node\": \">= 14\"\n+      }\n+    },\n+    \"node_modules/socks-proxy-agent/node_modules/agent-base\": {\n+      \"version\": \"7.1.1\",\n+      \"resolved\": \"https://registry.npmjs.org/agent-base/-/agent-base-7.1.1.tgz\",\n+      \"integrity\": \"sha512-H0TSyFNDMomMNJQBn8wFV5YC/2eJ+VXECwOadZJT554xP6cODZHPX3H9QMQECxvrgiSOP1pHjy1sMWQVYJOUOA==\",\n+      \"license\": \"MIT\",\n+      \"dependencies\": {\n+        \"debug\": \"^4.3.4\"\n+      },\n+      \"engines\": {\n+        \"node\": \">= 14\"\n+      }\n+    },\n     \"node_modules/source-map\": {\n       \"version\": \"0.8.0-beta.0\",\n       \"resolved\": \"https://registry.npmjs.org/source-map/-/source-map-0.8.0-beta.0.tgz\",\n\n@@ -8510,6 +9118,24 @@\n\"resolved\": \"https://registry.npmjs.org/spawn-command/-/spawn-command-0.0.2.tgz\",\n       \"integrity\": \"sha512-zC8zGoGkmc8J9ndvml8Xksr1Amk9qBujgbF0JAIWO7kXr43w0h/0GJNM/Vustixu+YE8N/MTrQ7N31FvHUACxQ==\"\n     },\n+    \"node_modules/sprintf-js\": {\n+      \"version\": \"1.1.3\",\n+      \"resolved\": \"https://registry.npmjs.org/sprintf-js/-/sprintf-js-1.1.3.tgz\",\n+      \"integrity\": \"sha512-Oo+0REFV59/rz3gfJNKQiBlwfHaSESl1pcGyABQsnnIfWOFt6JNj5gCog2U6MLZ//IGYD+nA8nI+mTShREReaA==\",\n+      \"license\": \"BSD-3-Clause\"\n+    },\n+    \"node_modules/ssri\": {\n+      \"version\": \"10.0.6\",\n+      \"resolved\": \"https://registry.npmjs.org/ssri/-/ssri-10.0.6.tgz\",\n+      \"integrity\": \"sha512-MGrFH9Z4NP9Iyhqn16sDtBpRRNJ0Y2hNa6D65h736fVSaPCHr4DM4sWUNvVaSuC+0OBGhwsrydQwmgfg5LncqQ==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"minipass\": \"^7.0.3\"\n+      },\n+      \"engines\": {\n+        \"node\": \"^14.17.0 || ^16.13.0 || >=18.0.0\"\n+      }\n+    },\n     \"node_modules/statuses\": {\n       \"version\": \"1.5.0\",\n       \"resolved\": \"https://registry.npmjs.org/statuses/-/statuses-1.5.0.tgz\",\n\n@@ -8584,7 +9210,6 @@\n\"version\": \"4.2.3\",\n       \"resolved\": \"https://registry.npmjs.org/string-width/-/string-width-4.2.3.tgz\",\n       \"integrity\": \"sha512-wKyQRQpjJ0sIp62ErSZdGsjMJWsap5oRNihHhu6G7JVO/9jIB6UyevL+tXuOqrng8j/cxKTWyWUwvSTriiZz/g==\",\n-      \"dev\": true,\n       \"license\": \"MIT\",\n       \"dependencies\": {\n         \"emoji-regex\": \"^8.0.0\",\n\n@@ -8612,7 +9237,6 @@\n\"version\": \"6.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/strip-ansi/-/strip-ansi-6.0.1.tgz\",\n       \"integrity\": \"sha512-Y38VPSHcqkFrCpFnQ9vuSXmquuv5oXOKpGeT6aGrr3o3Gc9AlVa6JBfUSOCnbxGGZF+/0ooI7KrPuUSztUdU5A==\",\n-      \"dev\": true,\n       \"license\": \"MIT\",\n       \"dependencies\": {\n         \"ansi-regex\": \"^5.0.1\"\n\n@@ -9176,6 +9800,30 @@\n\"integrity\": \"sha512-ve2KP6f/JnbPBFyobGHuerC9g1FYGn/F8n1LWTwNxCEzd6IfqTwUQcNXgEtmmQ6DlRrC1hrSrBnCZPokRrDHjw==\",\n       \"license\": \"MIT\"\n     },\n+    \"node_modules/unique-filename\": {\n+      \"version\": \"3.0.0\",\n+      \"resolved\": \"https://registry.npmjs.org/unique-filename/-/unique-filename-3.0.0.tgz\",\n+      \"integrity\": \"sha512-afXhuC55wkAmZ0P18QsVE6kp8JaxrEokN2HGIoIVv2ijHQd419H0+6EigAFcIzXeMIkcIkNBpB3L/DXB3cTS/g==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"unique-slug\": \"^4.0.0\"\n+      },\n+      \"engines\": {\n+        \"node\": \"^14.17.0 || ^16.13.0 || >=18.0.0\"\n+      }\n+    },\n+    \"node_modules/unique-slug\": {\n+      \"version\": \"4.0.0\",\n+      \"resolved\": \"https://registry.npmjs.org/unique-slug/-/unique-slug-4.0.0.tgz\",\n+      \"integrity\": \"sha512-WrcA6AyEfqDX5bWige/4NQfPZMtASNVxdmWR76WESYQVAACSgWcR6e9i0mofqqBxYFtL4oAxPIptY73/0YE1DQ==\",\n+      \"license\": \"ISC\",\n+      \"dependencies\": {\n+        \"imurmurhash\": \"^0.1.4\"\n+      },\n+      \"engines\": {\n+        \"node\": \"^14.17.0 || ^16.13.0 || >=18.0.0\"\n+      }\n+    },\n     \"node_modules/universalify\": {\n       \"version\": \"2.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/universalify/-/universalify-2.0.1.tgz\",\n\n@@ -9449,7 +10097,6 @@\n\"version\": \"7.0.0\",\n       \"resolved\": \"https://registry.npmjs.org/wrap-ansi/-/wrap-ansi-7.0.0.tgz\",\n       \"integrity\": \"sha512-YVGIj2kamLSTxw6NsZjoBxfSwsn0ycdesmc4p+Q21c5zPuZ1pl+NfxVdxPtdHvmNVOQ6XSYG4AUtyt/Fi7D16Q==\",\n-      \"dev\": true,\n       \"license\": \"MIT\",\n       \"dependencies\": {\n         \"ansi-styles\": \"^4.0.0\",\n\n@@ -9605,6 +10252,7 @@\n\"postgres\": \"^3.4.4\",\n         \"prexit\": \"^2.3.0\",\n         \"queue-promise\": \"^2.2.1\",\n+        \"re2\": \"^1.21.4\",\n         \"rouge\": \"^1.0.3\",\n         \"samlify\": \"^2.8.11\",\n         \"shared\": \"*\",\n```\n\nFilename: packages/backend/package.json:\n```\n@@ -38,6 +38,7 @@\n\"postgres\": \"^3.4.4\",\n     \"prexit\": \"^2.3.0\",\n     \"queue-promise\": \"^2.2.1\",\n+    \"re2\": \"^1.21.4\",\n     \"rouge\": \"^1.0.3\",\n     \"samlify\": \"^2.8.11\",\n     \"shared\": \"*\",\n```\n\nFilename: packages/backend/src/api/v1/auth/utils.ts:\n```\n@@ -75,7 +75,7 @@\ninterface SessionData {\n }\n \n const publicRoutes = [\n-  new RegExp(`/auth/.+`),\n+  new RegExp(`^/auth/.+`),\n   \"/api/report\", // required legacy route\n   \"/api/v1/template\", // legacy template route\n   \"/v1/health\",\n```\n\nFilename: packages/backend/src/checks/index.ts:\n```\n@@ -2,14 +2,14 @@\nimport sql from \"../utils/db\";\n import { callML } from \"../utils/ml\";\n import aiAssert from \"./ai/assert\";\n import aiFact from \"./ai/fact\";\n-import aiSentiment from \"./ai/sentiment\";\n import aiSimilarity from \"./ai/similarity\";\n // import aiNER from \"./ai/ner\"\n // import aiToxicity from \"./ai/toxic\"\n+import RE2 from \"re2\";\n import rouge from \"rouge\";\n import { and, or } from \"../utils/checks\";\n-import { isOpenAIMessage } from \"../utils/misc\";\n import { CleanRun } from \"../utils/ingest\";\n+import { isOpenAIMessage } from \"../utils/misc\";\n \n function getTextsTypes(field: \"any\" | \"input\" | \"output\", run: any) {\n   let textsToCheck = [];\n\n@@ -280,18 +280,19 @@\nexport const CHECK_RUNNERS: CheckRunner[] = [\n     evaluator: async (run, params) => {\n       const { regex, type, field } = params;\n \n-      const re = new RegExp(regex);\n-\n-      const has = re.test(lastMsg(run[field]));\n-\n-      const passed = type === \"contains\" ? has : !has;\n+      // Use RE2 instead of RegExp for safer regex execution\n+      const re = new RE2(regex);\n \n       const runField =\n         typeof run[field] === \"string\"\n           ? run[field]\n           : JSON.stringify(run[field]);\n \n-      const match = has ? runField.match(re)[0] : \"\";\n+      const has = re.test(lastMsg(runField));\n+\n+      const passed = type === \"contains\" ? has : !has;\n+\n+      const match = has ? re.exec(runField)[0] : \"\";\n \n       return {\n         passed,\n```\n\nFilename: packages/backend/src/utils/calcCost.ts:\n```\n@@ -2,6 +2,7 @@\nimport * as Sentry from \"@sentry/node\";\n import { setTimeout } from \"timers/promises\";\n import sql from \"./db\";\n import { findAsyncSequential } from \"./misc\";\n+import RE2 from \"re2\";\n \n interface ModelCost {\n   models: string[];\n\n@@ -212,15 +213,8 @@\nexport async function calcRunCost(run: any) {\n \n     const mapping = await findAsyncSequential(mappings, async (mapping) => {\n       try {\n-        const regex = new RegExp(mapping.pattern);\n-\n-        // Add a timeout to protect against regex slow/attacks\n-        const timeoutMs = 200;\n-\n-        const testPromise = regex.test(run.name);\n-        const timeoutPromise = setTimeout(timeoutMs, false);\n-\n-        return await Promise.race([testPromise, timeoutPromise]);\n+        const regex = new RE2(mapping.pattern);\n+        return regex.test(run.name);\n       } catch (error) {\n         console.error(`Invalid regex pattern: ${mapping.pattern}`, error);\n         return false;\n```\n\nFilename: packages/backend/src/utils/playground.ts:\n```\n@@ -148,7 +148,7 @@\nexport function compileTextTemplate(\n   content: string,\n   variables: Record<string, string>,\n ) {\n-  const regex = /{{(.*?)}}/g;\n+  const regex = /{{([^{}]*)}}/g;\n   return content.replace(regex, (_, g1) => variables[g1] || \"\");\n }\n```"
            }
        ],
        "sw_version": "v1.4.22",
        "sw_version_wget": "https://github.com/lunary-ai/lunary/archive/refs/tags/v1.4.22.zip",
        "description": "In lunary-ai/lunary, the privilege check mechanism is flawed in version git afc5df4. The system incorrectly identifies certain endpoints as public if the path contains '/auth/' anywhere within it. This allows unauthenticated attackers to access sensitive endpoints by including '/auth/' in the path. As a result, attackers can obtain and modify sensitive data and utilize other organizations' resources without proper authentication.",
        "sec_adv": [
            {
                "url": "https://huntr.com/bounties/4908cfcf-607a-412a-9635-966cbb08bb49",
                "content": "Bounties\nPartners\nCommunity\nInfo\nSUBMIT REPORT\nendpoint privilege is not properly checked, lead to unauth attacker visiting sensitive endpoint in lunary-ai/lunary\nValid\nReported on Sep 12th 2024\nDescription\nThe privilege check of lunary involve several steps. One step is checking whether the path is so called \"publicroute\". If the route is public, then in the request, auth header can be the same as projectId, aka \"the public key\". ProjectId is not secret. In other word, if the endpoint's path is public, anyone can access the endpoint.\nthe checkof the whether path is public is flawed.\nconst isPublicRoute = publicRoutes.some((route) =>\n    typeof route === \"string\" ? route === ctx.path : route.test(ctx.path),\n  );\nthe publicRoutes regexp is:\nconst publicRoutes = [\n  new RegExp(`/auth/.+`),\n....\nThis code means, if there is \"/auth/\" in the middle of the path, lunary will thinks it a public route. Several endpoint can be accessed without proper authentication via this vulnerability.\nProof of Concept\nAs you can see,\nconst orgs = new Router({\n  prefix: \"/orgs/:orgId\",\n});\norgs.patch(\"/\", checkAccess(\"org\", \"update\"), async (ctx: Context) => {\n  const orgId = ctx.state.orgId as string;\norgs router have orgid in path parameters, but the actual orgId is resolved from ctx.state.orgId, which is then resolved though Auth header. Which means, user can put anything in the path orgId field, exploit the vulnerability. Let's see a pocs:\ncurl -X GET \"http://localhost:3333/v1/orgs/auth/usage?projectId=96b5f97b-daee-4dba-bc8c-4e4423c84710\" \\\n     -H \"Authorization: Bearer 96b5f97b-daee-4dba-bc8c-4e4423c84710\"\nThis endpoint is a private endpoint, meaning you have to in the org to check its usage. By using the bypass, you need no auth at all, just copy the projectId and auth token, then the server will reply the query with the usage information. Note that the 'auth' inside the path makes us bypass the priv check, but the actual org id is extract from the projectId, not the \"auth\" we put there.\nThere are other endpoints vulnerable. such as\ncurl -X POST \"http://localhost:3333/v1/orgs/auth/playground\" \\\n     -H \"Authorization: Bearer 96b5f97b-daee-4dba-bc8c-4e4423c84710\" \\\n     -H \"Content-Type: application/json\" \\\n     -d '{\"content\":[\"\"],\"extra\":\"\",\"variables\":{}}'\nThis will the other orgs playground and their allowance, to query gpt-3.5. The reason why auth checking is the same as previous POC.\nImpact\nAttacker can check obtain some sensitive data, change some sensitive data and spending other orgs allowance.\nOccurrences\nutils.ts L77-L122\nThe regex path check is flawed. new RegExp(/auth/.+), means there is a \"/auth/\" in the middle of the path, not start with /auth/\nWe are processing your report and will contact thelunary-ai/lunary team within 24 hours.8 months ago\nHugues Chocart validated this vulnerability8 months ago\nThanks for reporting!\noicu0619has been awarded the disclosure bounty\nThe fix bounty is now up for grabs\nThe researcher's credibility has increased: +7\nCVE-2024-8765assigned to this report.8 months ago\nHugues Chocartmarked this as fixedin 1.4.23with commit7ff89b8 months ago\nHugues Chocarthas been awarded the fix bounty\nutils.ts#L77-L122 has been validated\nWe have sent a warning to the lunary-ai/lunary team to inform them that this report will be published in 48 hours5 months ago\nWe have notified the lunary-ai/lunary maintainers about this report in their weekly follow-up5 months ago\nThis vulnerability has now been published5 months ago\nCVE-2024-8765has now been published2 months ago\nSign in to join this conversation\nCVE\nCVE-2024-8765\n(Published)\nVulnerability Type\nCWE-41: Improper Resolution of Path Equivalence\nSeverity\nHigh (7.3)\nAttack vector\nNetwork\nAttack complexity\nLow\nPrivileges required\nNone\nUser interaction\nNone\nScope\nUnchanged\nConfidentiality\nLow\nIntegrity\nLow\nAvailability\nLow\nOpen in visual CVSS calculator\nRegistry\nNpm\nAffected Version\ngit afc5df4\nVisibility\nPublic\nStatus\nFixed\nDisclosure Bounty\n$450\nFix Bounty\n$112.5\nFound by\nFixed by\nSupported by Protect AI and leading the way to MLSecOps and greater AI security.\n 2024\nPrivacy Policy\nTerms of Service\nCode of Conduct\nCookie Preferences\nContact Us",
                "effective": true,
                "effective_reason": "The security advisory explicitly provides examples of cURL commands exploiting the vulnerability, showing how to access endpoints without proper authentication."
            }
        ],
        "cwe": [
            {
                "id": "CWE-41",
                "value": "CWE-41 Improper Resolution of Path Equivalence"
            }
        ]
    }
}