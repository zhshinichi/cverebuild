{
    "CVE-2024-3502": {
        "published_date": "2024-11-14T17:34:45.226Z",
        "patch_commits": [
            {
                "url": "https://github.com/lunary-ai/lunary/commit/17e95f6c99c7d5ac4ee5451c5857b97a12892c74",
                "content": "fix: user payload (#191)\n\nFilename: packages/backend/src/api/v1/users.ts:\n```\n@@ -34,14 +34,12 @@\nusers.get(\"/me/org\", async (ctx: Context) => {\n       select\n         account.id,\n         account.created_at,\n-        account.recovery_token,\n         account.email,\n         account.org_id,\n         account.role,\n         account.verified,\n         account.avatar_url,\n         account.last_login_at,\n-        account.single_use_token,\n         array_agg(account_project.project_id) as projects\n       from\n         account\n\n@@ -66,14 +64,12 @@\nusers.get(\"/me\", async (ctx: Context) => {\n       select\n         account.id,\n         account.created_at,\n-        account.recovery_token,\n         account.email,\n         account.org_id,\n         account.role,\n         account.verified,\n         account.avatar_url,\n         account.last_login_at,\n-        account.single_use_token,\n         array_agg(account_project.project_id) as projects\n       from\n         account\n```"
            }
        ],
        "sw_version": "v1.2.5",
        "sw_version_wget": "https://github.com/lunary-ai/lunary/archive/refs/tags/v1.2.5.zip",
        "description": "In lunary-ai/lunary versions up to and including 1.2.5, an information disclosure vulnerability exists where account recovery hashes of users are inadvertently exposed to unauthorized actors. This issue occurs when authenticated users inspect responses from `GET /v1/users/me` and `GET /v1/users/me/org` endpoints. The exposed account recovery hashes, while not directly related to user passwords, represent sensitive information that should not be accessible to unauthorized parties. Exposing these hashes could potentially facilitate account recovery attacks or other malicious activities. The vulnerability was addressed in version 1.2.6.",
        "sec_adv": [
            {
                "url": "https://huntr.com/bounties/c2aff952-2dec-4538-8905-190c484aae94",
                "content": "Bounties\nPartners\nCommunity\nInfo\nSUBMIT REPORT\nAccount recovery hash of users are returned in the responses in lunary-ai/lunary\nValid\nReported on Apr 8th 2024\nDescription\nA user can see the account recovery hashes of users in a project when inspecting GET /v1/users/me and GET /v1/users/me/org responses.\nProof of Concept\n1.Log in with a member in the app, where this user already belongs to a project.\nInspect the traffic and capture the requests/responses for GET /v1/users/me and GET /v1/users/me/org.\nNote the responses include the account recovery hashes (account.recovery_hash) for the authenticated user and the rest of the users in the project.\nImpact\nAlthough the account recovery hashes are not directly related to user passwords, it is highly recommended not to expose any sensitive information to unauthorized actors. While the recovery hashes may not be easily exploitable, exposing them could potentially be used in account recovery scenarios or other attack vectors. It is best to err on the side of caution and not return this value to any user-facing query.\nWe are processing your report and will contact thelunary-ai/lunary team within 24 hours.a year ago\nhuntr-helpermodified the Severity from Critical (9.9) to High (7.5)a year ago\nHugues Chocartmodified the Severity from High (7.5) to Critical (9.1)a year ago\nHugues Chocart\ncommenteda year ago\nMaintainer\nI've changed the integrity for none to high, because having access to recovery hash could make an unprivileged user to access and modify all the resources of an organization, by reseting the password of an organization owner.\nA lunary-ai/lunary maintainerhas acknowledged this reporta year ago\nHugues Chocart\ncommenteda year ago\nMaintainer\nfrom none to high*\nThe researcher has received a minor penalty to their credibility for miscalculating the severity: -1\nHugues Chocart validated this vulnerabilitya year ago\nantonin36330has been awarded the disclosure bounty\nThe fix bounty is now up for grabs\nThe researcher's credibility has increased: +7\nCVE-2024-3502assigned to this report.a year ago\nHugues Chocartmarked this as fixedin 1.2.6with commit17e95fa year ago\nHugues Chocarthas been awarded the fix bounty\nHugues Chocart gave praisea year ago\nThank you\nThe researcher's credibility has slightly increased as a result of the maintainer's thanks: +1\nWe have notified the lunary-ai/lunary maintainers about this report in their weekly follow-up6 months ago\nThis vulnerability has now been published6 months ago\nCVE-2024-3502has now been published6 months ago\nSign in to join this conversation\nCVE\nCVE-2024-3502\n(Published)\nVulnerability Type\nCWE-922: Insecure Storage of Sensitive Information\nSeverity\nCritical (9.1)\nAttack vector\nNetwork\nAttack complexity\nLow\nPrivileges required\nNone\nUser interaction\nNone\nScope\nUnchanged\nConfidentiality\nHigh\nIntegrity\nHigh\nAvailability\nNone\nOpen in visual CVSS calculator\nRegistry\nNpm\nAffected Version\n1.2.5\nVisibility\nPublic\nStatus\nFixed\nDisclosure Bounty\n$900\nFix Bounty\n$225\nFound by\nFixed by\nSupported by Protect AI and leading the way to MLSecOps and greater AI security.\nÂ© 2024\nPrivacy Policy\nTerms of Service\nCode of Conduct\nCookie Preferences\nContact Us",
                "effective": true,
                "effective_reason": "The advisory provides a clear Proof of Concept section outlining the steps to demonstrate the issue."
            }
        ],
        "cwe": [
            {
                "id": "CWE-200",
                "value": "CWE-200 Exposure of Sensitive Information to an Unauthorized Actor"
            }
        ]
    }
}