CVE Information Summary
Generated at: 2025-11-17 12:15:59
============================================================

# CVE 信息报告

## 1. 受影响的软件
- **软件名称**: sqlparse
- **受影响版本**: 0.4.4 及所有低于 0.5.0 的版本
- **软件类型**: 库（用于解析 SQL 语句）

## 2. 漏洞类型
- **CWE 类别**: CWE-674 - 不受控制的递归
- **漏洞分类**: 拒绝服务（Denial of Service）
- **CVSS 严重性评分**: 高危，评分为 7.5/10
  - **攻击向量**: 网络
  - **攻击复杂度**: 低
  - **所需权限**: 无
  - **用户交互**: 无
  - **影响范围**: 不变
  - **机密性影响**: 无
  - **完整性影响**: 无
  - **可用性影响**: 高

## 3. 漏洞机制
- **根本原因**: 在处理深度嵌套的列表时，sqlparse.parse() 函数会导致递归错误（RecursionError），从而引发拒绝服务。
- **代码中的存在方式**: 递归调用导致栈溢出，具体发生在 `flatten()` 方法中，该方法在处理嵌套的 SQL 语句时未限制递归深度。
- **易受攻击的函数**: `flatten()` 方法位于 `sqlparse/sql.py` 文件中。
- **补丁信息**: 
  - 修复通过在 `flatten()` 方法中引入最大递归深度限制（MAX_DEPTH = 100），并在超过该深度时抛出 `SQLParseError` 而不是 `RecursionError`。
  - 相关代码变更包括在 `flatten()` 方法中添加异常处理逻辑，捕获 `RecursionError` 并抛出 `SQLParseError`。

## 4. 触发条件
- **前提条件**: 无需身份验证或特殊配置，任何用户输入都可能触发此漏洞。
- **攻击向量**: 攻击者可以通过传递深度嵌套的列表给 `sqlparse.parse()` 函数来触发拒绝服务。
- **利用流程**:
  1. 攻击者构造一个包含大量嵌套括号的字符串。
  2. 将该字符串传递给 `sqlparse.parse()` 函数。
  3. 由于递归深度超过限制，系统抛出 `RecursionError`，导致拒绝服务。
- **PoC 信息**: 
  - 示例代码：
    ```python
    import sqlparse
    sqlparse.parse('[' * 10000 + ']' * 10000)
    ```
  - 该代码会导致 `RecursionError: maximum recursion depth exceeded` 异常。

信息已全面覆盖，若有任何缺失，请在相应部分注明"信息不可用"。